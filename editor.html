<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>LudvigEditor ULTRA+ Py Imports Highlight</title>
<style>
html, body { margin:0; padding:0; width:100%; height:100%; background:#0f1224; overflow:hidden; font-family:sans-serif; }
#editor { position:absolute; top:0; left:0; right:0; bottom:150px; border-radius:10px; }
#terminal { position:absolute; left:0; right:0; bottom:0; height:150px; background:#1b1e2b; color:#e0e0ff; font-family:monospace; padding:5px; overflow:auto; border-top:3px solid #3f2b96; }
</style>
<script src="https://cdn.jsdelivr.net/npm/monaco-editor@0.39.0/min/vs/loader.js"></script>
<script>
require.config({ paths: { 'vs': 'https://cdn.jsdelivr.net/npm/monaco-editor@0.39.0/min/vs' }});
let editor;
require(['vs/editor/editor.main'], function() {
    editor = monaco.editor.create(document.getElementById('editor'), {
        value: '',
        language: 'python',
        theme: 'vs-dark',
        fontSize: 14,
        automaticLayout: true,
        minimap: { enabled: false },
        scrollBeyondLastLine: false
    });

    // ===================== PYTHON + IMPORTS =====================
    monaco.languages.register({ id: 'python-full-imports' });
    monaco.languages.setMonarchTokensProvider('python-full-imports', {
        tokenizer: {
            root: [
                [/\b(import|from)\b/, 'keyword'],
                [/\b(as|if|elif|else|for|while|try|except|with|pass|break|continue|def|class|return)\b/, 'keyword'],
                [/\b([A-Za-z_][\w\.]*)\b/, 'type.identifier'], // все идентификаторы, включая модули
                [/#.*$/, 'comment'],
                [/'[^']*'/, 'string'],
                [/"[^"]*"/, 'string'],
                [/\b[0-9]+\b/, 'number']
            ]
        }
    });
    editor.updateOptions({ language: 'python-full-imports' });
});

// ------------------ Functions for PyQt ------------------
window.loadFileFromPy = function(code, lang='python-full-imports') {
    if(editor) {
        monaco.editor.setModelLanguage(editor.getModel(), lang);
        editor.setValue(code);
    }
};

window.getCodeForPy = function() {
    return editor ? editor.getValue() : '';
};

window.appendTerminal = function(text) {
    let term = document.getElementById('terminal');
    term.innerText += text + "\n";
    term.scrollTop = term.scrollHeight;
};

window.clearTerminal = function() {
    document.getElementById('terminal').innerText = '';
};
</script>
</head>
<body>
<div id="editor"></div>
<div id="terminal">Terminal Output:</div>
</body>
</html>
