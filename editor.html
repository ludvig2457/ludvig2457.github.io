<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>LudvigEditor PRO 3.0</title>
<style>
html, body { margin:0; padding:0; width:100%; height:100%; background:#1e1e2f; overflow:hidden; font-family:sans-serif; }
#editor { position:absolute; top:0; left:0; right:0; bottom:150px; border-radius:5px; }
#terminal { position:absolute; left:0; right:0; bottom:0; height:150px; background:#1e1e2f; color:#d4d4d4; font-family:monospace; padding:5px; overflow:auto; border-top:3px solid #007acc; }
</style>
<script src="https://cdn.jsdelivr.net/npm/monaco-editor@0.39.0/min/vs/loader.js"></script>
<script>
require.config({ paths: { 'vs': 'https://cdn.jsdelivr.net/npm/monaco-editor@0.39.0/min/vs' }});
let editor;
require(['vs/editor/editor.main'], function() {
    editor = monaco.editor.create(document.getElementById('editor'), {
        value: '',
        language: 'python',
        theme: 'ludvig-vscode-pro',
        fontSize: 14,
        automaticLayout: true,
        minimap: { enabled: false },
        scrollBeyondLastLine: false
    });

    // ===================== Custom Python Highlight =====================
    monaco.languages.register({ id: 'python-pro' });

    const imports = [
        'sys','os','subprocess','requests','threading','time','json','shutil','uuid','tqdm','pypresence',
        'minecraft_launcher_lib','packaging','random_username','PyQt6'
    ];

    monaco.languages.setMonarchTokensProvider('python-pro', {
        tokenizer: {
            root: [
                // Imports
                [new RegExp('\\b(import|from|as)\\b'), 'keyword.import'],
                [new RegExp('\\b(' + imports.join('|') + ')\\b'), 'keyword.library'],
                // Control flow
                [/\b(if|elif|else|for|while|try|except|finally|with|pass|break|continue|return|lambda|yield|await|async)\b/, 'keyword.control'],
                // Constants
                [/\b(True|False|None)\b/, 'constant.language'],
                // Functions and classes
                [/\bdef\s+([A-Za-z_][\w]*)/, 'entity.name.function'],
                [/\bclass\s+([A-Za-z_][\w]*)/, 'entity.name.class'],
                // Strings
                [/'[^']*'/, 'string'],
                [/"[^"]*"/, 'string'],
                // Numbers
                [/\b[0-9]+(\.[0-9]+)?\b/, 'number'],
                // Comments
                [/#.*$/, 'comment'],
                // Decorators
                [/^@\w+/, 'annotation'],
                // Identifiers
                [/\b([A-Za-z_][\w]*)\b/, 'identifier']
            ]
        }
    });

    monaco.editor.defineTheme('ludvig-vscode-pro', {
        base: 'vs-dark',
        inherit: true,
        rules: [
            { token: 'keyword.import', foreground: 'C586C0', fontStyle: 'bold' },      // Purple
            { token: 'keyword.library', foreground: '9CDCFE', fontStyle: 'bold' },     // Light Blue for imports
            { token: 'keyword.control', foreground: '569CD6', fontStyle: 'bold' },     // Blue
            { token: 'constant.language', foreground: '4EC9B0' },                       // Cyan
            { token: 'entity.name.function', foreground: 'DCDCAA' },                    // Yellow
            { token: 'entity.name.class', foreground: '4EC9B0', fontStyle: 'bold' },   // Cyan
            { token: 'comment', foreground: '6A9955', fontStyle: 'italic' },           // Green italic
            { token: 'string', foreground: 'CE9178' },                                  // Orange
            { token: 'number', foreground: 'B5CEA8' },                                  // Light green
            { token: 'annotation', foreground: 'D4D4D4', fontStyle: 'bold' },          // Decorators
            { token: 'identifier', foreground: 'D4D4D4' }                               // Default
        ],
        colors: {
            'editor.background': '#1e1e2f',
            'editor.foreground': '#d4d4d4',
            'editor.selectionBackground': '#264f78',
            'editor.lineHighlightBackground': '#333333',
            'editorCursor.foreground': '#dcdcdc'
        }
    });

    monaco.editor.setTheme('ludvig-vscode-pro');
});

// ------------------ PyQt6 Interface ------------------
window.loadFileFromPy = function(code, lang='python') {
    if(editor){
        monaco.editor.setModelLanguage(editor.getModel(), lang);
        editor.setValue(code);
    }
};
window.getCodeForPy = function() {
    return editor ? editor.getValue() : '';
};
window.appendTerminal = function(text) {
    let term = document.getElementById('terminal');
    term.innerText += text + "\n";
    term.scrollTop = term.scrollHeight;
};
window.clearTerminal = function() {
    document.getElementById('terminal').innerText = '';
};
</script>
</head>
<body>
<div id="editor"></div>
<div id="terminal">Terminal Output:</div>
</body>
</html>
