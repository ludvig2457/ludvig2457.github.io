<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>LudvigEditor</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
html, body {
    margin: 0;
    height: 100%;
    overflow: hidden;
    background: linear-gradient(135deg, #4b2fbf, #2b1a55, #14142e);
    font-family: system-ui;
}

/* ===== TOP BAR ===== */
#topbar {
    height: 46px;
    display: flex;
    align-items: center;
    padding: 0 14px;
    color: #fff;
    font-weight: 600;
    letter-spacing: .4px;
    background: linear-gradient(135deg, rgba(90,60,200,.85), rgba(60,40,160,.85));
    backdrop-filter: blur(20px) saturate(160%);
    box-shadow: 0 6px 30px rgba(0,0,0,.5);
    border-bottom: 1px solid rgba(255,255,255,.12);
    position: relative;
    gap: 10px;
}

/* ===== SEARCH INPUT ===== */
#searchInput {
    padding: 4px 8px;
    border-radius: 6px;
    border: none;
    outline: none;
    opacity: 0.85;
    font-size: 14px;
}

/* ===== LANGUAGE SELECT ===== */
#langSelect {
    padding: 4px 8px;
    border-radius: 6px;
    border: none;
    font-size: 14px;
    background: rgba(255,255,255,.12);
    color: white;
}

/* ===== EDITOR ===== */
#editor {
    width: 100%;
    height: calc(100% - 46px);
}

/* ===== SCROLLBAR ===== */
::-webkit-scrollbar { width: 10px; }
::-webkit-scrollbar-thumb { background: rgba(130,130,220,.4); border-radius: 10px; }
</style>

<script src="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.45.0/min/vs/loader.min.js"></script>
</head>

<body>
<div id="topbar">
    ‚ö° LudvigEditor ‚Äî VS Code style
    <input type="text" id="searchInput" placeholder="Search..." />
    <select id="langSelect">
        <option value="python">Python</option>
        <option value="javascript">JavaScript</option>
        <option value="typescript">TypeScript</option>
        <option value="html">HTML</option>
        <option value="css">CSS</option>
        <option value="json">JSON</option>
        <option value="c">C</option>
        <option value="cpp">C++</option>
        <option value="java">Java</option>
        <option value="markdown">Markdown</option>
        <option value="shell">Bash</option>
        <option value="ruby">Ruby</option>
        <option value="php">PHP</option>
        <option value="go">Go</option>
        <option value="rust">Rust</option>
        <option value="kotlin">Kotlin</option>
        <option value="swift">Swift</option>
        <option value="lua">Lua</option>
        <option value="sql">SQL</option>
        <option value="yaml">YAML</option>
        <option value="xml">XML</option>
        <option value="plaintext">Plain Text</option>
    </select>
</div>
<div id="editor"></div>

<script>
require.config({ paths: { vs: "https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.45.0/min/vs" } });

require(["vs/editor/editor.main"], function () {

    // ===== THEME =====
    monaco.editor.defineTheme("ludvig-gradient", {
        base: "vs-dark",
        inherit: true,
        rules: [
            { token: "comment", foreground: "7fd88b" },
            { token: "keyword", foreground: "c792ea" },
            { token: "number", foreground: "b5cea8" },
            { token: "string", foreground: "f6c177" },
            { token: "type.identifier", foreground: "4ec9b0" },
            { token: "function", foreground: "82aaff" },
        ],
        colors: {
            "editor.background": "#0f1224",
            "editor.lineHighlightBackground": "#1c2040",
            "editorCursor.foreground": "#ffffff",
            "editor.selectionBackground": "#2f3368",
        }
    });

    // ===== EDITOR =====
    window.editor = monaco.editor.create(document.getElementById("editor"), {
        value: "# LudvigEditor\nprint('Gradient future üöÄ')",
        language: "python",
        theme: "ludvig-gradient",
        automaticLayout: true,
        fontFamily: "JetBrains Mono, Consolas, monospace",
        fontSize: 14,
        fontLigatures: true,
        smoothScrolling: true,
        cursorSmoothCaretAnimation: "on",
        minimap: { enabled: true },
        wordWrap: "on",
        dragAndDrop: true
    });

    // ===== LANGUAGE SWITCH =====
    const langSelect = document.getElementById("langSelect");
    langSelect.addEventListener("change", () => {
        monaco.editor.setModelLanguage(editor.getModel(), langSelect.value);
    });

    // ===== SEARCH =====
    const searchInput = document.getElementById("searchInput");
    searchInput.addEventListener("input", () => {
        const term = searchInput.value;
        const findController = editor.getContribution('editor.contrib.findController');
        if(term) {
            editor.getAction('actions.find').run().then(() => {
                findController.getState().change({ searchString: term }, false);
            });
        } else {
            findController.getState().change({ searchString: '' }, false);
        }
    });

    // ===== API FOR PYQT =====
    window.setCode = (code, lang = "python") => {
        monaco.editor.setModelLanguage(editor.getModel(), lang);
        editor.setValue(code);
    };

    window.getCode = () => editor.getValue();
    window.pySave = null; // –î–ª—è PyQt6
});
</script>
</body>
</html>
