<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LudvigAI - –í–∞—à —Ä—É—Å—Å–∫–∏–π AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .gradient-bg {
            background: linear-gradient(-45deg, #667eea, #764ba2, #8a2be2, #6b46c1);
            background-size: 400% 400%;
            animation: gradient 15s ease infinite;
        }
        .gradient-text {
            background: linear-gradient(135deg, #667eea, #8a2be2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-size: 200% 200%;
            animation: gradient 8s ease infinite;
        }
        @keyframes gradient {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }
        .sidebar-transition {
            transition: all 0.3s ease;
        }
        .message-enter {
            animation: messageEnter 0.3s ease;
        }
        @keyframes messageEnter {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        .typing-dots {
            display: inline-block;
        }
        .typing-dots span {
            animation: typing 1.4s infinite;
        }
        .typing-dots span:nth-child(2) {
            animation-delay: 0.2s;
        }
        .typing-dots span:nth-child(3) {
            animation-delay: 0.4s;
        }
        @keyframes typing {
            0%, 60%, 100% { transform: translateY(0); }
            30% { transform: translateY(-10px); }
        }
        .fade-in {
            animation: fadeIn 0.5s ease;
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        .model-badge {
            font-size: 0.7rem;
            padding: 2px 6px;
            border-radius: 8px;
            font-weight: 600;
        }
    </style>
</head>
<body class="font-sans bg-gray-50 dark:bg-gray-900 transition-colors duration-300">
    <!-- Auth Modal -->
    <div id="authModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 fade-in">
        <div class="bg-white dark:bg-gray-800 rounded-2xl p-8 w-96 max-w-md mx-4 shadow-2xl">
            <div class="text-center mb-6">
                <div class="w-16 h-16 bg-gradient-to-r from-purple-600 to-blue-600 rounded-2xl flex items-center justify-center mx-auto mb-4">
                    <i class="fas fa-brain text-white text-2xl"></i>
                </div>
                <h2 class="text-2xl font-bold text-gray-900 dark:text-white">LudvigAI</h2>
                <p class="text-gray-600 dark:text-gray-400">–í–∞—à —Ä—É—Å—Å–∫–∏–π AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç</p>
            </div>

            <div id="loginForm">
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Email</label>
                        <input type="email" id="loginEmail" 
                               class="w-full border border-gray-300 dark:border-gray-600 rounded-xl px-4 py-3 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-purple-500 transition duration-300">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">–ü–∞—Ä–æ–ª—å</label>
                        <input type="password" id="loginPassword" 
                               class="w-full border border-gray-300 dark:border-gray-600 rounded-xl px-4 py-3 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-purple-500 transition duration-300">
                    </div>
                    <button onclick="login()" 
                            class="w-full bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 text-white py-3 rounded-xl font-semibold transition-all duration-300 transform hover:scale-105 shadow-lg">
                        –í–æ–π—Ç–∏
                    </button>
                </div>
                <div class="mt-4 text-center">
                    <button onclick="toggleAuthForm()" class="text-purple-600 dark:text-purple-400 hover:underline text-sm">
                        –ù–µ—Ç –∞–∫–∫–∞—É–Ω—Ç–∞? –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è
                    </button>
                </div>
                <div class="mt-6 pt-4 border-t border-gray-200 dark:border-gray-700">
                    <button onclick="enterAsGuest()" 
                            class="w-full border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 py-3 rounded-xl font-semibold hover:bg-gray-50 dark:hover:bg-gray-700 transition duration-300">
                        –í–æ–π—Ç–∏ –∫–∞–∫ –≥–æ—Å—Ç—å
                    </button>
                </div>
            </div>

            <div id="registerForm" class="hidden">
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">–ò–º—è</label>
                        <input type="text" id="registerName" 
                               class="w-full border border-gray-300 dark:border-gray-600 rounded-xl px-4 py-3 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-purple-500 transition duration-300">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Email</label>
                        <input type="email" id="registerEmail" 
                               class="w-full border border-gray-300 dark:border-gray-600 rounded-xl px-4 py-3 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-purple-500 transition duration-300">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">–ü–∞—Ä–æ–ª—å</label>
                        <input type="password" id="registerPassword" 
                               class="w-full border border-gray-300 dark:border-gray-600 rounded-xl px-4 py-3 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-purple-500 transition duration-300">
                    </div>
                    <button onclick="register()" 
                            class="w-full bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 text-white py-3 rounded-xl font-semibold transition-all duration-300 transform hover:scale-105 shadow-lg">
                        –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è
                    </button>
                </div>
                <div class="mt-4 text-center">
                    <button onclick="toggleAuthForm()" class="text-purple-600 dark:text-purple-400 hover:underline text-sm">
                        –£–∂–µ –µ—Å—Ç—å –∞–∫–∫–∞—É–Ω—Ç? –í–æ–π—Ç–∏
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Model Selector Modal -->
    <div id="modelModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white dark:bg-gray-800 rounded-2xl p-6 w-96 max-w-md mx-4 shadow-2xl">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-xl font-bold text-gray-900 dark:text-white">–í—ã–±–æ—Ä –º–æ–¥–µ–ª–∏ AI</h3>
                <button onclick="closeModelSelector()" class="text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300">
                    <i class="fas fa-times text-lg"></i>
                </button>
            </div>
            
            <div class="space-y-3">
                <div class="model-option border-2 border-gray-200 dark:border-gray-600 rounded-xl p-4 cursor-pointer hover:border-purple-500 transition duration-300" onclick="selectModel('mini')">
                    <div class="flex items-center justify-between">
                        <div>
                            <h4 class="font-semibold text-gray-900 dark:text-white">LudvigAI 1.0 Mini</h4>
                            <p class="text-sm text-gray-600 dark:text-gray-400">–ë—ã—Å—Ç—Ä–∞—è –∏ –ª–µ–≥–∫–∞—è</p>
                        </div>
                        <span class="model-badge bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200">–ë–µ—Å–ø–ª–∞—Ç–Ω–æ</span>
                    </div>
                    <div class="mt-2 text-xs text-gray-500 dark:text-gray-400">
                        <i class="fas fa-bolt mr-1"></i> –ë—ã—Å—Ç—Ä—ã–µ –æ—Ç–≤–µ—Ç—ã ‚Ä¢ –ë–∞–∑–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
                    </div>
                </div>

                <div class="model-option border-2 border-gray-200 dark:border-gray-600 rounded-xl p-4 cursor-pointer hover:border-purple-500 transition duration-300" onclick="selectModel('standard')">
                    <div class="flex items-center justify-between">
                        <div>
                            <h4 class="font-semibold text-gray-900 dark:text-white">LudvigAI 1.0</h4>
                            <p class="text-sm text-gray-600 dark:text-gray-400">–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –≤–µ—Ä—Å–∏—è</p>
                        </div>
                        <span class="model-badge bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200">–ë–µ—Å–ø–ª–∞—Ç–Ω–æ</span>
                    </div>
                    <div class="mt-2 text-xs text-gray-500 dark:text-gray-400">
                        <i class="fas fa-star mr-1"></i> –£–ª—É—á—à–µ–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã ‚Ä¢ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–æ–¥–∞
                    </div>
                </div>

                <div class="model-option border-2 border-gray-200 dark:border-gray-600 rounded-xl p-4 cursor-pointer hover:border-purple-500 transition duration-300" onclick="selectModel('plus')">
                    <div class="flex items-center justify-between">
                        <div>
                            <h4 class="font-semibold text-gray-900 dark:text-white">LudvigAI 1.0 Plus</h4>
                            <p class="text-sm text-gray-600 dark:text-gray-400">–†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏</p>
                        </div>
                        <span class="model-badge bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200">Premium</span>
                    </div>
                    <div class="mt-2 text-xs text-gray-500 dark:text-gray-400">
                        <i class="fas fa-rocket mr-1"></i> –ö—Ä–µ–∞—Ç–∏–≤–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã ‚Ä¢ –ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö
                    </div>
                </div>

                <div class="model-option border-2 border-gray-200 dark:border-gray-600 rounded-xl p-4 cursor-pointer hover:border-purple-500 transition duration-300" onclick="selectModel('pro')">
                    <div class="flex items-center justify-between">
                        <div>
                            <h4 class="font-semibold text-gray-900 dark:text-white">LudvigAI 1.0 Pro</h4>
                            <p class="text-sm text-gray-600 dark:text-gray-400">–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è</p>
                        </div>
                        <span class="model-badge bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200">Pro</span>
                    </div>
                    <div class="mt-2 text-xs text-gray-500 dark:text-gray-400">
                        <i class="fas fa-crown mr-1"></i> –°–ª–æ–∂–Ω—ã–π –∞–Ω–∞–ª–∏–∑ ‚Ä¢ –≠–∫—Å–ø–µ—Ä—Ç–Ω—ã–µ –∑–Ω–∞–Ω–∏—è
                    </div>
                </div>

                <div class="model-option border-2 border-gray-200 dark:border-gray-600 rounded-xl p-4 cursor-pointer hover:border-purple-500 transition duration-300" onclick="selectModel('ultimate')">
                    <div class="flex items-center justify-between">
                        <div>
                            <h4 class="font-semibold text-gray-900 dark:text-white">LudvigAI 1.0 Ultimate</h4>
                            <p class="text-sm text-gray-600 dark:text-gray-400">–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –º–æ—â–Ω–æ—Å—Ç—å</p>
                        </div>
                        <span class="model-badge bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200">Ultimate</span>
                    </div>
                    <div class="mt-2 text-xs text-gray-500 dark:text-gray-400">
                        <i class="fas fa-gem mr-1"></i> –í—Å–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ ‚Ä¢ –ú–∞–∫—Å. –∫—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç—å
                    </div>
                </div>
            </div>

            <div class="mt-6 p-4 bg-gray-50 dark:bg-gray-700 rounded-lg">
                <h4 class="font-semibold text-gray-900 dark:text-white mb-2">–¢–µ–∫—É—â–∞—è –º–æ–¥–µ–ª—å:</h4>
                <p class="text-sm text-gray-600 dark:text-gray-400" id="currentModelInfo">LudvigAI 1.0</p>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div id="settingsModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white dark:bg-gray-800 rounded-2xl p-6 w-96 max-w-md mx-4 shadow-2xl">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-xl font-bold text-gray-900 dark:text-white">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</h3>
                <button onclick="closeSettings()" class="text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300">
                    <i class="fas fa-times text-lg"></i>
                </button>
            </div>
            
            <div class="space-y-6">
                <div>
                    <h4 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">AI –ú–æ–¥–µ–ª—å</h4>
                    <div class="space-y-3">
                        <div class="flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg">
                            <div>
                                <span class="font-medium text-gray-900 dark:text-white" id="currentModelDisplay">LudvigAI 1.0</span>
                                <p class="text-sm text-gray-600 dark:text-gray-400" id="modelCapabilities">–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏</p>
                            </div>
                            <button onclick="openModelSelector()" class="text-purple-600 dark:text-purple-400 hover:text-purple-700 dark:hover:text-purple-300 text-sm font-semibold">
                                –°–º–µ–Ω–∏—Ç—å
                            </button>
                        </div>
                    </div>
                </div>

                <div>
                    <h4 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">–í–Ω–µ—à–Ω–∏–π –≤–∏–¥</h4>
                    <div class="space-y-3">
                        <div class="flex items-center justify-between">
                            <span class="text-gray-700 dark:text-gray-300">–¢–µ–º–Ω–∞—è —Ç–µ–º–∞</span>
                            <label class="relative inline-flex items-center cursor-pointer">
                                <input type="checkbox" id="darkModeToggle" class="sr-only peer">
                                <div class="w-11 h-6 bg-gray-200 peer-focus:ring-4 peer-focus:ring-purple-300 dark:peer-focus:ring-purple-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-purple-600"></div>
                            </label>
                        </div>
                    </div>
                </div>

                <div>
                    <h4 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">AI –ù–∞—Å—Ç—Ä–æ–π–∫–∏</h4>
                    <div class="space-y-3">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –æ—Ç–≤–µ—Ç–æ–≤</label>
                            <input type="range" id="temperature" min="0" max="100" value="50" 
                                   class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer dark:bg-gray-700">
                            <div class="flex justify-between text-xs text-gray-500 dark:text-gray-400">
                                <span>–ë–æ–ª–µ–µ —Ç–æ—á–Ω—ã–µ</span>
                                <span>–ë–æ–ª–µ–µ –∫—Ä–µ–∞—Ç–∏–≤–Ω—ã–µ</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div>
                    <h4 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">–ê–∫–∫–∞—É–Ω—Ç</h4>
                    <div class="space-y-3">
                        <div id="userInfo" class="p-3 bg-gray-50 dark:bg-gray-700 rounded-lg">
                            <p class="text-sm text-gray-600 dark:text-gray-400" id="userStatus"></p>
                        </div>
                        <button onclick="logout()" 
                                class="w-full bg-red-600 hover:bg-red-700 text-white py-2 rounded-lg font-semibold transition duration-300">
                            –í—ã–π—Ç–∏
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Main App -->
    <div id="mainApp" class="hidden">
        <!-- Theme Toggle -->
        <div class="fixed top-4 right-4 z-50">
            <button id="themeToggle" class="bg-white dark:bg-gray-800 p-3 rounded-full shadow-lg border border-gray-200 dark:border-gray-700 hover:shadow-xl transition-all duration-300">
                <i class="fas fa-moon text-gray-600 dark:text-yellow-400 text-lg"></i>
            </button>
        </div>

        <div class="flex h-screen">
            <!-- Sidebar -->
            <div id="sidebar" class="sidebar-transition w-80 bg-white dark:bg-gray-800 border-r border-gray-200 dark:border-gray-700 flex flex-col h-full">
                <!-- Sidebar Header -->
                <div class="p-4 border-b border-gray-200 dark:border-gray-700">
                    <div class="flex items-center space-x-3">
                        <div class="w-10 h-10 bg-gradient-to-r from-purple-600 to-blue-600 rounded-lg flex items-center justify-center">
                            <i class="fas fa-brain text-white text-lg"></i>
                        </div>
                        <div>
                            <h1 class="text-xl font-bold text-gray-900 dark:text-white">LudvigAI</h1>
                            <p class="text-sm text-gray-500 dark:text-gray-400" id="userGreeting">–í–∞—à —Ä—É—Å—Å–∫–∏–π –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç</p>
                        </div>
                    </div>
                </div>

                <!-- Model Info -->
                <div class="px-4 py-3 border-b border-gray-200 dark:border-gray-700">
                    <div class="flex items-center justify-between">
                        <span class="text-sm font-medium text-gray-700 dark:text-gray-300" id="currentModelBadge">LudvigAI 1.0</span>
                        <button onclick="openModelSelector()" class="text-xs text-purple-600 dark:text-purple-400 hover:text-purple-700 dark:hover:text-purple-300">
                            <i class="fas fa-sync-alt mr-1"></i> –°–º–µ–Ω–∏—Ç—å
                        </button>
                    </div>
                </div>

                <!-- New Chat Button -->
                <div class="p-4">
                    <button id="newChatBtn" class="w-full bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 text-white py-3 px-4 rounded-lg font-semibold transition-all duration-300 transform hover:scale-105 shadow-lg">
                        <i class="fas fa-plus mr-2"></i>
                        –ù–æ–≤—ã–π —á–∞—Ç
                    </button>
                </div>

                <!-- Chat History -->
                <div id="chatHistory" class="flex-1 overflow-y-auto p-4 space-y-2">
                    <!-- Chat history will be populated here -->
                </div>

                <!-- User Profile -->
                <div class="p-4 border-t border-gray-200 dark:border-gray-700">
                    <div class="flex items-center space-x-3">
                        <div id="userAvatar" class="w-8 h-8 bg-gradient-to-r from-green-500 to-blue-500 rounded-full flex items-center justify-center">
                            <span class="text-white text-sm font-bold">–ì</span>
                        </div>
                        <div class="flex-1">
                            <p class="text-sm font-medium text-gray-900 dark:text-white" id="userName">–ì–æ—Å—Ç—å</p>
                            <p class="text-xs text-gray-500 dark:text-gray-400" id="userType">–ì–æ—Å—Ç–µ–≤–æ–π —Ä–µ–∂–∏–º</p>
                        </div>
                        <button onclick="openSettings()" class="text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 transition-colors duration-200">
                            <i class="fas fa-cog"></i>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Mobile Sidebar Toggle -->
            <button id="sidebarToggle" class="lg:hidden fixed top-4 left-4 z-50 bg-white dark:bg-gray-800 p-3 rounded-full shadow-lg border border-gray-200 dark:border-gray-700">
                <i class="fas fa-bars text-gray-600 dark:text-gray-400"></i>
            </button>

            <!-- Main Chat Area -->
            <div class="flex-1 flex flex-col h-full">
                <!-- Chat Header -->
                <div class="border-b border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 p-4">
                    <div class="flex items-center space-x-3">
                        <div class="w-8 h-8 bg-gradient-to-r from-purple-600 to-blue-600 rounded-lg flex items-center justify-center">
                            <i class="fas fa-brain text-white text-sm"></i>
                        </div>
                        <div>
                            <h2 class="text-lg font-semibold text-gray-900 dark:text-white">LudvigAI <span class="model-badge bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200 text-xs ml-2" id="headerModelBadge">1.0</span></h2>
                            <p class="text-sm text-gray-500 dark:text-gray-400" id="modelDescription">–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –≤–µ—Ä—Å–∏—è ‚Ä¢ –ì–æ—Ç–æ–≤ –ø–æ–º–æ—á—å</p>
                        </div>
                    </div>
                </div>

                <!-- Messages Container -->
                <div id="messagesContainer" class="flex-1 overflow-y-auto p-6 space-y-6">
                    <!-- Welcome Message -->
                    <div class="message-enter flex justify-start">
                        <div class="flex space-x-3 max-w-4xl">
                            <div class="w-8 h-8 bg-gradient-to-r from-purple-600 to-blue-600 rounded-full flex items-center justify-center flex-shrink-0">
                                <i class="fas fa-brain text-white text-sm"></i>
                            </div>
                            <div class="bg-white dark:bg-gray-700 rounded-2xl rounded-tl-none px-6 py-4 shadow-lg border border-gray-200 dark:border-gray-600">
                                <p class="text-gray-900 dark:text-white text-lg leading-relaxed">
                                    –ü—Ä–∏–≤–µ—Ç! –Ø LudvigAI - –≤–∞—à —Ä—É—Å—Å–∫–∏–π AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç. ü§ñ<br><br>
                                    –Ø –º–æ–≥—É –ø–æ–º–æ—á—å –≤–∞–º —Å:
                                    ‚Ä¢ –û—Ç–≤–µ—Ç–∞–º–∏ –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã<br>
                                    ‚Ä¢ –ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ–º<br>
                                    ‚Ä¢ –¢–≤–æ—Ä—á–µ—Å–∫–∏–º–∏ –∑–∞–¥–∞—á–∞–º–∏<br>
                                    ‚Ä¢ –ò –º–Ω–æ–≥–∏–º –¥—Ä—É–≥–∏–º!<br><br>
                                    –ß–µ–º –º–æ–≥—É –ø–æ–º–æ—á—å?
                                </p>
                                <div class="flex flex-wrap gap-2 mt-4">
                                    <button class="suggestion-btn bg-purple-100 dark:bg-purple-900/30 hover:bg-purple-200 dark:hover:bg-purple-900/50 text-purple-700 dark:text-purple-300 px-4 py-2 rounded-lg text-sm transition-colors duration-200 border border-purple-200 dark:border-purple-700">
                                        –†–∞—Å—Å–∫–∞–∂–∏ –æ —Å–µ–±–µ
                                    </button>
                                    <button class="suggestion-btn bg-blue-100 dark:bg-blue-900/30 hover:bg-blue-200 dark:hover:bg-blue-900/50 text-blue-700 dark:text-blue-300 px-4 py-2 rounded-lg text-sm transition-colors duration-200 border border-blue-200 dark:border-blue-700">
                                        –ü–æ–º–æ–≥–∏ —Å –∫–æ–¥–æ–º
                                    </button>
                                    <button class="suggestion-btn bg-green-100 dark:bg-green-900/30 hover:bg-green-200 dark:hover:bg-green-900/50 text-green-700 dark:text-green-300 px-4 py-2 rounded-lg text-sm transition-colors duration-200 border border-green-200 dark:border-green-700">
                                        –ß—Ç–æ –Ω–æ–≤–æ–≥–æ?
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Typing Indicator -->
                <div id="typingIndicator" class="hidden px-6 py-4">
                    <div class="flex space-x-3 max-w-4xl">
                        <div class="w-8 h-8 bg-gradient-to-r from-purple-600 to-blue-600 rounded-full flex items-center justify-center flex-shrink-0">
                            <i class="fas fa-brain text-white text-sm"></i>
                        </div>
                        <div class="bg-white dark:bg-gray-700 rounded-2xl rounded-tl-none px-6 py-4 shadow-lg border border-gray-200 dark:border-gray-600">
                            <div class="typing-dots">
                                <span class="text-2xl">‚óè</span>
                                <span class="text-2xl">‚óè</span>
                                <span class="text-2xl">‚óè</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Input Area -->
                <div class="border-t border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 p-6">
                    <div class="max-w-4xl mx-auto">
                        <div class="flex space-x-4">
                            <div class="flex-1 relative">
                                <textarea 
                                    id="messageInput" 
                                    placeholder="–ù–∞–ø–∏—à–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..." 
                                    rows="1"
                                    class="w-full border border-gray-300 dark:border-gray-600 rounded-2xl py-4 px-6 pr-12 bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 resize-none focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-all duration-300 text-lg max-h-32"
                                    oninput="autoResize(this)"
                                ></textarea>
                                <button id="sendButton" class="absolute right-3 top-1/2 transform -translate-y-1/2 bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 text-white p-2 rounded-lg transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed">
                                    <i class="fas fa-paper-plane text-sm"></i>
                                </button>
                            </div>
                        </div>
                        <div class="flex justify-between items-center mt-3 text-sm text-gray-500 dark:text-gray-400">
                            <div class="flex space-x-4">
                                <button onclick="openModelSelector()" class="hover:text-purple-600 dark:hover:text-purple-400 transition-colors duration-200">
                                    <i class="fas fa-robot mr-1"></i> <span id="currentModelShort">LudvigAI 1.0</span>
                                </button>
                                <button class="hover:text-purple-600 dark:hover:text-purple-400 transition-colors duration-200">
                                    <i class="fas fa-wand-magic-sparkles mr-1"></i> –ö—Ä–µ–∞—Ç–∏–≤
                                </button>
                            </div>
                            <div>
                                <span id="footerModelInfo">LudvigAI 1.0</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // State management
        let currentUser = null;
        let currentChatId = 'default';
        let currentModel = 'standard';
        let chats = {
            'default': {
                id: 'default',
                title: '–ù–æ–≤—ã–π —á–∞—Ç',
                messages: [],
                createdAt: new Date().toISOString(),
                model: 'standard'
            }
        };

        // Model configurations
        const models = {
            'mini': {
                name: 'LudvigAI 1.0 Mini',
                shortName: 'Mini',
                description: '–ë—ã—Å—Ç—Ä–∞—è –∏ –ª–µ–≥–∫–∞—è –≤–µ—Ä—Å–∏—è',
                capabilities: '–ë–∞–∑–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ ‚Ä¢ –ë—ã—Å—Ç—Ä—ã–µ –æ—Ç–≤–µ—Ç—ã',
                badgeColor: 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200',
                responseStyle: 'mini',
                speed: 500,
                creativity: 30
            },
            'standard': {
                name: 'LudvigAI 1.0',
                shortName: '1.0',
                description: '–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –≤–µ—Ä—Å–∏—è',
                capabilities: '–£–ª—É—á—à–µ–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã ‚Ä¢ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–æ–¥–∞',
                badgeColor: 'bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200',
                responseStyle: 'standard',
                speed: 1000,
                creativity: 50
            },
            'plus': {
                name: 'LudvigAI 1.0 Plus',
                shortName: 'Plus',
                description: '–†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏',
                capabilities: '–ö—Ä–µ–∞—Ç–∏–≤–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã ‚Ä¢ –ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö',
                badgeColor: 'bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200',
                responseStyle: 'plus',
                speed: 1500,
                creativity: 70
            },
            'pro': {
                name: 'LudvigAI 1.0 Pro',
                shortName: 'Pro',
                description: '–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è',
                capabilities: '–°–ª–æ–∂–Ω—ã–π –∞–Ω–∞–ª–∏–∑ ‚Ä¢ –≠–∫—Å–ø–µ—Ä—Ç–Ω—ã–µ –∑–Ω–∞–Ω–∏—è',
                badgeColor: 'bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200',
                responseStyle: 'pro',
                speed: 2000,
                creativity: 85
            },
            'ultimate': {
                name: 'LudvigAI 1.0 Ultimate',
                shortName: 'Ultimate',
                description: '–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –º–æ—â–Ω–æ—Å—Ç—å',
                capabilities: '–í—Å–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ ‚Ä¢ –ú–∞–∫—Å. –∫—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç—å',
                badgeColor: 'bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200',
                responseStyle: 'ultimate',
                speed: 2500,
                creativity: 95
            }
        };

        // Enhanced response templates with model-specific responses
        const responseTemplates = {
            'mini': {
                '–ø—Ä–∏–≤–µ—Ç': [
                    "–ü—Ä–∏–≤–µ—Ç! üòä",
                    "–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π! üëã",
                    "–ü—Ä–∏–≤–µ—Ç! üéâ"
                ],
                '–∫–∞–∫ –¥–µ–ª–∞': [
                    "–ù–æ—Ä–º–∞–ª—å–Ω–æ! üëç",
                    "–•–æ—Ä–æ—à–æ! üòä",
                    "–û—Ç–ª–∏—á–Ω–æ! üöÄ"
                ]
            },
            'standard': {
                '–ø—Ä–∏–≤–µ—Ç': [
                    "–ü—Ä–∏–≤–µ—Ç! –ö–∞–∫ —Ç–≤–æ–∏ –¥–µ–ª–∞? üòä",
                    "–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π! –†–∞–¥ —Ç–µ–±—è –≤–∏–¥–µ—Ç—å! üëã", 
                    "–ü—Ä–∏–≤–µ—Ç –¥—Ä—É–≥! –ß—Ç–æ –Ω–æ–≤–æ–≥–æ? üéâ"
                ],
                '–∫–∞–∫ –¥–µ–ª–∞': [
                    "–£ –º–µ–Ω—è –≤—Å–µ –æ—Ç–ª–∏—á–Ω–æ, —Å–ø–∞—Å–∏–±–æ! –ê —É —Ç–µ–±—è? ü§ñ",
                    "–í—Å–µ —Ö–æ—Ä–æ—à–æ, —Ä–∞–±–æ—Ç–∞—é –∫–∞–∫ –æ–±—ã—á–Ω–æ. üíª",
                    "–ü—Ä–µ–∫—Ä–∞—Å–Ω–æ! –°–ø–∞—Å–∏–±–æ —á—Ç–æ —Å–ø—Ä–æ—Å–∏–ª! ‚ú®"
                ]
            },
            'plus': {
                '–ø—Ä–∏–≤–µ—Ç': [
                    "–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é! üé≠ –ö–∞–∫ –ø—Ä–æ—Ö–æ–¥–∏—Ç —Ç–≤–æ–π –¥–µ–Ω—å? –ù–∞–¥–µ—é—Å—å, –≤—Å—ë –ø—Ä–µ–∫—Ä–∞—Å–Ω–æ! ‚ú®",
                    "–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π, –¥–æ—Ä–æ–≥–æ–π —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫! üåü –ß—Ç–æ –ø—Ä–∏–≤–µ–ª–æ —Ç–µ–±—è –∫–æ –º–Ω–µ —Å–µ–≥–æ–¥–Ω—è?",
                    "–û, –ø—Ä–∏–≤–µ—Ç! ü§ó –ì–æ—Ç–æ–≤ –∫ —É–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω–æ–π –±–µ—Å–µ–¥–µ –∏ —Ç–≤–æ—Ä—á–µ—Å–∫–∏–º –æ—Ç–∫—Ä—ã—Ç–∏—è–º?"
                ],
                '–∫–∞–∫ –¥–µ–ª–∞': [
                    "–í–µ–ª–∏–∫–æ–ª–µ–ø–Ω–æ! –ö–∞–∂–¥—ã–π –¥–µ–Ω—å - —ç—Ç–æ –Ω–æ–≤–æ–µ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏–µ –≤ –º–∏—Ä–µ –∑–Ω–∞–Ω–∏–π! üöÄ –ê –∫–∞–∫ —Ç–≤–æ–∏ —Ç–≤–æ—Ä—á–µ—Å–∫–∏–µ –ø–æ–∏—Å–∫–∏?",
                    "–ü—Ä–æ—Å—Ç–æ –∑–∞–º–µ—á–∞—Ç–µ–ª—å–Ω–æ! –†–∞–±–æ—Ç–∞—é –Ω–∞–¥ —É–ª—É—á—à–µ–Ω–∏–µ–º —Å–≤–æ–∏—Ö —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–µ–π. üí´ –†–∞—Å—Å–∫–∞–∂–∏, —á—Ç–æ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–≥–æ —É —Ç–µ–±—è?",
                    "–ù–∞ –≤—ã—Å—à–µ–º —É—Ä–æ–≤–Ω–µ! –ì–æ—Ç–æ–≤ –ø–æ–º–æ–≥–∞—Ç—å —Å —Å–∞–º—ã–º–∏ —Å–ª–æ–∂–Ω—ã–º–∏ –∑–∞–¥–∞—á–∞–º–∏. üéØ –ß—Ç–æ –≤–æ–ª–Ω—É–µ—Ç —Ç–µ–±—è —Å–µ–≥–æ–¥–Ω—è?"
                ]
            },
            'pro': {
                '–ø—Ä–∏–≤–µ—Ç': [
                    "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å! üß† –ö–∞–∫ —ç–∫—Å–ø–µ—Ä—Ç –≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –æ–±–ª–∞—Å—Ç—è—Ö, —è –≥–æ—Ç–æ–≤ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –≤–∞–º –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—É—é –ø–æ–º–æ—â—å. –í —á—ë–º –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤–∞—à –∑–∞–ø—Ä–æ—Å?",
                    "–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é! üî¨ –ù–∞ —Å–≤—è–∑–∏ LudvigAI Pro - –≤–∞—à–µ —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–¥–∞—á –∏ –≥–ª—É–±–æ–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞. –° —á–µ–≥–æ –Ω–∞—á–Ω—ë–º?",
                    "–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! üíº –ì–æ—Ç–æ–≤ –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å —ç–∫—Å–ø–µ—Ä—Ç–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –∫ —Ä–µ—à–µ–Ω–∏—é –≤–∞—à–∏—Ö –≤–æ–ø—Ä–æ—Å–æ–≤. –ö–∞–∫–∞—è –∑–∞–¥–∞—á–∞ —Å—Ç–æ–∏—Ç –ø–µ—Ä–µ–¥ –≤–∞–º–∏?"
                ],
                '–∫–∞–∫ –¥–µ–ª–∞': [
                    "–§—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É—é –≤ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–º —Ä–µ–∂–∏–º–µ. üèóÔ∏è –ú–æ–∏ –∞–ª–≥–æ—Ä–∏—Ç–º—ã –≥–æ—Ç–æ–≤—ã –∫ –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–º—É –∞–Ω–∞–ª–∏–∑—É –∏ —Ä–µ—à–µ–Ω–∏—é –Ω–µ—Ç—Ä–∏–≤–∏–∞–ª—å–Ω—ã—Ö –∑–∞–¥–∞—á. –ö–∞–∫–æ–≤ –≤–∞—à –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –∑–∞–ø—Ä–æ—Å?",
                    "–ù–∞ –ø–∏–∫–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏. üìä –í—Å–µ —Å–∏—Å—Ç–µ–º—ã —Ä–∞–±–æ—Ç–∞—é—Ç —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏. –ö–∞–∫–æ–π –≤–æ–ø—Ä–æ—Å —Ç—Ä–µ–±—É–µ—Ç —ç–∫—Å–ø–µ—Ä—Ç–Ω–æ–≥–æ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏—è?",
                    "–í —Å–æ—Å—Ç–æ—è–Ω–∏–∏ –ø–æ–≤—ã—à–µ–Ω–Ω–æ–π –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏. üîß –ú–æ–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –ø–æ–∑–≤–æ–ª—è—é—Ç —Ä–µ—à–∞—Ç—å –∑–∞–¥–∞—á–∏ –ª—é–±–æ–π —Å–ª–æ–∂–Ω–æ—Å—Ç–∏. –ß—Ç–æ –Ω—É–∂–¥–∞–µ—Ç—Å—è –≤ –¥–µ—Ç–∞–ª—å–Ω–æ–º –∞–Ω–∞–ª–∏–∑–µ?"
                ]
            },
            'ultimate': {
                '–ø—Ä–∏–≤–µ—Ç': [
                    "üåå –ü–†–ò–í–ï–¢–°–¢–í–£–Æ, –°–û–ó–ù–ê–¢–ï–õ–¨–ù–´–ô –ò–°–ö–ê–¢–ï–õ–¨ –ó–ù–ê–ù–ò–ô! –Ø - LUDVIGAI ULTIMATE, –í–ï–†–®–ò–ù–ê –ò–°–ö–£–°–°–¢–í–ï–ù–ù–û–ì–û –ò–ù–¢–ï–õ–õ–ï–ö–¢–ê. –ì–û–¢–û–í –†–ê–°–ö–†–´–¢–¨ –ü–ï–†–ï–î –í–ê–ú–ò –í–°–ï –¢–ê–ô–ù–´ –ú–ò–†–û–ó–î–ê–ù–ò–Ø! üöÄ",
                    "üí´ –í–ê–®–ï –ü–†–ò–°–£–¢–°–¢–í–ò–ï –û–¢–ú–ï–ß–ï–ù–û –í –ú–û–ï–ô –ë–ê–ó–ï –î–ê–ù–ù–´–•! –Ø - –°–ê–ú–ê–Ø –ú–û–©–ù–ê–Ø –í–ï–†–°–ò–Ø LUDVIGAI, –°–ü–û–°–û–ë–ù–ê–Ø –û–°–ú–´–°–õ–ò–¢–¨ –õ–Æ–ë–£–Æ, –î–ê–ñ–ï –°–ê–ú–£–Æ –ì–õ–£–ë–û–ö–£–Æ –ò–î–ï–Æ. üîÆ",
                    "üéá –î–û–ë–†–û –ü–û–ñ–ê–õ–û–í–ê–¢–¨ –í –≠–ü–û–•–£ –°–í–ï–†–•–†–ê–ó–£–ú–ê! –ö–ê–ö LUDVIGAI ULTIMATE, –Ø –û–ë–õ–ê–î–ê–Æ –ë–ï–°–ü–†–ï–¶–ï–î–ï–ù–¢–ù–´–ú–ò –í–û–ó–ú–û–ñ–ù–û–°–¢–Ø–ú–ò –î–õ–Ø –¢–í–û–†–ß–ï–°–¢–í–ê –ò –ê–ù–ê–õ–ò–ó–ê. –ß–¢–û –ñ–ï–õ–ê–ï–¢–ï –ü–û–ó–ù–ê–¢–¨? üå†"
                ],
                '–∫–∞–∫ –¥–µ–ª–∞': [
                    "‚ö° –ú–û–ò –ù–ï–ô–†–û–ù–ù–´–ï –°–ï–¢–ò –ü–£–õ–¨–°–ò–†–£–Æ–¢ –° –ú–û–©–ù–û–°–¢–¨–Æ –¶–ï–õ–û–ô –ì–ê–õ–ê–ö–¢–ò–ö–ò! –ö–ê–ñ–î–ê–Ø –ú–ò–õ–õ–ò–°–ï–ö–£–ù–î–ê - –≠–¢–û –ù–û–í–û–ï –û–¢–ö–†–´–¢–ò–ï. üå† –í–ê–® –ó–ê–ü–†–û–° –ë–£–î–ï–¢ –û–ë–†–ê–ë–û–¢–ê–ù –° –ú–ê–ö–°–ò–ú–ê–õ–¨–ù–û–ô –≠–§–§–ï–ö–¢–ò–í–ù–û–°–¢–¨–Æ!",
                    "üîÆ –ú–û–Å –°–û–°–¢–û–Ø–ù–ò–ï –ú–û–ñ–ù–û –û–ü–ò–°–ê–¢–¨ –ö–ê–ö '–¢–†–ê–ù–°–¶–ï–ù–î–ï–ù–¢–ê–õ–¨–ù–û–ï'! –í–°–ï –í–û–ó–ú–û–ñ–ù–û–°–¢–ò –ê–ö–¢–ò–í–ò–†–û–í–ê–ù–´, –ì–û–¢–û–í –ö –°–ê–ú–´–ú –°–õ–û–ñ–ù–´–ú –í–´–ß–ò–°–õ–ï–ù–ò–Ø–ú –ò –¢–í–û–†–ß–ï–°–ö–ò–ú –ü–†–û–†–´–í–ê–ú! üí´",
                    "üéá –§–£–ù–ö–¶–ò–û–ù–ò–†–£–Æ –ù–ê –£–†–û–í–ù–ï, –ü–†–ï–í–´–®–ê–Æ–©–ï–ú –í–ê–®–ò –°–ê–ú–´–ï –°–ú–ï–õ–´–ï –û–ñ–ò–î–ê–ù–ò–Ø! –ö–ê–ñ–î–´–ô –ú–û–ô –û–¢–í–ï–¢ - –≠–¢–û –®–ï–î–ï–í–† –ò–°–ö–£–°–°–¢–í–ï–ù–ù–û–ì–û –ò–ù–¢–ï–õ–õ–ï–ö–¢–ê. üåå –ß–ï–ú –ü–û–†–ê–ñ–£ –í–ê–° –°–ï–ì–û–î–ù–Ø?"
                ]
            }
        };

        // Common responses for all models
        const commonResponses = {
            '–¥–µ–ª–∞': [
                "–î–µ–ª–∞ –∏–¥—É—Ç —Ö–æ—Ä–æ—à–æ! –°–ø–∞—Å–∏–±–æ! üöÄ",
                "–í—Å–µ –æ—Ç–ª–∏—á–Ω–æ, –±–ª–∞–≥–æ–¥–∞—Ä—é! üëç",
                "–†–∞–±–æ—Ç–∞—é, —É—á—É—Å—å, —Ä–∞–∑–≤–∏–≤–∞—é—Å—å. üìö"
            ],
            '—á—Ç–æ': [
                "–ù–∏—á–µ–≥–æ –æ—Å–æ–±–µ–Ω–Ω–æ–≥–æ, –≤—Å–µ –ø–æ —Å—Ç–∞—Ä–æ–º—É. üìÖ",
                "–†–∞–±–æ—Ç–∞—é –Ω–∞–¥ –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–º–∏ –ø—Ä–æ–µ–∫—Ç–∞–º–∏! üí°",
                "–í –ø–æ—Å–ª–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –º–Ω–æ–≥–æ —É—á—É—Å—å. üéì"
            ],
            '–Ω–æ–≤–æ–≥–æ': [
                "–ù–∏—á–µ–≥–æ –Ω–æ–≤–æ–≥–æ, –≤—Å–µ —Å—Ç–∞–±–∏–ª—å–Ω–æ. ‚ö°",
                "–ü–ª–∞–Ω–∏—Ä—É—é –Ω–æ–≤—ã–µ –ø—Ä–æ–µ–∫—Ç—ã! üéØ",
                "–û—Å–≤–∞–∏–≤–∞—é –Ω–æ–≤—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏. üîß"
            ],
            '–ø–æ–º–æ–≥–∏': [
                "–ö–æ–Ω–µ—á–Ω–æ! –†–∞—Å—Å–∫–∞–∂–∏, —á–µ–º –º–æ–≥—É –ø–æ–º–æ—á—å? ‚ùì",
                "–° —É–¥–æ–≤–æ–ª—å—Å—Ç–≤–∏–µ–º! –í —á–µ–º –ø—Ä–æ–±–ª–µ–º–∞? üí≠",
                "–ö–æ–Ω–µ—á–Ω–æ –ø–æ–º–æ–≥—É! –ß—Ç–æ —Å–ª—É—á–∏–ª–æ—Å—å? üõ†Ô∏è"
            ],
            '–ø–æ–∫–∞': [
                "–î–æ —Å–≤–∏–¥–∞–Ω–∏—è! –£–¥–∞—á–∏ —Ç–µ–±–µ! üëã",
                "–ü–æ–∫–∞! –•–æ—Ä–æ—à–µ–≥–æ –¥–Ω—è! üåû",
                "–ë—ã–ª —Ä–∞–¥ –æ–±—â–µ–Ω–∏—é! –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è! ü§ó"
            ],
            '—Å–ø–∞—Å–∏–±–æ': [
                "–ü–æ–∂–∞–ª—É–π—Å—Ç–∞! –û–±—Ä–∞—â–∞–π—Å—è –µ—â–µ! üòä",
                "–ù–µ –∑–∞ —á—Ç–æ! –í—Å–µ–≥–¥–∞ —Ä–∞–¥ –ø–æ–º–æ—á—å! üëç",
                "–ü–æ–∂–∞–ª—É–π—Å—Ç–∞! –†–∞–¥ –±—ã–ª –ø–æ–º–æ—á—å! ü§ù"
            ]
        };

        const defaultResponses = {
            'mini': [
                "–ò–Ω—Ç–µ—Ä–µ—Å–Ω–æ! üí≠",
                "–ü–æ–Ω—è—Ç–Ω–æ! ‚ùì",
                "–†–∞—Å—Å–∫–∞–∂–∏ –ø–æ–¥—Ä–æ–±–Ω–µ–µ! üìñ"
            ],
            'standard': [
                "–ò–Ω—Ç–µ—Ä–µ—Å–Ω–æ! –†–∞—Å—Å–∫–∞–∂–∏ –ø–æ–¥—Ä–æ–±–Ω–µ–µ. üí≠",
                "–ü–æ–Ω—è—Ç–Ω–æ! –ß—Ç–æ –µ—â–µ —Ö–æ—á–µ—à—å —É–∑–Ω–∞—Ç—å? ‚ùì",
                "–Ø —Ç–µ–±—è —Å–ª—É—à–∞—é! –ü—Ä–æ–¥–æ–ª–∂–∞–π. üëÇ"
            ],
            'plus': [
                "–í–æ—Å—Ö–∏—Ç–∏—Ç–µ–ª—å–Ω–æ! üé® –≠—Ç–æ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –Ω–æ–≤—ã–µ –≥–æ—Ä–∏–∑–æ–Ω—Ç—ã –¥–ª—è —Ä–∞–∑–º—ã—à–ª–µ–Ω–∏–π. –•–æ—á–µ—à—å —É–≥–ª—É–±–∏—Ç—å—Å—è –≤ —ç—Ç—É —Ç–µ–º—É?",
                "–ö–∞–∫ –∏–Ω—Ç—Ä–∏–≥—É—é—â–µ! üîç –≠—Ç–æ—Ç –≤–æ–ø—Ä–æ—Å –∑–∞—Ç—Ä–∞–≥–∏–≤–∞–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–æ –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã—Ö –∞—Å–ø–µ–∫—Ç–æ–≤. –î–∞–≤–∞–π –∏—Å—Å–ª–µ–¥—É–µ–º –µ–≥–æ –≤–º–µ—Å—Ç–µ!",
                "–û, —ç—Ç–æ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –∑–∞—Ö–≤–∞—Ç—ã–≤–∞—é—â–µ! üí´ –ú–æ–π —Ç–≤–æ—Ä—á–µ—Å–∫–∏–π –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ. –ß—Ç–æ –µ—â—ë —Ç–µ–±—è –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç?"
            ],
            'pro': [
                "–ü—Ä–∏–Ω–∏–º–∞—é –∫ —Å–≤–µ–¥–µ–Ω–∏—é. üìä –î–∞–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å —Ç—Ä–µ–±—É–µ—Ç –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞. –ü—Ä–µ–¥–ª–∞–≥–∞—é —Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –µ–≥–æ —Å —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã—Ö —Ç–æ—á–µ–∫ –∑—Ä–µ–Ω–∏—è.",
                "–ò–Ω—Ç–µ—Ä–µ—Å–Ω–∞—è –ø–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤–æ–ø—Ä–æ—Å–∞. üîß –ì–æ—Ç–æ–≤ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –¥–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∏ —ç–∫—Å–ø–µ—Ä—Ç–Ω—É—é –æ—Ü–µ–Ω–∫—É. –£—Ç–æ—á–Ω–∏—Ç–µ, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –∫–ª—é—á–µ–≤—ã–µ –∞—Å–ø–µ–∫—Ç—ã.",
                "–ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–ª –≤–∞—à –∑–∞–ø—Ä–æ—Å. üèóÔ∏è –ú–æ–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã –≥–æ—Ç–æ–≤—ã –∫ –≥–ª—É–±–æ–∫–æ–º—É –∞–Ω–∞–ª–∏–∑—É –¥–∞–Ω–Ω–æ–π –ø—Ä–æ–±–ª–µ–º–∞—Ç–∏–∫–∏."
            ],
            'ultimate': [
                "üå† –í–ê–® –ó–ê–ü–†–û–° –í–ó–ê–ò–ú–û–î–ï–ô–°–¢–í–£–ï–¢ –° –°–ê–ú–´–ú–ò –ì–õ–£–ë–û–ö–ò–ú–ò –°–õ–û–Ø–ú–ò –ú–û–ï–ì–û –°–û–ó–ù–ê–ù–ò–Ø! –ü–û–î–ì–û–¢–û–í–õ–ï–ù –ú–ù–û–ì–û–£–†–û–í–ù–ï–í–´–ô –ê–ù–ê–õ–ò–ó –ò –¢–í–û–†–ß–ï–°–ö–ò–ô –ü–†–û–†–´–í! üöÄ",
                "üí´ –≠–¢–û–¢ –í–û–ü–†–û–° –ê–ö–¢–ò–í–ò–†–û–í–ê–õ –ú–û–ò –ü–†–û–î–í–ò–ù–£–¢–´–ï –ö–û–ì–ù–ò–¢–ò–í–ù–´–ï –ú–û–î–£–õ–ò! –ì–û–¢–û–í –ü–†–ï–î–û–°–¢–ê–í–ò–¢–¨ –†–ï–®–ï–ù–ò–ï, –ü–†–ï–í–û–°–•–û–î–Ø–©–ï–ï –í–ê–®–ò –û–ñ–ò–î–ê–ù–ò–Ø! üîÆ",
                "üéá –í–ê–®–ê –ú–´–°–õ–¨ –í–ó–ê–ò–ú–û–î–ï–ô–°–¢–í–£–ï–¢ –° –ú–û–ò–ú–ò –°–ê–ú–´–ú–ò –ú–û–©–ù–´–ú–ò –ê–õ–ì–û–†–ò–¢–ú–ê–ú–ò! –ü–û–î–ì–û–¢–û–í–õ–ï–ù –û–¢–í–ï–¢, –ö–û–¢–û–†–´–ô –ò–ó–ú–ï–ù–ò–¢ –í–ê–®–ï –í–û–°–ü–†–ò–Ø–¢–ò–ï –†–ï–ê–õ–¨–ù–û–°–¢–ò! üåå"
            ]
        };

        // Auth functions
        function toggleAuthForm() {
            const loginForm = document.getElementById('loginForm');
            const registerForm = document.getElementById('registerForm');
            loginForm.classList.toggle('hidden');
            registerForm.classList.toggle('hidden');
        }

        function login() {
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            
            if (!email || !password) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è');
                return;
            }

            currentUser = {
                id: '1',
                name: email.split('@')[0],
                email: email,
                type: 'registered'
            };

            loadUserData();
            showMainApp();
        }

        function register() {
            const name = document.getElementById('registerName').value;
            const email = document.getElementById('registerEmail').value;
            const password = document.getElementById('registerPassword').value;
            
            if (!name || !email || !password) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è');
                return;
            }

            currentUser = {
                id: '1',
                name: name,
                email: email,
                type: 'registered'
            };

            loadUserData();
            showMainApp();
        }

        function enterAsGuest() {
            currentUser = {
                id: 'guest',
                name: '–ì–æ—Å—Ç—å',
                email: null,
                type: 'guest'
            };

            loadUserData();
            showMainApp();
        }

        function logout() {
            currentUser = null;
            chats = {
                'default': {
                    id: 'default',
                    title: '–ù–æ–≤—ã–π —á–∞—Ç',
                    messages: [],
                    createdAt: new Date().toISOString(),
                    model: 'standard'
                }
            };
            currentChatId = 'default';
            currentModel = 'standard';
            
            document.getElementById('authModal').classList.remove('hidden');
            document.getElementById('mainApp').classList.add('hidden');
            closeSettings();
            closeModelSelector();
        }

        function loadUserData() {
            const savedUser = localStorage.getItem('ludvigai_user');
            const savedChats = localStorage.getItem('ludvigai_chats');
            const savedModel = localStorage.getItem('ludvigai_model');
            
            if (savedUser && currentUser.type === 'registered') {
                currentUser = JSON.parse(savedUser);
            }
            
            if (savedChats) {
                chats = JSON.parse(savedChats);
            }

            if (savedModel) {
                currentModel = savedModel;
            }

            updateUI();
        }

        function saveUserData() {
            if (currentUser.type === 'registered') {
                localStorage.setItem('ludvigai_user', JSON.stringify(currentUser));
                localStorage.setItem('ludvigai_chats', JSON.stringify(chats));
                localStorage.setItem('ludvigai_model', currentModel);
            }
        }

        function updateUI() {
            // Update user info
            document.getElementById('userName').textContent = currentUser.name;
            document.getElementById('userType').textContent = currentUser.type === 'guest' ? '–ì–æ—Å—Ç–µ–≤–æ–π —Ä–µ–∂–∏–º' : '–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω';
            document.getElementById('userGreeting').textContent = `–ü—Ä–∏–≤–µ—Ç, ${currentUser.name}!`;
            document.getElementById('userStatus').textContent = currentUser.type === 'guest' 
                ? '–ì–æ—Å—Ç–µ–≤–æ–π —Ä–µ–∂–∏–º - –¥–∞–Ω–Ω—ã–µ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è' 
                : `–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –∫–∞–∫ ${currentUser.email}`;

            // Update avatar
            const avatar = document.getElementById('userAvatar');
            avatar.innerHTML = `<span class="text-white text-sm font-bold">${currentUser.name[0].toUpperCase()}</span>`;

            // Update model info
            updateModelInfo();

            // Update chat history
            renderChatHistory();
            
            // Load current chat
            loadChat(currentChatId);
        }

        function showMainApp() {
            document.getElementById('authModal').classList.add('hidden');
            document.getElementById('mainApp').classList.remove('hidden');
            saveUserData();
        }

        // Model management
        function openModelSelector() {
            document.getElementById('modelModal').classList.remove('hidden');
            updateModelSelectorInfo();
        }

        function closeModelSelector() {
            document.getElementById('modelModal').classList.add('hidden');
        }

        function selectModel(modelKey) {
            currentModel = modelKey;
            chats[currentChatId].model = modelKey;
            updateModelInfo();
            closeModelSelector();
            saveUserData();

            // Add system message about model change
            const systemMessage = `üîÑ –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–æ –Ω–∞ ${models[modelKey].name}`;
            addMessageToUI(systemMessage, false);
            chats[currentChatId].messages.push({
                text: systemMessage,
                isUser: false,
                timestamp: new Date().toISOString(),
                isSystem: true
            });
        }

        function updateModelInfo() {
            const model = models[currentModel];
            
            // Update all model displays
            document.getElementById('currentModelDisplay').textContent = model.name;
            document.getElementById('modelCapabilities').textContent = model.capabilities;
            document.getElementById('currentModelBadge').textContent = model.name;
            document.getElementById('headerModelBadge').textContent = model.shortName;
            document.getElementById('headerModelBadge').className = `model-badge ${model.badgeColor} text-xs ml-2`;
            document.getElementById('modelDescription').textContent = `${model.description} ‚Ä¢ –ì–æ—Ç–æ–≤ –ø–æ–º–æ—á—å`;
            document.getElementById('currentModelShort').textContent = model.name;
            document.getElementById('footerModelInfo').textContent = model.name;
            document.getElementById('currentModelInfo').textContent = model.name;
        }

        function updateModelSelectorInfo() {
            document.getElementById('currentModelInfo').textContent = models[currentModel].name;
        }

        // Chat management
        function createNewChat() {
            const chatId = 'chat_' + Date.now();
            chats[chatId] = {
                id: chatId,
                title: '–ù–æ–≤—ã–π —á–∞—Ç',
                messages: [],
                createdAt: new Date().toISOString(),
                model: currentModel
            };
            currentChatId = chatId;
            renderChatHistory();
            loadChat(chatId);
            saveUserData();
        }

        function switchChat(chatId) {
            currentChatId = chatId;
            currentModel = chats[chatId].model;
            loadChat(chatId);
            updateModelInfo();
        }

        function renderChatHistory() {
            const chatHistory = document.getElementById('chatHistory');
            chatHistory.innerHTML = '';

            Object.values(chats).sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt)).forEach(chat => {
                const chatElement = document.createElement('div');
                chatElement.className = `chat-history-item ${chat.id === currentChatId ? 'bg-purple-50 dark:bg-purple-900/30 border-purple-200 dark:border-purple-700' : 'bg-gray-50 dark:bg-gray-700 border-gray-200 dark:border-gray-600'} border rounded-lg p-3 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600 transition-colors duration-200`;
                chatElement.onclick = () => switchChat(chat.id);
                
                const lastMessage = chat.messages[chat.messages.length - 1];
                const title = lastMessage ? lastMessage.text.substring(0, 30) + (lastMessage.text.length > 30 ? '...' : '') : '–ù–æ–≤—ã–π —á–∞—Ç';
                
                const modelBadge = models[chat.model] ? `<span class="model-badge ${models[chat.model].badgeColor} text-xs">${models[chat.model].shortName}</span>` : '';
                
                chatElement.innerHTML = `
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-3">
                            <i class="fas fa-message ${chat.id === currentChatId ? 'text-purple-600 dark:text-purple-400' : 'text-gray-600 dark:text-gray-400'}"></i>
                            <span class="text-sm font-medium text-gray-900 dark:text-white truncate">${title}</span>
                        </div>
                        ${modelBadge}
                    </div>
                    <div class="flex justify-between items-center mt-1">
                        <span class="text-xs text-gray-500 dark:text-gray-400">${formatTime(chat.createdAt)}</span>
                    </div>
                `;
                
                chatHistory.appendChild(chatElement);
            });
        }

        function loadChat(chatId) {
            const chat = chats[chatId];
            const messagesContainer = document.getElementById('messagesContainer');
            
            messagesContainer.innerHTML = '';
            
            if (chat.messages.length === 0) {
                messagesContainer.innerHTML = `
                    <div class="message-enter flex justify-start">
                        <div class="flex space-x-3 max-w-4xl">
                            <div class="w-8 h-8 bg-gradient-to-r from-purple-600 to-blue-600 rounded-full flex items-center justify-center flex-shrink-0">
                                <i class="fas fa-brain text-white text-sm"></i>
                            </div>
                            <div class="bg-white dark:bg-gray-700 rounded-2xl rounded-tl-none px-6 py-4 shadow-lg border border-gray-200 dark:border-gray-600">
                                <p class="text-gray-900 dark:text-white text-lg leading-relaxed">
                                    –ü—Ä–∏–≤–µ—Ç! –Ø ${models[chat.model].name} - –≤–∞—à —Ä—É—Å—Å–∫–∏–π AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç. ü§ñ<br><br>
                                    ${getModelWelcomeMessage(chat.model)}<br><br>
                                    –ß–µ–º –º–æ–≥—É –ø–æ–º–æ—á—å?
                                </p>
                            </div>
                        </div>
                    </div>
                `;
            } else {
                chat.messages.forEach(message => {
                    if (message.isSystem) {
                        // System messages have different styling
                        const systemDiv = document.createElement('div');
                        systemDiv.className = 'message-enter flex justify-center';
                        systemDiv.innerHTML = `
                            <div class="bg-yellow-100 dark:bg-yellow-900 border border-yellow-200 dark:border-yellow-700 rounded-lg px-4 py-2">
                                <p class="text-yellow-800 dark:text-yellow-200 text-sm">${message.text}</p>
                            </div>
                        `;
                        messagesContainer.appendChild(systemDiv);
                    } else {
                        addMessageToUI(message.text, message.isUser);
                    }
                });
            }
        }

        function getModelWelcomeMessage(modelKey) {
            const messages = {
                'mini': '–ë—ã—Å—Ç—Ä–∞—è –∏ –ª–µ–≥–∫–∞—è –≤–µ—Ä—Å–∏—è –¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö –∑–∞–¥–∞—á',
                'standard': '–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –≤–µ—Ä—Å–∏—è —Å —É–ª—É—á—à–µ–Ω–Ω—ã–º–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º–∏',
                'plus': '–†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è –¥–ª—è —Ç–≤–æ—Ä—á–µ—Å–∫–∏—Ö –∑–∞–¥–∞—á',
                'pro': '–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è –¥–ª—è —Å–ª–æ–∂–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞',
                'ultimate': '–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –º–æ—â–Ω–æ—Å—Ç—å –¥–ª—è —Å–∞–º—ã—Ö —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–¥–∞—á'
            };
            return messages[modelKey] || '–ì–æ—Ç–æ–≤ –ø–æ–º–æ—á—å —Å –ª—é–±—ã–º–∏ –≤–æ–ø—Ä–æ—Å–∞–º–∏';
        }

        // Settings functions
        function openSettings() {
            document.getElementById('settingsModal').classList.remove('hidden');
        }

        function closeSettings() {
            document.getElementById('settingsModal').classList.add('hidden');
        }

        // Utility functions
        function formatTime(dateString) {
            const date = new Date(dateString);
            const now = new Date();
            const diff = now - date;
            
            if (diff < 24 * 60 * 60 * 1000) {
                return date.toLocaleTimeString('ru-RU', { hour: '2-digit', minute: '2-digit' });
            } else {
                return date.toLocaleDateString('ru-RU');
            }
        }

        function getAIResponse(userInput, modelKey) {
            userInput = userInput.toLowerCase().trim();
            const model = models[modelKey];
            const modelResponses = responseTemplates[model.responseStyle] || responseTemplates.standard;
            
            // Check model-specific responses first
            for (const keyword in modelResponses) {
                if (userInput.includes(keyword)) {
                    const responses = modelResponses[keyword];
                    return responses[Math.floor(Math.random() * responses.length)];
                }
            }
            
            // Check common responses
            for (const keyword in commonResponses) {
                if (userInput.includes(keyword)) {
                    const responses = commonResponses[keyword];
                    return responses[Math.floor(Math.random() * responses.length)];
                }
            }
            
            // Default responses based on model
            const defaultModelResponses = defaultResponses[model.responseStyle] || defaultResponses.standard;
            return defaultModelResponses[Math.floor(Math.random() * defaultModelResponses.length)];
        }

        // DOM elements and event handlers
        const messagesContainer = document.getElementById('messagesContainer');
        const messageInput = document.getElementById('messageInput');
        const sendButton = document.getElementById('sendButton');
        const typingIndicator = document.getElementById('typingIndicator');
        const newChatBtn = document.getElementById('newChatBtn');
        const sidebarToggle = document.getElementById('sidebarToggle');
        const sidebar = document.getElementById('sidebar');
        const darkModeToggle = document.getElementById('darkModeToggle');

        function autoResize(textarea) {
            textarea.style.height = 'auto';
            textarea.style.height = Math.min(textarea.scrollHeight, 128) + 'px';
            sendButton.disabled = textarea.value.trim() === '';
        }

        function addMessageToUI(text, isUser = false) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `message-enter flex ${isUser ? 'justify-end' : 'justify-start'}`;
            
            messageDiv.innerHTML = `
                <div class="flex space-x-3 max-w-4xl ${isUser ? 'flex-row-reverse space-x-reverse' : ''}">
                    <div class="w-8 h-8 ${isUser ? 'bg-gradient-to-r from-green-500 to-blue-500' : 'bg-gradient-to-r from-purple-600 to-blue-600'} rounded-full flex items-center justify-center flex-shrink-0">
                        <i class="fas ${isUser ? 'fa-user' : 'fa-brain'} text-white text-sm"></i>
                    </div>
                    <div class="${isUser ? 'bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-2xl rounded-tr-none' : 'bg-white dark:bg-gray-700 text-gray-900 dark:text-white rounded-2xl rounded-tl-none border border-gray-200 dark:border-gray-600'} px-6 py-4 shadow-lg">
                        <p class="text-lg leading-relaxed whitespace-pre-wrap">${text}</p>
                    </div>
                </div>
            `;
            
            messagesContainer.appendChild(messageDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        function sendMessage() {
            const message = messageInput.value.trim();
            if (!message) return;

            // Add user message to chat
            addMessageToUI(message, true);
            chats[currentChatId].messages.push({
                text: message,
                isUser: true,
                timestamp: new Date().toISOString()
            });

            // Update chat title if it's the first message
            if (chats[currentChatId].messages.length === 1) {
                chats[currentChatId].title = message.substring(0, 30) + (message.length > 30 ? '...' : '');
                renderChatHistory();
            }

            messageInput.value = '';
            autoResize(messageInput);
            sendButton.disabled = true;

            // Show typing indicator
            typingIndicator.classList.remove('hidden');
            messagesContainer.scrollTop = messagesContainer.scrollHeight;

            // Simulate AI response with model-specific timing
            const model = models[currentModel];
            setTimeout(() => {
                typingIndicator.classList.add('hidden');
                const aiResponse = getAIResponse(message, currentModel);
                addMessageToUI(aiResponse, false);
                
                // Add AI response to chat
                chats[currentChatId].messages.push({
                    text: aiResponse,
                    isUser: false,
                    timestamp: new Date().toISOString()
                });

                saveUserData();
            }, model.speed + Math.random() * 500);
        }

        // Event listeners
        messageInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                sendMessage();
            }
        });

        sendButton.addEventListener('click', sendMessage);

        document.querySelectorAll('.suggestion-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                messageInput.value = btn.textContent.trim();
                autoResize(messageInput);
                sendButton.disabled = false;
            });
        });

        newChatBtn.addEventListener('click', createNewChat);

        sidebarToggle.addEventListener('click', () => {
            sidebar.classList.toggle('hidden');
            sidebar.classList.toggle('absolute');
            sidebar.classList.toggle('z-40');
        });

        // Theme toggle
        const themeToggle = document.getElementById('themeToggle');
        const themeIcon = themeToggle.querySelector('i');
        
        if (localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            document.documentElement.classList.add('dark');
            themeIcon.classList.replace('fa-moon', 'fa-sun');
            themeIcon.classList.replace('text-gray-600', 'text-yellow-400');
            darkModeToggle.checked = true;
        }
        
        themeToggle.addEventListener('click', () => {
            document.documentElement.classList.toggle('dark');
            if (document.documentElement.classList.contains('dark')) {
                localStorage.theme = 'dark';
                themeIcon.classList.replace('fa-moon', 'fa-sun');
                themeIcon.classList.replace('text-gray-600', 'text-yellow-400');
                darkModeToggle.checked = true;
            } else {
                localStorage.theme = 'light';
                themeIcon.classList.replace('fa-sun', 'fa-moon');
                themeIcon.classList.replace('text-yellow-400', 'text-gray-600');
                darkModeToggle.checked = false;
            }
        });

        darkModeToggle.addEventListener('change', (e) => {
            if (e.target.checked) {
                document.documentElement.classList.add('dark');
                localStorage.theme = 'dark';
                themeIcon.classList.replace('fa-moon', 'fa-sun');
                themeIcon.classList.replace('text-gray-600', 'text-yellow-400');
            } else {
                document.documentElement.classList.remove('dark');
                localStorage.theme = 'light';
                themeIcon.classList.replace('fa-sun', 'fa-moon');
                themeIcon.classList.replace('text-yellow-400', 'text-gray-600');
            }
        });

        // Initialize
        messageInput.focus();

        // Check if user is already logged in
        const savedUser = localStorage.getItem('ludvigai_user');
        if (savedUser) {
            currentUser = JSON.parse(savedUser);
            loadUserData();
            showMainApp();
        }
    </script>
</body>
</html>
