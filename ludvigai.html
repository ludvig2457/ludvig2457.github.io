<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LudvigAI</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .gradient-bg {
            background: linear-gradient(-45deg, #667eea, #764ba2, #8a2be2, #6b46c1);
            background-size: 400% 400%;
            animation: gradient 15s ease infinite;
        }
        .gradient-text {
            background: linear-gradient(135deg, #667eea, #8a2be2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-size: 200% 200%;
            animation: gradient 8s ease infinite;
        }
        @keyframes gradient {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }
        .sidebar-transition {
            transition: all 0.3s ease;
        }
        .message-enter {
            animation: messageEnter 0.3s ease;
        }
        @keyframes messageEnter {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        .typing-dots span {
            animation: typing 1.4s infinite;
        }
        .typing-dots span:nth-child(2) {
            animation-delay: 0.2s;
        }
        .typing-dots span:nth-child(3) {
            animation-delay: 0.4s;
        }
        @keyframes typing {
            0%, 60%, 100% { transform: translateY(0); }
            30% { transform: translateY(-10px); }
        }
        .fade-in {
            animation: fadeIn 0.5s ease;
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        .model-badge {
            font-size: .7rem;
            padding: 2px 6px;
            border-radius: 8px;
            font-weight: 600;
        }
        .code-block {
            background: #1a1a1a;
            border: 1px solid #333;
            border-radius: 8px;
            padding: 12px;
            margin: 8px 0;
            overflow-x: auto;
            color: #f8f8f2;
            font-family: 'Courier New', monospace;
        }
        .thinking-animation {
            background: linear-gradient(90deg, #667eea, #764ba2, #8a2be2);
            background-size: 200% 200%;
            animation: gradient 2s ease infinite;
        }
        .theme-purple { --primary: #8b5cf6; --secondary: #7c3aed; }
        .theme-blue { --primary: #3b82f6; --secondary: #2563eb; }
        .theme-green { --primary: #10b981; --secondary: #059669; }
        .theme-orange { --primary: #f59e0b; --secondary: #d97706; }
        .theme-pink { --primary: #ec4899; --secondary: #db2777; }
    </style>
</head>
<body class="font-sans bg-gray-50 dark:bg-gray-900 transition-all duration-300 theme-purple">
    <!-- Auth Modal -->
    <div id="authModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 fade-in">
        <div class="bg-white dark:bg-gray-800 rounded-2xl p-8 w-96 max-w-md mx-4 shadow-2xl">
            <div class="text-center mb-6">
                <div class="w-16 h-16 bg-gradient-to-r from-[var(--primary)] to-[var(--secondary)] rounded-2xl flex items-center justify-center mx-auto mb-4">
                    <i class="fas fa-brain text-white text-2xl"></i>
                </div>
                <h2 class="text-2xl font-bold text-gray-900 dark:text-white">LudvigAI</h2>
                <p class="text-gray-600 dark:text-gray-400">–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç</p>
            </div>

            <div id="loginForm">
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Email</label>
                        <input type="email" id="loginEmail" 
                               class="w-full border border-gray-300 dark:border-gray-600 rounded-xl px-4 py-3 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-[var(--primary)] transition duration-300">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">–ü–∞—Ä–æ–ª—å</label>
                        <input type="password" id="loginPassword" 
                               class="w-full border border-gray-300 dark:border-gray-600 rounded-xl px-4 py-3 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-[var(--primary)] transition duration-300">
                    </div>
                    <button onclick="login()" 
                            class="w-full bg-gradient-to-r from-[var(--primary)] to-[var(--secondary)] hover:from-[var(--secondary)] hover:to-[var(--primary)] text-white py-3 rounded-xl font-semibold transition-all duration-300 transform hover:scale-105 shadow-lg">
                        –í–æ–π—Ç–∏
                    </button>
                </div>
                <div class="mt-4 text-center">
                    <button onclick="toggleAuthForm()" class="text-[var(--primary)] dark:text-[var(--secondary)] hover:underline text-sm">
                        –ù–µ—Ç –∞–∫–∫–∞—É–Ω—Ç–∞? –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è
                    </button>
                </div>
                <div class="mt-6 pt-4 border-t border-gray-200 dark:border-gray-700">
                    <button onclick="enterAsGuest()" 
                            class="w-full border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 py-3 rounded-xl font-semibold hover:bg-gray-50 dark:hover:bg-gray-700 transition duration-300">
                        –í–æ–π—Ç–∏ –∫–∞–∫ –≥–æ—Å—Ç—å
                    </button>
                </div>
            </div>

            <div id="registerForm" class="hidden">
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">–ò–º—è</label>
                        <input type="text" id="registerName" 
                               class="w-full border border-gray-300 dark:border-gray-600 rounded-xl px-4 py-3 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-[var(--primary)] transition duration-300">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Email</label>
                        <input type="email" id="registerEmail" 
                               class="w-full border border-gray-300 dark:border-gray-600 rounded-xl px-4 py-3 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-[var(--primary)] transition duration-300">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">–ü–∞—Ä–æ–ª—å</label>
                        <input type="password" id="registerPassword" 
                               class="w-full border border-gray-300 dark:border-gray-600 rounded-xl px-4 py-3 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-[var(--primary)] transition duration-300">
                    </div>
                    <button onclick="register()" 
                            class="w-full bg-gradient-to-r from-[var(--primary)] to-[var(--secondary)] hover:from-[var(--secondary)] hover:to-[var(--primary)] text-white py-3 rounded-xl font-semibold transition-all duration-300 transform hover:scale-105 shadow-lg">
                        –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è
                    </button>
                </div>
                <div class="mt-4 text-center">
                    <button onclick="toggleAuthForm()" class="text-[var(--primary)] dark:text-[var(--secondary)] hover:underline text-sm">
                        –£–∂–µ –µ—Å—Ç—å –∞–∫–∫–∞—É–Ω—Ç? –í–æ–π—Ç–∏
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Main App -->
    <div id="mainApp" class="hidden">
        <div class="flex h-screen">
            <!-- Sidebar -->
            <div id="sidebar" class="sidebar-transition w-80 bg-white dark:bg-gray-800 border-r border-gray-200 dark:border-gray-700 flex flex-col h-full">
                <!-- Sidebar Header -->
                <div class="p-4 border-b border-gray-200 dark:border-gray-700">
                    <div class="flex items-center space-x-3">
                        <div class="w-10 h-10 bg-gradient-to-r from-[var(--primary)] to-[var(--secondary)] rounded-lg flex items-center justify-center">
                            <i class="fas fa-brain text-white text-lg"></i>
                        </div>
                        <div>
                            <h1 class="text-xl font-bold text-gray-900 dark:text-white">LudvigAI</h1>
                            <p class="text-sm text-gray-500 dark:text-gray-400" id="userGreeting">–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç</p>
                        </div>
                    </div>
                </div>

                <!-- New Chat Button -->
                <div class="p-4">
                    <button id="newChatBtn" class="w-full bg-gradient-to-r from-[var(--primary)] to-[var(--secondary)] hover:from-[var(--secondary)] hover:to-[var(--primary)] text-white py-3 px-4 rounded-lg font-semibold transition-all duration-300 transform hover:scale-105 shadow-lg">
                        <i class="fas fa-plus mr-2"></i>
                        –ù–æ–≤—ã–π —á–∞—Ç
                    </button>
                </div>

                <!-- Chat History -->
                <div id="chatHistory" class="flex-1 overflow-y-auto p-4 space-y-2">
                    <!-- Chat history will be populated here -->
                </div>

                <!-- User Profile -->
                <div class="p-4 border-t border-gray-200 dark:border-gray-700">
                    <div class="flex items-center space-x-3">
                        <div id="userAvatar" class="w-8 h-8 bg-gradient-to-r from-green-500 to-blue-500 rounded-full flex items-center justify-center">
                            <span class="text-white text-sm font-bold">–ì</span>
                        </div>
                        <div class="flex-1">
                            <p class="text-sm font-medium text-gray-900 dark:text-white" id="userName">–ì–æ—Å—Ç—å</p>
                            <p class="text-xs text-gray-500 dark:text-gray-400" id="userType">–ì–æ—Å—Ç–µ–≤–æ–π —Ä–µ–∂–∏–º</p>
                        </div>
                        <button onclick="openSettings()" class="text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 transition-colors duration-200">
                            <i class="fas fa-cog"></i>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Main Chat Area -->
            <div class="flex-1 flex flex-col h-full">
                <!-- Chat Header -->
                <div class="border-b border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 p-4">
                    <div class="flex items-center space-x-3">
                        <div class="w-8 h-8 bg-gradient-to-r from-[var(--primary)] to-[var(--secondary)] rounded-lg flex items-center justify-center">
                            <i class="fas fa-brain text-white text-sm"></i>
                        </div>
                        <div>
                            <h2 class="text-lg font-semibold text-gray-900 dark:text-white">LudvigAI</h2>
                            <p class="text-sm text-gray-500 dark:text-gray-400" id="modelDescription">–ì–æ—Ç–æ–≤ –ø–æ–º–æ—á—å</p>
                        </div>
                    </div>
                </div>

                <!-- Messages Container -->
                <div id="messagesContainer" class="flex-1 overflow-y-auto p-6 space-y-6">
                    <!-- Welcome Message -->
                    <div class="message-enter flex justify-start">
                        <div class="flex space-x-3 max-w-4xl">
                            <div class="w-8 h-8 bg-gradient-to-r from-[var(--primary)] to-[var(--secondary)] rounded-full flex items-center justify-center flex-shrink-0">
                                <i class="fas fa-brain text-white text-sm"></i>
                            </div>
                            <div class="bg-white dark:bg-gray-700 rounded-2xl rounded-tl-none px-6 py-4 shadow-lg border border-gray-200 dark:border-gray-600">
                                <p class="text-gray-900 dark:text-white text-lg leading-relaxed">
                                    –ü—Ä–∏–≤–µ—Ç! –Ø LudvigAI - –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç. ü§ñ<br><br>
                                    –ú–æ–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:
                                    ‚Ä¢ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–¥–∞ –Ω–∞ –ª—é–±—ã—Ö —è–∑—ã–∫–∞—Ö<br>
                                    ‚Ä¢ –ì–ª—É–±–æ–∫–∏–π –∞–Ω–∞–ª–∏–∑ —Å–ª–æ–∂–Ω—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤<br>
                                    ‚Ä¢ –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è<br>
                                    ‚Ä¢ –¢–≤–æ—Ä—á–µ—Å–∫–∏–µ –∑–∞–¥–∞—á–∏<br><br>
                                    –°–ø—Ä–∞—à–∏–≤–∞–π —á—Ç–æ —É–≥–æ–¥–Ω–æ!
                                </p>
                                <div class="flex flex-wrap gap-2 mt-4">
                                    <button class="suggestion-btn bg-purple-100 dark:bg-purple-900/30 hover:bg-purple-200 dark:hover:bg-purple-900/50 text-purple-700 dark:text-purple-300 px-4 py-2 rounded-lg text-sm transition-colors duration-200 border border-purple-200 dark:border-purple-700">
                                        –ù–∞–ø–∏—à–∏ –∫–æ–¥ –Ω–∞ Python
                                    </button>
                                    <button class="suggestion-btn bg-blue-100 dark:bg-blue-900/30 hover:bg-blue-200 dark:hover:bg-blue-900/50 text-blue-700 dark:text-blue-300 px-4 py-2 rounded-lg text-sm transition-colors duration-200 border border-blue-200 dark:border-blue-700">
                                        –û–±—ä—è—Å–Ω–∏ –∫–≤–∞–Ω—Ç–æ–≤—É—é —Ñ–∏–∑–∏–∫—É
                                    </button>
                                    <button class="suggestion-btn bg-green-100 dark:bg-green-900/30 hover:bg-green-200 dark:hover:bg-green-900/50 text-green-700 dark:text-green-300 px-4 py-2 rounded-lg text-sm transition-colors duration-200 border border-green-200 dark:border-green-700">
                                        –ü–æ–º–æ–≥–∏ —Å –∞–ª–≥–æ—Ä–∏—Ç–º–æ–º
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Input Area -->
                <div class="border-t border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 p-6">
                    <div class="max-w-4xl mx-auto">
                        <div class="flex space-x-4">
                            <div class="flex-1 relative">
                                <textarea 
                                    id="messageInput" 
                                    placeholder="–ù–∞–ø–∏—à–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..." 
                                    rows="1"
                                    class="w-full border border-gray-300 dark:border-gray-600 rounded-2xl py-4 px-6 pr-12 bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 resize-none focus:outline-none focus:ring-2 focus:ring-[var(--primary)] focus:border-[var(--primary)] transition-all duration-300 text-lg max-h-32"
                                    oninput="autoResize(this)"
                                ></textarea>
                                <button id="sendButton" onclick="sendMessage()" class="absolute right-3 top-1/2 transform -translate-y-1/2 bg-gradient-to-r from-[var(--primary)] to-[var(--secondary)] hover:from-[var(--secondary)] hover:to-[var(--primary)] text-white p-2 rounded-lg transition-all duration-300">
                                    <i class="fas fa-paper-plane text-sm"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // State management
        let currentUser = null;
        let currentChatId = 'default';
        let chats = {
            'default': {
                id: 'default',
                title: '–ù–æ–≤—ã–π —á–∞—Ç',
                messages: [],
                createdAt: new Date().toISOString()
            }
        };

        // AI Knowledge Base
        const knowledgeBase = {
            python: {
                basics: `Python - –≤—ã—Å–æ–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π —è–∑—ã–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è.

–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏:
‚Ä¢ –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö
‚Ä¢ –§—É–Ω–∫—Ü–∏–∏ –∏ –∫–ª–∞—Å—Å—ã  
‚Ä¢ –ú–æ–¥—É–ª–∏ –∏ –ø–∞–∫–µ—Ç—ã
‚Ä¢ –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π

–ü—Ä–∏–º–µ—Ä:
\`\`\`python
# –ü—Ä–æ—Å—Ç–æ–π –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä
def calculator():
    while True:
        try:
            num1 = float(input("–í–≤–µ–¥–∏—Ç–µ –ø–µ—Ä–≤–æ–µ —á–∏—Å–ª–æ: "))
            operator = input("–í–≤–µ–¥–∏—Ç–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä (+, -, *, /): ")
            num2 = float(input("–í–≤–µ–¥–∏—Ç–µ –≤—Ç–æ—Ä–æ–µ —á–∏—Å–ª–æ: "))
            
            if operator == '+':
                result = num1 + num2
            elif operator == '-':
                result = num1 - num2
            elif operator == '*':
                result = num1 * num2
            elif operator == '/':
                if num2 == 0:
                    print("–û—à–∏–±–∫–∞: –¥–µ–ª–µ–Ω–∏–µ –Ω–∞ –Ω–æ–ª—å!")
                    continue
                result = num1 / num2
            else:
                print("–ù–µ–≤–µ—Ä–Ω—ã–π –æ–ø–µ—Ä–∞—Ç–æ—Ä!")
                continue
                
            print(f"–†–µ–∑—É–ª—å—Ç–∞—Ç: {result}")
            
        except ValueError:
            print("–û—à–∏–±–∫–∞: –≤–≤–µ–¥–∏—Ç–µ —á–∏—Å–ª–∞!")
        except KeyboardInterrupt:
            print("\n–í—ã—Ö–æ–¥ –∏–∑ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞")
            break

calculator()
\`\`\``,
                
                oop: `–û–±—ä–µ–∫—Ç–Ω–æ-–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ Python:

\`\`\`python
class BankAccount:
    def __init__(self, account_holder, initial_balance=0):
        self.account_holder = account_holder
        self._balance = initial_balance
        self._transactions = []
    
    @property
    def balance(self):
        return self._balance
    
    def deposit(self, amount):
        if amount > 0:
            self._balance += amount
            self._transactions.append(f"Deposit: +${amount}")
            return True
        return False
    
    def withdraw(self, amount):
        if 0 < amount <= self._balance:
            self._balance -= amount
            self._transactions.append(f"Withdraw: -${amount}")
            return True
        return False
    
    def get_transaction_history(self):
        return self._transactions

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
account = BankAccount("–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤", 1000)
account.deposit(500)
account.withdraw(200)
print(f"–ë–∞–ª–∞–Ω—Å: ${account.balance}")
print("–ò—Å—Ç–æ—Ä–∏—è:", account.get_transaction_history())
\`\`\``
            },
            
            javascript: {
                modern: `–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π JavaScript (ES6+):

\`\`\`javascript
// –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
async function fetchData(url) {
    try {
        const response = await fetch(url);
        if (!response.ok) {
            throw new Error(\`HTTP error! status: \${response.status}\`);
        }
        const data = await response.json();
        return data;
    } catch (error) {
        console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏:', error);
        throw error;
    }
}

// –ö–ª–∞—Å—Å—ã
class ApiClient {
    constructor(baseURL) {
        this.baseURL = baseURL;
    }
    
    async get(endpoint) {
        return fetchData(\`\${this.baseURL}\${endpoint}\`);
    }
    
    async post(endpoint, data) {
        return fetchData(\`\${this.baseURL}\${endpoint}\`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(data)
        });
    }
}

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
const api = new ApiClient('https://jsonplaceholder.typicode.com');
api.get('/users/1')
   .then(user => console.log('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:', user))
   .catch(error => console.error('–û—à–∏–±–∫–∞:', error));
\`\`\``
            },
            
            algorithms: {
                sorting: `–ê–ª–≥–æ—Ä–∏—Ç–º—ã —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏:

\`\`\`python
def bubble_sort(arr):
    """–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø—É–∑—ã—Ä—å–∫–æ–º O(n¬≤)"""
    n = len(arr)
    for i in range(n):
        for j in range(0, n - i - 1):
            if arr[j] > arr[j + 1]:
                arr[j], arr[j + 1] = arr[j + 1], arr[j]
    return arr

def quick_sort(arr):
    """–ë—ã—Å—Ç—Ä–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ O(n log n)"""
    if len(arr) <= 1:
        return arr
    pivot = arr[len(arr) // 2]
    left = [x for x in arr if x < pivot]
    middle = [x for x in arr if x == pivot]
    right = [x for x in arr if x > pivot]
    return quick_sort(left) + middle + quick_sort(right)

# –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
numbers = [64, 34, 25, 12, 22, 11, 90]
print("–ò—Å—Ö–æ–¥–Ω—ã–π –º–∞—Å—Å–∏–≤:", numbers)
print("–ü—É–∑—ã—Ä—å–∫–æ–≤–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞:", bubble_sort(numbers.copy()))
print("–ë—ã—Å—Ç—Ä–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞:", quick_sort(numbers.copy()))
\`\`\``
            }
        };

        // Core Functions
        function login() {
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            
            if (!email || !password) {
                alert('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è');
                return;
            }
            
            currentUser = {
                email: email,
                name: email.split('@')[0],
                isGuest: false
            };
            
            showMainApp();
        }

        function enterAsGuest() {
            currentUser = {
                email: 'guest@example.com',
                name: '–ì–æ—Å—Ç—å',
                isGuest: true
            };
            
            showMainApp();
        }

        function showMainApp() {
            document.getElementById('authModal').classList.add('hidden');
            document.getElementById('mainApp').classList.remove('hidden');
            
            // Update UI with user info
            document.getElementById('userName').textContent = currentUser.name;
            document.getElementById('userGreeting').textContent = `–ü—Ä–∏–≤–µ—Ç, ${currentUser.name}`;
            
            if (currentUser.isGuest) {
                document.getElementById('userType').textContent = '–ì–æ—Å—Ç–µ–≤–æ–π —Ä–µ–∂–∏–º';
            }
        }

        function toggleAuthForm() {
            const loginForm = document.getElementById('loginForm');
            const registerForm = document.getElementById('registerForm');
            
            if (loginForm.classList.contains('hidden')) {
                loginForm.classList.remove('hidden');
                registerForm.classList.add('hidden');
            } else {
                loginForm.classList.add('hidden');
                registerForm.classList.remove('hidden');
            }
        }

        function register() {
            const name = document.getElementById('registerName').value;
            const email = document.getElementById('registerEmail').value;
            const password = document.getElementById('registerPassword').value;
            
            if (!name || !email || !password) {
                alert('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è');
                return;
            }
            
            currentUser = {
                email: email,
                name: name,
                isGuest: false
            };
            
            showMainApp();
        }

        function autoResize(textarea) {
            textarea.style.height = 'auto';
            textarea.style.height = Math.min(textarea.scrollHeight, 128) + 'px';
        }

        function sendMessage() {
            const messageInput = document.getElementById('messageInput');
            const message = messageInput.value.trim();
            
            if (!message) return;
            
            // Add user message
            addMessage(message, 'user');
            messageInput.value = '';
            autoResize(messageInput);
            
            // Generate AI response
            setTimeout(() => {
                const response = generateAIResponse(message);
                addMessage(response, 'ai');
            }, 1000);
        }

        function addMessage(content, sender) {
            const messagesContainer = document.getElementById('messagesContainer');
            const messageDiv = document.createElement('div');
            
            messageDiv.className = `message-enter flex ${sender === 'user' ? 'justify-end' : 'justify-start'}`;
            
            messageDiv.innerHTML = `
                <div class="flex space-x-3 max-w-4xl ${sender === 'user' ? 'flex-row-reverse space-x-reverse' : ''}">
                    <div class="w-8 h-8 ${sender === 'user' ? 'bg-gradient-to-r from-green-500 to-blue-500' : 'bg-gradient-to-r from-[var(--primary)] to-[var(--secondary)]'} rounded-full flex items-center justify-center flex-shrink-0">
                        ${sender === 'user' ? 
                            '<span class="text-white text-sm font-bold">' + (currentUser.name.charAt(0).toUpperCase()) + '</span>' :
                            '<i class="fas fa-brain text-white text-sm"></i>'
                        }
                    </div>
                    <div class="${sender === 'user' ? 'bg-blue-500 text-white' : 'bg-white dark:bg-gray-700 text-gray-900 dark:text-white'} rounded-2xl ${sender === 'user' ? 'rounded-tr-none' : 'rounded-tl-none'} px-6 py-4 shadow-lg border border-gray-200 dark:border-gray-600 max-w-2xl">
                        <p class="leading-relaxed whitespace-pre-wrap">${formatMessage(content)}</p>
                    </div>
                </div>
            `;
            
            messagesContainer.appendChild(messageDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
            
            // Add to chat history
            chats[currentChatId].messages.push({
                content: content,
                sender: sender,
                timestamp: new Date().toISOString()
            });
        }

        function formatMessage(content) {
            // Simple code formatting
            return content.replace(/```(\w+)?\n([\s\S]*?)```/g, '<div class="code-block my-2"><div class="text-xs opacity-75 mb-1">$1</div>$2</div>');
        }

        function generateAIResponse(userMessage) {
            const lowerMessage = userMessage.toLowerCase();
            
            // Check for programming questions
            if (lowerMessage.includes('python') || lowerMessage.includes('–ø–∏—Ç–æ–Ω')) {
                if (lowerMessage.includes('oop') || lowerMessage.includes('–æ–±—ä–µ–∫—Ç') || lowerMessage.includes('–∫–ª–∞—Å—Å')) {
                    return knowledgeBase.python.oop;
                }
                return knowledgeBase.python.basics;
            }
            
            if (lowerMessage.includes('javascript') || lowerMessage.includes('js') || lowerMessage.includes('–¥–∂–∞–≤–∞—Å–∫—Ä–∏–ø—Ç')) {
                return knowledgeBase.javascript.modern;
            }
            
            if (lowerMessage.includes('–∞–ª–≥–æ—Ä–∏—Ç–º') || lowerMessage.includes('—Å–æ—Ä—Ç–∏—Ä–æ–≤–∫') || lowerMessage.includes('algorithm')) {
                return knowledgeBase.algorithms.sorting;
            }
            
            if (lowerMessage.includes('–ø—Ä–∏–≤–µ—Ç') || lowerMessage.includes('hello') || lowerMessage.includes('hi')) {
                return `–ü—Ä–∏–≤–µ—Ç! ${currentUser.name}! –†–∞–¥ —Ç–µ–±—è –≤–∏–¥–µ—Ç—å! –ß–µ–º –º–æ–≥—É –ø–æ–º–æ—á—å?`;
            }
            
            if (lowerMessage.includes('–∫–∞–∫ –¥–µ–ª–∞') || lowerMessage.includes('–∫–∞–∫ —Ç—ã')) {
                return `–£ –º–µ–Ω—è –≤—Å—ë –æ—Ç–ª–∏—á–Ω–æ! –ì–æ—Ç–æ–≤ –ø–æ–º–æ—á—å —Å –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ–º, –∞–ª–≥–æ—Ä–∏—Ç–º–∞–º–∏ –∏–ª–∏ –ª—é–±—ã–º–∏ –¥—Ä—É–≥–∏–º–∏ –≤–æ–ø—Ä–æ—Å–∞–º–∏. –ß—Ç–æ —Ç–µ–±—è –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç?`;
            }
            
            // Default response
            const defaultResponses = [
                "–ò–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π –≤–æ–ø—Ä–æ—Å! –ú–æ–≥—É –ø–æ–º–æ—á—å —Å –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ–º, –∞–ª–≥–æ—Ä–∏—Ç–º–∞–º–∏ –∏–ª–∏ –¥—Ä—É–≥–∏–º–∏ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–º–∏ —Ç–µ–º–∞–º–∏.",
                "–û—Ç–ª–∏—á–Ω—ã–π –≤–æ–ø—Ä–æ—Å! –î–∞–≤–∞–π –æ–±—Å—É–¥–∏–º —ç—Ç–æ –ø–æ–¥—Ä–æ–±–Ω–µ–µ. –ß—Ç–æ –∏–º–µ–Ω–Ω–æ —Ç–µ–±—è –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç?",
                "–ü–æ–Ω—è–ª —Ç–µ–±—è! –ú–æ–≥—É –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å –ø—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞ –∏–ª–∏ –æ–±—ä—è—Å–Ω–∏—Ç—å –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è.",
                "–•–æ—Ä–æ—à–∏–π –≤–æ–ø—Ä–æ—Å! –î–∞–≤–∞–π —Ä–∞–∑–±–µ—Ä–µ–º –µ–≥–æ –≤–º–µ—Å—Ç–µ. –£—Ç–æ—á–Ω–∏, —á—Ç–æ —Ç–µ–±–µ –Ω—É–∂–Ω–æ?"
            ];
            
            return defaultResponses[Math.floor(Math.random() * defaultResponses.length)];
        }

        // Enter key handler
        document.getElementById('messageInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                sendMessage();
            }
        });

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            // Add suggestion button handlers
            document.querySelectorAll('.suggestion-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.getElementById('messageInput').value = this.textContent;
                    sendMessage();
                });
            });
        });

        function openSettings() {
            // Simple settings implementation
            const currentTheme = document.body.className.match(/theme-\w+/)[0];
            const newTheme = currentTheme === 'theme-purple' ? 'theme-blue' : 'theme-purple';
            
            document.body.className = document.body.className.replace(/theme-\w+/, newTheme);
        }
    </script>
</body>
</html>
