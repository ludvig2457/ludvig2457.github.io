<!DOCTYPE html>
<html lang="ru>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>LudvigAI  –≤–∏–Ω—É—Ç—ã–π AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç</title>
<script src="cdn.tailwindcss.com"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>
<style>
/* –û–±—â–∏–µ —Å—Ç–∏–ª–∏ –∏ –∞–Ω–∏–º–∞—Ü–∏–∏ */
.gradient-bg {
  background: linear-gradient(-45deg, #667eea, #764ba2, #8a2be2, #6b46c1);
  background-size: 400% 400%;
  animation: gradient 15s ease infinite;
}
.gradient-text {
  background: linear-gradient(135deg, #667eea, #8a2be2);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-size: 200% 200%;
  animation: gradient 8s ease infinite;
}
@keyframes gradient {
  0%, 100% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
}
.sidebar-transition {
  transition: all 0.3s ease;
}
.message-enter {
  animation: messageEnter 0.3s ease;
}
@keyframes messageEnter {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}
.typing-dots {
  display: inline-block;
}
.typing-dots span {
  animation: typing 1.4s infinite;
}
.typing-dots span:nth-child(2) {
  animation-delay: 0.2s;
}
.typing-dots span:nth-child(3) {
  animation-delay: 0.4s;
}
@keyframes typing {
  0%, 60%, 100% { transform: translateY(0); }
  30% { transform: translateY(-10px); }
}
.fade-in {
  animation: fadeIn 0.5s ease;
}
@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}
.model-badge {
  font-size: 0.7rem;
  padding: 2px 6px;
  border-radius: 8px;
  font-weight: 600;
}
.code-block {
  background: #1a1a1a;
  border: 1px solid #333;
  border-radius: 8px;
  padding: 12px;
  margin: 8px 0;
  overflow-x: auto;
  color: #f8f8f2;
  font-family: 'Courier New', monospace;
}
.thinking-animation {
  background: linear-gradient(90deg, #667eea, #764ba2, #8a2be2);
  background-size: 200% 200%;
  animation: gradient 2s ease infinite;
}
</style>
</head>
<body class="font-sans bg-gray-50 dark:bg-gray-900 transition-all duration-300 theme-purple">

<!-- AUTH MODAL -->
<div id="authModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 fade-in">
  <div class="bg-white dark:bg-gray-800 rounded-2xl p-8 w-96 max-w-md mx-4 shadow-2xl">
    <div class="text-center mb-6">
      <div class="w-16 h-16 bg-gradient-to-r from-[var(--primary)] to-[var(--secondary)] rounded-2xl flex items-center justify-center mx-auto mb-4">
        <i class="fas fa-brain text-white text-2xl"></i>
      </div>
      <h2 class="text-2xl font-bold text-gray-900 dark:text-white">LudvigAI</h2>
      <p class="text-gray-600 dark:text-gray-400">–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç</p>
    </div>
    <!-- –õ–æ–≥–∏–Ω -->
    <div id="loginForm" class="">
      <div class="space-y-4">
        <div>
          <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Email</label>
          <input id="loginEmail" type="email" class="w-full border border-gray-300 dark:border-gray-600 rounded-xl px-4 py-3 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-[var(--primary)] transition duration-300"/>
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">–ü–∞—Ä–æ–ª—å</label>
          <input id="loginPassword" type="password" class="w-full border border-gray-300 dark:border-gray-600 rounded-xl px-4 py-3 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-[var(--primary)] transition duration-300"/>
        </div>
        <button onclick="login()" class="w-full bg-gradient-to-r from-[var(--primary)] to-[var(--secondary)] hover:from-[var(--secondary)] hover:to-[var(--primary)] text-white py-3 rounded-xl font-semibold transition-all duration-300 transform hover:scale-105 shadow-lg">–í–æ–π—Ç–∏</button>
      </div>
      <div class="mt-4 text-center">
        <button onclick="toggleAuthForm()" class="text-[var(--primary)] dark:text-[var(--secondary)] hover:underline text-sm">–ù–µ—Ç –∞–∫–∫–∞—É–Ω—Ç–∞? –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
      </div>
      <div class="mt-6 pt-4 border-t border-gray-200 dark:border-gray-700">
        <button onclick="enterAsGuest()" class="w-full border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 py-3 rounded-xl font-semibold hover:bg-gray-50 dark:hover:bg-gray-700 transition duration-300">–í–æ–π—Ç–∏ –∫–∞–∫ –≥–æ—Å—Ç—å</button>
      </div>
    </div>
    <!-- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è -->
    <div id="registerForm" class="hidden">
      <div class="space-y-4">
        <div>
          <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">–ò–º—è</label>
          <input id="registerName" type="text" class="w-full border border-gray-300 dark:border-gray-600 rounded-xl px-4 py-3 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-[var(--primary)] transition duration-300"/>
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Email</label>
          <input id="registerEmail" type="email" class="w-full border border-gray-300 dark:border-gray-600 rounded-xl px-4 py-3 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-[var(--primary)] transition duration-300"/>
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">–ü–∞—Ä–æ–ª—å</label>
          <input id="registerPassword" type="password" class="w-full border border-gray-300 dark:border-gray-600 rounded-xl px-4 py-3 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-[var(--primary)] transition duration-300"/>
        </div>
        <button onclick="register()" class="w-full bg-gradient-to-r from-[var(--primary)] to-[var(--secondary)] hover:from-[var(--secondary)] hover:to-[var(--primary)] text-white py-3 rounded-xl font-semibold transition-all duration-300 transform hover:scale-105 shadow-lg">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
      </div>
      <div class="mt-4 text-center">
        <button onclick="toggleAuthForm()" class="text-[var(--primary)] dark:text-[var(--secondary)] hover:underline text-sm">–£–∂–µ –µ—Å—Ç—å –∞–∫–∫–∞—É–Ω—Ç? –í–æ–π—Ç–∏</button>
      </div>
    </div>
  </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤—ã–±–æ—Ä–∞ –º–æ–¥–µ–ª–∏ -->
<div id="modelModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
  <div class="bg-white dark:bg-gray-800 rounded-2xl p-6 w-96 max-w-md mx-4 shadow-2xl overflow-y-auto max-h-full">
    <div class="flex items-center justify-between mb-6">
      <h3 class="text-xl font-bold text-gray-900 dark:text-white">–í—ã–±–æ—Ä –º–æ–¥–µ–ª–∏ AI</h3>
      <button onclick="closeModelSelector()" class="text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300"><i class="fas fa-times text-lg"></i></button>
    </div>
    <div class="space-y-3">
      <!-- –ú–æ–¥–µ–ª–∏ -->
      <div class="model-option border-2 border-gray-200 dark:border-gray-600 rounded-xl p-4 cursor-pointer hover:border-[var(--primary)] transition" onclick="selectModel('mini')">
        <div class="flex items-center justify-between">
          <div>
            <h4 class="font-semibold text-gray-900 dark:text-white">LudvigAI 1.0 Mini</h4>
            <p class="text-sm text-gray-600 dark:text-gray-400">–ë—ã—Å—Ç—Ä–∞—è –∏ –ª–µ–≥–∫–∞—è</p>
          </div>
          <span class="model-badge bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200">–ë–µ—Å–ø–ª–∞—Ç–Ω–æ</span>
        </div>
        <div class="mt-2 text-xs text-gray-500 dark:text-gray-400">–ë—ã—Å—Ç—Ä—ã–µ –æ—Ç–≤–µ—Ç—ã ‚Ä¢ –ë–∞–∑–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏</div>
      </div>
      <div class="model-option border-2 border-gray-200 dark:border-gray-600 rounded-xl p-4 cursor-pointer hover:border-[var(--primary)] transition" onclick="selectModel('standard')">
        <div class="flex items-center justify-between">
          <div>
            <h4 class="font-semibold text-gray-900 dark:text-white">LudvigAI 1.0</h4>
            <p class="text-sm text-gray-600 dark:text-gray-400">–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –≤–µ—Ä—Å–∏—è</p>
          </div>
          <span class="model-badge bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200">–ë–µ—Å–ø–ª–∞—Ç–Ω–æ</span>
        </div>
        <div class="mt-2 text-xs text-gray-500 dark:text-gray-400">–£–ª—É—á—à–µ–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã ‚Ä¢ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–æ–¥–∞</div>
      </div>
      <div class="model-option border-2 border-gray-200 dark:border-gray-600 rounded-xl p-4 cursor-pointer hover:border-[var(--primary)] transition" onclick="selectModel('plus')">
        <div class="flex items-center justify-between">
          <div>
            <h4 class="font-semibold text-gray-900 dark:text-white">LudvigAI 1.0 Plus</h4>
            <p class="text-sm text-gray-600 dark:text-gray-400">–†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏</p>
          </div>
          <span class="model-badge bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200">Premium</span>
        </div>
        <div class="mt-2 text-xs text-gray-500 dark:text-gray-400">–ö—Ä–µ–∞—Ç–∏–≤–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã ‚Ä¢ –ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö</div>
      </div>
      <div class="model-option border-2 border-gray-200 dark:border-gray-600 rounded-xl p-4 cursor-pointer hover:border-[var(--primary)] transition" onclick="selectModel('pro')">
        <div class="flex items-center justify-between">
          <div>
            <h4 class="font-semibold text-gray-900 dark:text-white">LudvigAI 1.0 Pro</h4>
            <p class="text-sm text-gray-600 dark:text-gray-400">–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è</p>
          </div>
          <span class="model-badge bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200">Pro</span>
        </div>
        <div class="mt-2 text-xs text-gray-500 dark:text-gray-400">–°–ª–æ–∂–Ω—ã–π –∞–Ω–∞–ª–∏–∑ ‚Ä¢ –≠–∫—Å–ø–µ—Ä—Ç–Ω—ã–µ –∑–Ω–∞–Ω–∏—è</div>
      </div>
      <div class="model-option border-2 border-gray-200 dark:border-gray-600 rounded-xl p-4 cursor-pointer hover:border-[var(--primary)] transition" onclick="selectModel('ultimate')">
        <div class="flex items-center justify-between">
          <div>
            <h4 class="font-semibold text-gray-900 dark:text-white">LudvigAI 1.0 Ultimate</h4>
            <p class="text-sm text-gray-600 dark:text-gray-400">–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –º–æ—â–Ω–æ—Å—Ç—å</p>
          </div>
          <span class="model-badge bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200">Ultimate</span>
        </div>
        <div class="mt-2 text-xs text-gray-500 dark:text-gray-400">–í—Å–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ ‚Ä¢ –ú–∞–∫—Å. –∫—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç—å</div>
      </div>
    </div>
    <div class="mt-6 p-4 bg-gray-50 dark:bg-gray-700 rounded-lg">
      <h4 class="font-semibold text-gray-900 dark:text-white mb-2">–¢–µ–∫—É—â–∞—è –º–æ–¥–µ–ª—å:</h4>
      <p class="text-sm text-gray-600 dark:text-gray-400" id="currentModelInfo">LudvigAI 1.0</p>
    </div>
  </div>
</div>

<!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ -->
<div id="settingsModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
  <div class="bg-white dark:bg-gray-800 rounded-2xl p-6 w-96 max-w-md mx-4 shadow-2xl overflow-y-auto max-h-full">
    <div class="flex items-center justify-between mb-6">
      <h3 class="text-xl font-bold text-gray-900 dark:text-white">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</h3>
      <button onclick="closeSettings()" class="text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300"><i class="fas fa-times text-lg"></i></button>
    </div>
    <div class="space-y-6">
      <!-- –¢–µ–º–∞ -->
      <div>
        <h4 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">–¢–µ–º–∞ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è</h4>
        <div class="grid grid-cols-3 gap-3">
          <div class="theme-option theme-purple border-2 border-gray-300 rounded-lg p-3 cursor-pointer hover:scale-105 transition" onclick="selectTheme('purple')">
            <div class="w-full h-8 bg-gradient-to-r from-purple-500 to-purple-600 rounded mb-2"></div>
            <span class="text-xs text-gray-600 dark:text-gray-400">–§–∏–æ–ª–µ—Ç–æ–≤–∞—è</span>
          </div>
          <div class="theme-option theme-blue border-2 border-gray-300 rounded-lg p-3 cursor-pointer hover:scale-105 transition" onclick="selectTheme('blue')">
            <div class="w-full h-8 bg-gradient-to-r from-blue-500 to-blue-600 rounded mb-2"></div>
            <span class="text-xs text-gray-600 dark:text-gray-400">–°–∏–Ω—è—è</span>
          </div>
          <div class="theme-option theme-green border-2 border-gray-300 rounded-lg p-3 cursor-pointer hover:scale-105 transition" onclick="selectTheme('green')">
            <div class="w-full h-8 bg-gradient-to-r from-green-500 to-green-600 rounded mb-2"></div>
            <span class="text-xs text-gray-600 dark:text-gray-400">–ó–µ–ª–µ–Ω–∞—è</span>
          </div>
          <div class="theme-option theme-orange border-2 border-gray-300 rounded-lg p-3 cursor-pointer hover:scale-105 transition" onclick="selectTheme('orange')">
            <div class="w-full h-8 bg-gradient-to-r from-orange-500 to-orange-600 rounded mb-2"></div>
            <span class="text-xs text-gray-600 dark:text-gray-400">–û—Ä–∞–Ω–∂–µ–≤–∞—è</span>
          </div>
          <div class="theme-option theme-pink border-2 border-gray-300 rounded-lg p-3 cursor-pointer hover:scale-105 transition" onclick="selectTheme('pink')">
            <div class="w-full h-8 bg-gradient-to-r from-pink-500 to-pink-600 rounded mb-2"></div>
            <span class="text-xs text-gray-600 dark:text-gray-400">–†–æ–∑–æ–≤–∞—è</span>
          </div>
        </div>
      </div>
      <!-- –ú–æ–¥–µ–ª—å -->
      <div>
        <h4 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">AI –ú–æ–¥–µ–ª—å</h4>
        <div class="flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg">
          <div>
            <span class="font-medium text-gray-900 dark:text-white" id="currentModelDisplay">LudvigAI 1.0</span>
            <p class="text-sm text-gray-600 dark:text-gray-400" id="modelCapabilities">–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏</p>
          </div>
          <button onclick="openModelSelector()" class="text-[var(--primary)] dark:text-[var(--secondary)] hover:text-[var(--secondary)] dark:hover:text-[var(--primary)] text-sm font-semibold">–°–º–µ–Ω–∏—Ç—å</button>
        </div>
      </div>
      <!-- LudvigThink / LudvigSearch -->
      <div>
        <h4 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">–§—É–Ω–∫—Ü–∏–∏</h4>
        <div class="flex items-center justify-between mb-2">
          <div>
            <span class="text-gray-700 dark:text-gray-300">LudvigThink</span>
            <p class="text-xs text-gray-500 dark:text-gray-400">–ì–ª—É–±–æ–∫–∏–π –∞–Ω–∞–ª–∏–∑</p>
          </div>
          <input type="checkbox" id="ludvigThinkToggle" class="sr-only peer" onchange="toggleLudvigThink()"/>
          <div class="w-11 h-6 bg-gray-200 rounded-full peer-focus:ring-4 peer-focus:ring-[var(--primary)] peer dark:bg-gray-600 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-[var(--primary)]"></div>
        </div>
        <div class="flex items-center justify-between mb-2">
          <div>
            <span class="text-gray-700 dark:text-gray-300">LudvigSearch</span>
            <p class="text-xs text-gray-500 dark:text-gray-400">–ü–æ–∏—Å–∫ –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ</p>
          </div>
          <input type="checkbox" id="ludvigSearchToggle" class="sr-only peer" onchange="toggleLudvigSearch()"/>
          <div class="w-11 h-6 bg-gray-200 rounded-full peer-focus:ring-4 peer-focus:ring-[var(--primary)] peer dark:bg-gray-600 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-[var(--primary)]"></div>
        </div>
      </div>
      <!-- –í–Ω–µ—à–Ω–∏–π –≤–∏–¥ -->
      <div>
        <h4 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">–í–Ω–µ—à–Ω–∏–π –≤–∏–¥</h4>
        <div class="flex items-center justify-between mb-2">
          <span class="text-gray-700 dark:text-gray-300">–¢–µ–º–Ω–∞—è —Ç–µ–º–∞</span>
          <input type="checkbox" id="darkModeToggle" class="sr-only peer"/>
          <div class="w-11 h-6 bg-gray-200 rounded-full peer-focus:ring-4 peer-focus:ring-[var(--primary)] peer dark:bg-gray-600 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-[var(--primary)]"></div>
        </div>
      </div>
      <!-- –ê–∫–∫–∞—É–Ω—Ç -->
      <div>
        <h4 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">–ê–∫–∫–∞—É–Ω—Ç</h4>
        <div id="userInfo" class="p-3 bg-gray-50 dark:bg-gray-700 rounded-lg">
          <p class="text-sm text-gray-600 dark:text-gray-400" id="userStatus"></p>
        </div>
        <button onclick="logout()" class="w-full bg-red-600 hover:bg-red-700 text-white py-2 rounded-lg font-semibold transition duration-300 mt-2">–í—ã–π—Ç–∏</button>
      </div>
    </div>
  </div>
</div>

<!-- –û—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å -->
<div id="mainApp" class="hidden">
  <!-- –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–µ–º–æ–π -->
  <div class="fixed top-4 right-4 z-50 flex space-x-2">
    <button id="themeToggle" class="bg-white dark:bg-gray-800 p-3 rounded-full shadow-lg border border-gray-200 dark:border-gray-700 hover:shadow-xl transition-all duration-300">
      <i class="fas fa-moon text-gray-600 dark:text-yellow-400"></i>
    </button>
    <button onclick="openSettings()" class="bg-white dark:bg-gray-800 p-3 rounded-full shadow-lg border border-gray-200 dark:border-gray-700 hover:shadow-xl transition-all duration-300">
      <i class="fas fa-cog"></i>
    </button>
  </div>
  <div class="flex h-screen">
    <!-- –ë–æ–∫–æ–≤–∞—è –ø–∞–Ω–µ–ª—å -->
    <div id="sidebar" class="sidebar-transition w-80 bg-white dark:bg-gray-800 border-r border-gray-200 dark:border-gray-700 flex flex-col h-full">
      <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
      <div class="p-4 border-b border-gray-200 dark:border-gray-700">
        <div class="flex items-center space-x-3">
          <div class="w-10 h-10 bg-gradient-to-r from-[var(--primary)] to-[var(--secondary)] rounded-lg flex items-center justify-center">
            <i class="fas fa-brain text-white text-lg"></i>
          </div>
          <div>
            <h1 class="text-xl font-bold text-gray-900 dark:text-white">LudvigAI</h1>
            <p class="text-sm text-gray-500 dark:text-gray-400" id="userGreeting">–í–∞—à –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç</p>
          </div>
        </div>
      </div>
      <!-- –ú–æ–¥–µ–ª—å -->
      <div class="px-4 py-3 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">
        <div>
          <span class="text-sm font-medium text-gray-700 dark:text-gray-300" id="currentModelBadge">LudvigAI 1.0</span>
          <p class="text-xs text-gray-500 dark:text-gray-400" id="modelCapabilities">–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏</p>
        </div>
        <button onclick="openModelSelector()" class="text-[var(--primary)] dark:text-[var(--secondary)] text-xs font-semibold">–°–º–µ–Ω–∏—Ç—å</button>
      </div>
      <!-- –°—Ç–∞—Ç—É—Å —Ñ—É–Ω–∫—Ü–∏–π -->
      <div class="px-4 py-2 border-b border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-700/50 flex justify-between text-xs">
        <div id="thinkStatus">ü§î LudvigThink: –≤—ã–∫–ª</div>
        <div id="searchStatus">üîç LudvigSearch: –≤—ã–∫–ª</div>
      </div>
      <!-- –ù–æ–≤–∞—è —Å–µ—Å—Å–∏—è -->
      <div class="p-4">
        <button id="newChatBtn" class="w-full bg-gradient-to-r from-[var(--primary)] to-[var(--secondary)] hover:from-[var(--secondary)] hover:to-[var(--primary)] text-white py-3 px-4 rounded-lg font-semibold transition-all duration-300 transform hover:scale-105 shadow-lg">
          <i class="fas fa-plus mr-2"></i> –ù–æ–≤—ã–π —á–∞—Ç
        </button>
      </div>
      <!-- –ò—Å—Ç–æ—Ä–∏—è —á–∞—Ç–æ–≤ -->
      <div id="chatHistory" class="flex-1 overflow-y-auto p-4 space-y-2"></div>
      <!-- –ü—Ä–æ—Ñ–∏–ª—å -->
      <div class="p-4 border-t border-gray-200 dark:border-gray-700 flex items-center justify-between">
        <div class="flex items-center space-x-3">
          <div id="userAvatar" class="w-8 h-8 bg-gradient-to-r from-green-500 to-blue-500 rounded-full flex items-center justify-center">
            <span class="text-white text-sm font-bold">–ì</span>
          </div>
          <div class="flex-1">
            <div class="text-sm font-medium text-gray-900 dark:text-white" id="userName">–ì–æ—Å—Ç—å</div>
            <div class="text-xs text-gray-500 dark:text-gray-400" id="userType">–ì–æ—Å—Ç–µ–≤–æ–π —Ä–µ–∂–∏–º</div>
          </div>
          <button onclick="openSettings()" class="text-gray-500 dark:text-gray-400 hover:text-gray-700"><i class="fas fa-cog"></i></button>
        </div>
      </div>
    </div>
    <!-- –ë—É—Ç–æ–Ω –º–æ–±–∏–ª—å–Ω–æ–π –ø–∞–Ω–µ–ª–∏ -->
    <button id="sidebarToggle" class="lg:hidden fixed top-4 left-4 z-50 bg-white dark:bg-gray-800 p-3 rounded-full shadow-lg border border-gray-200 dark:border-gray-700">
      <i class="fas fa-bars text-gray-600 dark:text-gray-400"></i>
    </button>
    <!-- –û—Å–Ω–æ–≤–Ω–æ–π —á–∞—Ç -->
    <div class="flex-1 flex flex-col h-full">
      <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
      <div class="border-b border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 p-4">
        <div class="flex items-center space-x-3">
          <div class="w-8 h-8 bg-gradient-to-r from-[var(--primary)] to-[var(--secondary)] rounded-lg flex items-center justify-center">
            <i class="fas fa-brain text-white text-sm"></i>
          </div>
          <div>
            <h2 class="text-lg font-semibold text-gray-900 dark:text-white">LudvigAI <span class="model-badge bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200 text-xs ml-2" id="headerModelBadge">1.0</span></h2>
            <p class="text-sm text-gray-500 dark:text-gray-400" id="modelDescription">–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –≤–µ—Ä—Å–∏—è ‚Ä¢ –ì–æ—Ç–æ–≤ –ø–æ–º–æ—á—å</p>
          </div>
        </div>
      </div>
      <!-- –°–æ–æ–±—â–µ–Ω–∏—è -->
      <div id="messagesContainer" class="flex-1 overflow-y-auto p-6 space-y-6">
        <!-- –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ -->
        <div class="message-enter flex justify-start">
          <div class="flex space-x-3 max-w-4xl">
            <div class="w-8 h-8 bg-gradient-to-r from-[var(--primary)] to-[var(--secondary)] rounded-full flex items-center justify-center">
              <i class="fas fa-brain text-white text-sm"></i>
            </div>
            <div class="bg-white dark:bg-gray-700 rounded-2xl px-6 py-4 shadow-lg border border-gray-200 dark:border-gray-600">
              <p class="text-gray-900 dark:text-white text-lg leading-relaxed">
                –ü—Ä–∏–≤–µ—Ç! –Ø LudvigAI ‚Äî –≤–∞—à –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç. ü§ñ<br><br>
                –ú–æ–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏: <br>
                ‚Ä¢ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–¥–∞<br>
                ‚Ä¢ –ì–ª—É–±–æ–∫–∏–π –∞–Ω–∞–ª–∏–∑ –≤–æ–ø—Ä–æ—Å–æ–≤<br>
                ‚Ä¢ –ü–æ–∏—Å–∫ –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ<br>
                ‚Ä¢ –†–µ—à–µ–Ω–∏–µ –∑–∞–¥–∞—á<br>
                ‚Ä¢ –û–±—ä—è—Å–Ω–µ–Ω–∏–µ –Ω–∞—É—á–Ω—ã—Ö –∫–æ–Ω—Ü–µ–ø—Ü–∏–π<br><br>
                –í–∫–ª—é—á–∏—Ç–µ LudvigThink –¥–ª—è –≥–ª—É–±–æ–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –∏–ª–∏ LudvigSearch –¥–ª—è –ø–æ–∏—Å–∫–∞.
              </p>
              <div class="flex flex-wrap gap-2 mt-4">
                <button class="suggestion-btn bg-purple-100 dark:bg-purple-900/30 hover:bg-purple-200 dark:hover:bg-purple-900/50 text-purple-700 dark:text-purple-300 px-4 py-2 rounded-lg text-sm transition" onclick="setSuggestion('–ù–∞–ø–∏—à–∏ –∫–æ–¥ –Ω–∞ Python')">–ù–∞–ø–∏—à–∏ –∫–æ–¥ –Ω–∞ Python</button>
                <button class="suggestion-btn bg-blue-100 dark:bg-blue-900/30 hover:bg-blue-200 dark:hover:bg-blue-900/50 text-blue-700 dark:text-blue-300 px-4 py-2 rounded-lg text-sm transition" onclick="setSuggestion('–û–±—ä—è—Å–Ω–∏ –∫–≤–∞–Ω—Ç–æ–≤—É—é —Ñ–∏–∑–∏–∫—É')">–û–±—ä—è—Å–Ω–∏ –∫–≤–∞–Ω—Ç–æ–≤—É—é —Ñ–∏–∑–∏–∫—É</button>
                <button class="suggestion-btn bg-green-100 dark:bg-green-900/30 hover:bg-green-200 dark:hover:bg-green-900/50 text-green-700 dark:text-green-300 px-4 py-2 rounded-lg text-sm transition" onclick="setSuggestion('–ü–æ–º–æ–≥–∏ —Å –∞–ª–≥–æ—Ä–∏—Ç–º–æ–º')">–ü–æ–º–æ–≥–∏ —Å –∞–ª–≥–æ—Ä–∏—Ç–º–æ–º</button>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –º—ã—à–ª–µ–Ω–∏—è -->
      <div id="thinkingIndicator" class="hidden px-6 py-4">
        <div class="flex space-x-3 max-w-4xl">
          <div class="w-8 h-8 thinking-animation rounded-full flex items-center justify-center">
            <i class="fas fa-brain text-white text-sm"></i>
          </div>
          <div class="bg-white dark:bg-gray-700 rounded-2xl px-6 py-4 shadow-lg border border-gray-200 dark:border-gray-600">
            <div class="flex items-center space-x-2">
              <div class="typing-dots">
                <span class="text-2xl">‚óè</span>
                <span class="text-2xl">‚óè</span>
                <span class="text-2xl">‚óè</span>
              </div>
              <span class="text-gray-600 dark:text-gray-400 text-sm">LudvigThink –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç...</span>
            </div>
          </div>
        </div>
      </div>
      <!-- –í–≤–æ–¥ -->
      <div class="border-t border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 p-6">
        <div class="max-w-4xl mx-auto">
          <div class="flex space-x-4">
            <div class="flex-1 relative">
              <textarea id="messageInput" placeholder="–ù–∞–ø–∏—à–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..." rows="1" class="w-full border border-gray-300 dark:border-gray-600 rounded-2xl py-4 px-6 pr-12 bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 resize-none focus:outline-none focus:ring-2 focus:ring-[var(--primary)] transition-all duration-300 max-h-32" oninput="autoResize(this)"></textarea>
              <button id="sendButton" class="absolute right-3 top-1/2 transform -translate-y-1/2 bg-gradient-to-r from-[var(--primary)] to-[var(--secondary)] hover:from-[var(--secondary)] hover:to-[var(--primary)] text-white p-2 rounded-lg transition" disabled><i class="fas fa-paper-plane text-sm"></i></button>
            </div>
          </div>
          <div class="flex justify-between items-center mt-3 text-sm text-gray-500 dark:text-gray-400">
            <div class="flex space-x-4">
              <button onclick="openModelSelector()" class="hover:text-[var(--primary)] dark:hover:text-[var(--secondary)] transition">–ú–æ–¥–µ–ª—å</button>
              <button onclick="toggleLudvigThink()" id="thinkBtn" class="hover:text-[var(--primary)] dark:hover:text-[var(--secondary)] transition">LudvigThink</button>
              <button onclick="toggleLudvigSearch()" id="searchBtn" class="hover:text-[var(--primary)] dark:hover:text-[var(--secondary)] transition">LudvigSearch</button>
            </div>
            <div>
              <span id="footerModelInfo">LudvigAI 1.0</span>
            </div>
          </div>
        </div>
      </
    
  



 —ä—è–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
let user = null;
let currentChatId = 'default';
let currentModel = 'standard';
let chats = {
  'default': {
    id: 'default',
    title: '–ù–æ–≤—ã–π —á–∞—Ç',
    messages: [],
    createdAt: new Date().toISOString(),
    model: 'standard'
  }
};
let models = {
  'mini': {
    name: 'LudvigAI 1.0 Mini',
    shortName: 'Mini',
    description: '–ë—ã—Å—Ç—Ä–∞—è –∏ –ª–µ–≥–∫–∞—è',
    capabilities: '–ë—ã—Å—Ç—Ä—ã–µ –æ—Ç–≤–µ—Ç—ã, –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã',
    badgeColor: 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200',
    speed: 500,
    creativity: 30
  },
  'standard': {
    name: 'LudvigAI 1.0',
    shortName: '1.0',
    description: '–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –≤–µ—Ä—Å–∏—è',
    capabilities: '–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–æ–¥–∞, —É–ª—É—á—à–µ–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã',
    badgeColor: 'bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200',
    speed: 1000,
    creativity: 50
  },
  'plus': {
    name: 'LudvigAI 1.0 Plus',
    shortName: 'Plus',
    description: '–†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏',
    capabilities: '–ö—Ä–µ–∞—Ç–∏–≤–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã, –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö',
    badgeColor: 'bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200',
    speed: 1500,
    creativity: 70
  },
  'pro': {
    name: 'LudvigAI 1.0 Pro',
    shortName: 'Pro',
    description: '–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è',
    capabilities: '–°–ª–æ–∂–Ω—ã–π –∞–Ω–∞–ª–∏–∑, —ç–∫—Å–ø–µ—Ä—Ç–Ω—ã–µ –∑–Ω–∞–Ω–∏—è',
    badgeColor: 'bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200',
    speed: 2000,
    creativity: 85
  },
  'ultimate': {
    name: 'LudvigAI 1.0 Ultimate',
    shortName: 'Ultimate',
    description: '–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –º–æ—â–Ω–æ—Å—Ç—å',
    capabilities: '–í—Å–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏, –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –∫—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç—å',
    badgeColor: 'bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200',
    speed: 2500,
    creativity: 95
  }
};
// –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
function save() {
  if (user && user.type === 'registered') {
    localStorage.setItem('ludvig_user', JSON.stringify(user));
    localStorage.setItem('ludvig_chats', JSON.stringify(chats));
    localStorage.setItem('ludvig_model', currentModel);
  }
}
function load() {
  let u = localStorage.getItem('ludvig_user');
  if(u) user=JSON.parse(u);
  let c = localStorage.getItem('ludvig_chats');
  if(c) chats=JSON.parse(c);
  let m = localStorage.getItem('ludvig_model');
  if(m) currentModel=m;
}
function updateUI() {
  // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è
  document.getElementById('userName').textContent = user ? user.name : '–ì–æ—Å—Ç—å';
  document.getElementById('userType').textContent = (user && user.type==='guest')?'–ì–æ—Å—Ç–µ–≤–æ–π —Ä–µ–∂–∏–º':'–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω';
  document.getElementById('userGreeting').textContent = user ? `–ü—Ä–∏–≤–µ—Ç, ${user.name}!` : '–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ!';
  // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
  updateModelInfo();
  // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏
  renderChatList();
  loadChat(currentChatId);
}
function login() {
  const email = document.getElementById('loginEmail').value.trim();
  const pass = document.getElementById('loginPassword').value.trim();
  if(!email || !pass){ alert('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è'); return;}
  user = {id:'1', name: email.split('@')[0], email, type:'registered'};
  load(); updateUI(); document.getElementById('authModal').classList.add('hidden'); document.getElementById('mainApp').classList.remove('hidden');
}
function register() {
  const name = document.getElementById('registerName').value.trim();
  const email = document.getElementById('registerEmail').value.trim();
  const pass = document.getElementById('registerPassword').value.trim();
  if(!name || !email || !pass){ alert('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è'); return;}
  user = {id:'1', name, email, type:'registered'};
  load(); updateUI(); document.getElementById('authModal').classList.add('hidden'); document.getElementById('mainApp').classList.remove('hidden');
}
function enterAsGuest() {
  user={id:'guest', name:'–ì–æ—Å—Ç—å', email:null, type:'guest'};
  load(); updateUI(); document.getElementById('authModal').classList.add('hidden'); document.getElementById('mainApp').classList.remove('hidden');
}
function logout() {
  user=null; chats={'default':{id:'default',title:'–ù–æ–≤—ã–π —á–∞—Ç',messages:[],createdAt:new Date().toISOString(),model:currentModel}};
  currentChatId='default'; save(); document.getElementById('authModal').classList.remove('hidden'); document.getElementById('mainApp').classList.add('hidden');
}
function createChat() {
  const id='chat_'+Date.now();
  chats[id]={id, title:'–ù–æ–≤—ã–π —á–∞—Ç', messages:[], createdAt:new Date().toISOString(), model: currentModel};
  currentChatId=id;
  renderChatList();
  loadChat(id);
  save();
}
function deleteChat(id,e) {
  e.stopPropagation();
  if(Object.keys(chats).length===1){ alert('–ù–µ–ª—å–∑—è —É–¥–∞–ª–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π —á–∞—Ç'); return;}
  if(confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç —á–∞—Ç?')){
    delete chats[id];
    if(currentChatId===id){
      currentChatId=Object.keys(chats)[0];
      loadChat(currentChatId);
    }
    renderChatList(); save();
  }
}
function switchChat(id){
  currentChatId=id; loadChat(id);
}
function renderChatList() {
  const container=document.getElementById('chatHistory');
  container.innerHTML='';
  Object.values(chats).sort((a,b)=>new Date(b.createdAt)-new Date(a.createdAt)).forEach(c=>{
    const div=document.createElement('div');
    div.className='group border rounded-lg p-3 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600 mb-2 flex justify-between items-center';
    div.onclick=()=>switchChat(c.id);
    const lastMsg = c.messages[c.messages.length-1];
    const title = lastMsg?lastMsg.text.substring(0,30)+(lastMsg.text.length>30?'...':''):'–ù–æ–≤—ã–π —á–∞—Ç';
    div.innerHTML=`
      <div class="flex items-center space-x-2">
        <i class="fas fa-message ${c.id===currentChatId?'text-purple-600':'text-gray-600'}"></i>
        <span class="text-sm font-medium text-gray-900 dark:text-white">${title}</span>
      </div>
      <button class="opacity-0 group-hover:opacity-100 text-red-500 text-xs" onclick="deleteChat('${c.id}',event)"><i class="fas fa-trash"></i></button>
    `;
    container.appendChild(div);
  });
}
function loadChat(id) {
  const chat=chats[id];
  const container=document.getElementById('messagesContainer');
  container.innerHTML='';
  if(chat.messages.length===0){
    container.innerHTML=`
      <div class="message-enter flex justify-start">
        <div class="flex space-x-3 max-w-4xl">
          <div class="w-8 h-8 bg-gradient-to-r from-[var(--primary)] to-[var(--secondary)] rounded-full flex items-center justify-center">
            <i class="fas fa-brain text-white text-sm"></i>
          </div>
          <div class="bg-white dark:bg-gray-700 rounded-2xl px-6 py-4 shadow-lg border border-gray-200 dark:border-gray-600">
            <p class="text-gray-900 dark:text-white">–Ø - LudvigAI. –ß–µ–º –º–æ–≥—É –ø–æ–º–æ—á—å?</p>
          </div>
        </div>
      </div>
    `;
  } else {
    chat.messages.forEach(m=>{
      addMessageUI(m.text,m.isUser);
    });
  }
}
function addMessageUI(text, isUser) {
  const container=document.getElementById('messagesContainer');
  const div=document.createElement('div');
  div.className='message-enter flex '+(isUser?'justify-end':'justify-start');
  div.innerHTML=`
    <div class="flex items-center space-x-2 max-w-4xl ${isUser?'flex-row-reverse':'flex-row'}">
      <div class="w-8 h-8 ${isUser?'bg-gradient-to-r from-green-500 to-blue-500':'bg-gradient-to-r from-[var(--primary)] to-[var(--secondary)]'} rounded-full flex items-center justify-center">
        <i class="fas ${isUser?'fa-user':'fa-brain'} text-white text-sm"></i>
      </div>
      <div class="${isUser?'bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-2xl rounded-tr-none':'bg-white dark:bg-gray-700 text-gray-900 dark:text-white rounded-2xl rounded-tl-none border border-gray-200 dark:border-gray-600'} px-6 py-4 shadow-lg">
        <p class="text-lg leading-relaxed">${text}</p>
      </div>
    </div>
  `;
  container.appendChild(div);
  container.scrollTop=container.scrollHeight;
}
function sendMessage() {
  const input=document.getElementById('messageInput');
  const msg=input.value.trim();
  if(!msg) return;
  addMessageUI(msg,true);
  chats[currentChatId].messages.push({text:msg,isUser:true,timestamp:new Date().toISOString()});
  if(chats[currentChatId].messages.length===1){
    chats[currentChatId].title=msg.substring(0,30)+(msg.length>30?'...':'');
    renderChatList();
  }
  input.value='';
  autoResize(input);
  document.getElementById('sendButton').disabled=true;
  // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–≤–µ—Ç–∞ AI
  handleAIResponse(msg);
}
async function handleAIResponse(msg) {
  // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –º—ã—à–ª–µ–Ω–∏—è
  document.getElementById('thinkingIndicator').classList.remove('hidden');
  // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –æ—Ç–≤–µ—Ç
  const response = generateResponse(msg);
  // –ó–∞–¥–µ—Ä–∂–∫–∞ –¥–ª—è –∏–º–∏—Ç–∞—Ü–∏–∏ –º—ã—à–ª–µ–Ω–∏—è
  await new Promise(r=>setTimeout(r,models[currentModel].speed));
  // –£–±–∏—Ä–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä
  document.getElementById('thinkingIndicator').classList.add('hidden');
  // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –æ—Ç–≤–µ—Ç
  addMessageUI(response.text,false);
  chats[currentChatId].messages.push({text:response.text,isUser:false,timestamp:new Date().toISOString()});
  save();
}
function autoResize(textarea){
  textarea.style.height='auto';
  textarea.style.height=Math.min(textarea.scrollHeight,128)+'px';
  document.getElementById('sendButton').disabled=textarea.value.trim()==='';
}
function setSuggestion(text){
  document.getElementById('messageInput').value=text;
  autoResize(document.getElementById('messageInput'));
  document.getElementById('sendButton').disabled=false;
}
function toggleAuthForm(){
  document.getElementById('loginForm').classList.toggle('hidden');
  document.getElementById('registerForm').classList.toggle('hidden');
}
function openModelSelector() {
  document.getElementById('modelModal').classList.remove('hidden');
  updateModelInfo();
}
function closeModelSelector() {
  document.getElementById('modelModal').classList.add('hidden');
}
function selectModel(modelKey){
  currentModel=modelKey;
  document.getElementById('currentModelDisplay').textContent=models[modelKey].name;
  document.getElementById('modelCapabilities').textContent=models[modelKey].capabilities;
  document.getElementById('currentModelBadge').textContent=models[modelKey].name;
  document.getElementById('headerModelBadge').textContent=models[modelKey].shortName;
  document.getElementById('headerModelBadge').className='model-badge '+models[modelKey].badgeColor;
  document.getElementById('modelDescription').textContent=models[modelKey].description+' ‚Ä¢ –ì–æ—Ç–æ–≤ –ø–æ–º–æ—á—å';
  document.getElementById('footerModelInfo').textContent=models[modelKey].name;
  save();
  closeModelSelector();
  // –í—Å—Ç–∞–≤–ª—è–µ–º —Å–∏—Å—Ç–µ–º–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ —Å–º–µ–Ω–µ –º–æ–¥–µ–ª–∏
  addMessageUI('üîÑ –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–æ –Ω–∞ '+models[modelKey].name,false);
  chats[currentChatId].messages.push({text:'üîÑ –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–æ –Ω–∞ '+models[modelKey].name,isUser:false,timestamp:new Date().toISOString(),isSystem:true});
}
function updateModelInfo() {
  document.getElementById('currentModelDisplay').textContent=models[currentModel].name;
  document.getElementById('modelCapabilities').textContent=models[currentModel].capabilities;
  document.getElementById('currentModelBadge').textContent=models[currentModel].name;
  document.getElementById('headerModelBadge').textContent=models[currentModel].shortName;
  document.getElementById('headerModelBadge').className='model-badge '+models[currentModel].badgeColor;
  document.getElementById('modelDescription').textContent=models[currentModel].description+' ‚Ä¢ –ì–æ—Ç–æ–≤ –ø–æ–º–æ—á—å';
  document.getElementById('footerModelInfo').textContent=models[currentModel].name;
}
function openSettings() {
  document.getElementById('settingsModal').classList.remove('hidden');
}
function closeSettings() {
  document.getElementById('settingsModal').classList.add('hidden');
}
function selectTheme(theme){
  document.body.className='font-sans bg-gray-50 dark:bg-gray-900 transition-all duration-300 theme-'+theme;
  localStorage.setItem('ludvig_theme',theme);
  updateThemeUI();
}
function updateThemeUI() {
  document.querySelectorAll('.theme-option').forEach(e=>e.classList.remove('border-[var(--primary)]'));
  document.querySelector('.theme-option.theme-'+getSavedTheme()).classList.add('border-[var(--primary)]');
}
function getSavedTheme() {
  return localStorage.getItem('ludvig_theme') || 'purple';
}
function toggleLudvigThink() {
  ludvigThinkEnabled=!ludvigThinkEnabled;
  document.getElementById('ludvigThinkToggle').checked=ludvigThinkEnabled;
  document.getElementById('thinkStatus').textContent='ü§î LudvigThink: '+(ludvigThinkEnabled?'–≤–∫–ª':'–≤—ã–∫–ª');
}
function toggleLudvigSearch() {
  ludvigSearchEnabled=!ludvigSearchEnabled;
  document.getElementById('ludvigSearchToggle').checked=ludvigSearchEnabled;
  document.getElementById('searchStatus').textContent='üîç LudvigSearch: '+(ludvigSearchEnabled?'–≤–∫–ª':'–≤—ã–∫–ª');
}
// –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–æ–≤
function generateResponse(input){
  input=input.toLowerCase();
  // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –∫–æ–º–∞–Ω–¥—ã –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–¥–∞
  if(input.includes('–Ω–∞–ø–∏—à–∏ –∫–æ–¥') || input.includes('—Å–¥–µ–ª–∞–π –∫–æ–¥')){
    if(input.includes('python') || input.includes('–ø–∏—Ç–æ–Ω')){
      return {text:'ü§ñ –í–æ—Ç –ø—Ä–∏–º–µ—Ä –∫–æ–¥–∞ –Ω–∞ Python:\n\n```python\nprint("Hello World")\n```', requiresThinking:true};
    } else if(input.includes('js') || input.includes('javascript')){
      return {text:'ü§ñ –í–æ—Ç –ø—Ä–∏–º–µ—Ä –∫–æ–¥–∞ –Ω–∞ JavaScript:\n\n```javascript\nconsole.log("Hello World");\n```', requiresThinking:true};
    }
  }
  // –ù–∞—É—á–Ω—ã–µ —Ç–µ–º—ã
  if(input.includes('–∫–≤–∞–Ω—Ç') || input.includes('—Ñ–∏–∑–∏–∫–∞')){
    return {text:'üî¨ –ö–≤–∞–Ω—Ç–æ–≤–∞—è –º–µ—Ö–∞–Ω–∏–∫–∞ ‚Äî —Ä–∞–∑–¥–µ–ª —Ñ–∏–∑–∏–∫–∏, –∏–∑—É—á–∞—é—â–∏–π –ø–æ–≤–µ–¥–µ–Ω–∏–µ –º–∞—Ç–µ—Ä–∏–∏ –∏ —ç–Ω–µ—Ä–≥–∏–∏ –Ω–∞ –º–∏–∫—Ä–æ—É—Ä–æ–≤–Ω–µ...', requiresThinking:true};
  }
  if(input.includes('–º–∞—Ç–µ–º–∞—Ç–∏–∫–∞')){
    return {text:'üìê –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ ‚Äî –Ω–∞—É–∫–∞ –æ —á–∏—Å–ª–∞—Ö, —Å—Ç—Ä—É–∫—Ç—É—Ä–∞—Ö, –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ –∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö...', requiresThinking:true};
  }
  // –ü–æ–∏—Å–∫
  if(ludvigSearchEnabled && (input.includes('—á—Ç–æ —Ç–∞–∫–æ–µ') || input.includes('–∫—Ç–æ —Ç–∞–∫–æ–π') || input.includes('–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ'))){
    return {text:generateWebSearchResponse(input), requiresThinking:false};
  }
  // –ì–ª—É–±–æ–∫–∏–π –∞–Ω–∞–ª–∏–∑ LudvigThink
  if(ludvigThinkEnabled && (input.length>50 || input.includes('–æ–±—ä—è—Å–Ω–∏') || input.includes('–ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π'))){
    return {text:generateDeepAnalysis(input), requiresThinking:true};
  }
  // –ü—Ä–æ—Å—Ç–æ –æ—Ç–≤–µ—Ç
  return {text:generateSmartResponse(input), requiresThinking:false};
}
function generateDeepAnalysis(input){
  const analyses=[
    'üîç –ì–ª—É–±–æ–∫–∏–π –∞–Ω–∞–ª–∏–∑ –≤–æ–ø—Ä–æ—Å–∞... –ü–µ—Ä–≤—ã–π —É—Ä–æ–≤–µ–Ω—å ‚Äî –ª–∏–Ω–≥–≤–∏—Å—Ç–∏—á–µ—Å–∫–∏–π...',
    'üéØ –ú–µ–∂–¥–∏—Å—Ü–∏–ø–ª–∏–Ω–∞—Ä–Ω—ã–π –∞–Ω–∞–ª–∏–∑... –í—Ç–æ—Ä–æ–π —É—Ä–æ–≤–µ–Ω—å ‚Äî –ª–æ–≥–∏–∫–∞ –∏ –ø—Ä–∏—á–∏–Ω–Ω–æ-—Å–ª–µ–¥—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å–≤—è–∑–∏...',
    'üí° –ö–æ–≥–Ω–∏—Ç–∏–≤–Ω—ã–π —Ä–∞–∑–±–æ—Ä... –¢—Ä–µ—Ç–∏–π —É—Ä–æ–≤–µ–Ω—å ‚Äî —Å–∏–Ω—Ç–µ–∑ –Ω–æ–≤—ã—Ö –∏–¥–µ–π...'
  ];
  return analyses[Math.floor(Math.random()*analyses.length)];
}
function generateWebSearchResponse(input){
  const responses=[
    'üåê –ù–∞—à–µ–ª –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –≤ –∏—Å—Ç–æ—á–Ω–∏–∫–∞—Ö...',
    'üîé –í –ø—Ä–æ—Ü–µ—Å—Å–µ –ø–æ–∏—Å–∫–∞... –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã...'
  ];
  return responses[Math.floor(Math.random()*responses.length)];
}
function generateSmartResponse(input){
  const responses=[
    '–ü–æ–Ω—è–ª, —Å–µ–π—á–∞—Å –ø–æ–¥–≥–æ—Ç–æ–≤–ª—é –æ—Ç–≤–µ—Ç...',
    '–ò–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π –≤–æ–ø—Ä–æ—Å! –û–±—Ä–∞–±–∞—Ç—ã–≤–∞—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é...',
    '–î–∞–π—Ç–µ –º–∏–Ω—É—Ç—É, —è —Å—Ñ–æ—Ä–º–∏—Ä—É—é –æ—Ç–≤–µ—Ç...'
  ];
  return responses[Math.floor(Math.random()*responses.length)];
}
// –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–º—ã
function toggleTheme(theme){
  selectTheme(theme);
}
// –û–±—Ä–∞–±–æ—Ç–∫–∞ LudvigThink
let ludvigThinkEnabled=false;
function toggleLudvigThink(){
  ludvigThinkEnabled=!ludvigThinkEnabled;
  document.getElementById('thinkBtn').classList.toggle('text-[var(--primary)]',ludvigThinkEnabled);
  document.getElementById('thinkStatus').textContent='ü§î LudvigThink: '+(ludvigThinkEnabled?'–≤–∫–ª':'–≤—ã–∫–ª');
}
let ludvigSearchEnabled=false;
function toggleLudvigSearch(){
  ludvigSearchEnabled=!ludvigSearchEnabled;
  document.getElementById('searchBtn').classList.toggle('text-[var(--primary)]',ludvigSearchEnabled);
  document.getElementById('searchStatus').textContent='üîç LudvigSearch: '+(ludvigSearchEnabled?'–≤–∫–ª':'–≤—ã–∫–ª');
}
// –û—á–∏—Å—Ç–∫–∞ —á–∞—Ç–∞
function clearChat() {
  if(confirm('–û—á–∏—Å—Ç–∏—Ç—å —Ç–µ–∫—É—â–∏–π —á–∞—Ç?')){
    chats[currentChatId].messages=[];
    loadChat(currentChatId);
  }
}
// –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ç–µ–º—ã
document.getElementById('themeToggle').onclick=()=>{
  if(document.documentElement.classList.contains('dark')){
    document.documentElement.classList.remove('dark');
    localStorage.setItem('ludvig_theme','light');
  } else {
    document.documentElement.classList.add('dark');
    localStorage.setItem('ludvig_theme','dark');
  }
}
// –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–Ω–æ–ø–∫–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏
document.getElementById('sendButton').onclick=()=>sendMessage();
document.getElementById('messageInput').onkeypress=(e)=>{
  if(e.key==='Enter' && !e.shiftKey){ e.preventDefault(); sendMessage();}
}
document.querySelectorAll('.suggestion-btn').forEach(btn=>btn.onclick=()=>setSuggestion(btn.textContent));
document.getElementById('newChatBtn').onclick=createChat;
document.getElementById('sidebarToggle').onclick=()=>{document.getElementById('sidebar').classList.toggle('hidden');};
window.onload=()=> {
  load();
  if(user){ updateUI(); } else { document.getElementById('authModal').classList.remove('hidden'); }
  document.getElementById('messageInput').focus();
  updateTheme();
}
// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–µ–º—ã
function updateTheme() {
  const theme=localStorage.getItem('ludvig_theme')||'purple';
  selectTheme(theme);
}
function selectTheme(theme){
  document.body.className='font-sans bg-gray-50 dark:bg-gray-900 transition-all duration-300 theme-'+theme;
  localStorage.setItem('ludvig_theme',theme);
  document.querySelectorAll('.theme-option').forEach(e=>e.classList.remove('border-[var(--primary)]'));
  document.querySelector('.theme-option.theme-'+theme).classList.add('border-[var(--primary)]');
}
// –û—Å–Ω–æ–≤–Ω–æ–π —Ü–∏–∫–ª
async function sendMessage() {
  const input=document.getElementById('messageInput');
  const msg=input.value.trim();
  if(!msg) return;
  addMessageUI(msg,true);
  chats[currentChatId].messages.push({text:msg,isUser:true,timestamp:new Date().toISOString()});
  if(chats[currentChatId].messages.length===1){
    chats[currentChatId].title=msg.substring(0,30)+(msg.length>30?'...':'');
    renderChatList();
  }
  input.value='';
  autoResize(input);
  document.getElementById('sendButton').disabled=true;
  // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–∞
  const response=generateResponse(msg);
  // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –º—ã—à–ª–µ–Ω–∏—è
  document.getElementById('thinkingIndicator').classList.remove('hidden');
  await new Promise(r=>setTimeout(r,models[currentModel].speed));
  document.getElementById('thinkingIndicator').classList.add('hidden');
  addMessageUI(response.text,false);
  chats[currentChatId].messages.push({text:response.text,isUser:false,timestamp:new Date().toISOString()});
  save();
}
</script>
</body>
</html>
