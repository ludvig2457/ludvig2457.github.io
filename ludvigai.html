<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LudvigAI - –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .gradient-bg {
            background: linear-gradient(-45deg, #667eea, #764ba2, #8a2be2, #6b46c1);
            background-size: 400% 400%;
            animation: gradient 15s ease infinite;
        }
        .gradient-text {
            background: linear-gradient(135deg, #667eea, #8a2be2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-size: 200% 200%;
            animation: gradient 8s ease infinite;
        }
        @keyframes gradient {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }
        .sidebar-transition {
            transition: all 0.3s ease;
        }
        .message-enter {
            animation: messageEnter 0.3s ease;
        }
        @keyframes messageEnter {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        .typing-dots {
            display: inline-block;
        }
        .typing-dots span {
            animation: typing 1.4s infinite;
        }
        .typing-dots span:nth-child(2) {
            animation-delay: 0.2s;
        }
        .typing-dots span:nth-child(3) {
            animation-delay: 0.4s;
        }
        @keyframes typing {
            0%, 60%, 100% { transform: translateY(0); }
            30% { transform: translateY(-10px); }
        }
        .fade-in {
            animation: fadeIn 0.5s ease;
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        .model-badge {
            font-size: 0.7rem;
            padding: 2px 6px;
            border-radius: 8px;
            font-weight: 600;
        }
        .code-block {
            background: #1a1a1a;
            border: 1px solid #333;
            border-radius: 8px;
            padding: 12px;
            margin: 8px 0;
            overflow-x: auto;
            color: #f8f8f2;
            font-family: 'Courier New', monospace;
        }
        .thinking-animation {
            background: linear-gradient(90deg, #667eea, #764ba2, #8a2be2);
            background-size: 200% 200%;
            animation: gradient 2s ease infinite;
        }
        .theme-purple { --primary: #8b5cf6; --secondary: #7c3aed; }
        .theme-blue { --primary: #3b82f6; --secondary: #2563eb; }
        .theme-green { --primary: #10b981; --secondary: #059669; }
        .theme-orange { --primary: #f59e0b; --secondary: #d97706; }
        .theme-pink { --primary: #ec4899; --secondary: #db2777; }
    </style>
</head>
<body class="font-sans bg-gray-50 dark:bg-gray-900 transition-all duration-300 theme-purple">
    <!-- Auth Modal -->
    <div id="authModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 fade-in">
        <div class="bg-white dark:bg-gray-800 rounded-2xl p-8 w-96 max-w-md mx-4 shadow-2xl">
            <div class="text-center mb-6">
                <div class="w-16 h-16 bg-gradient-to-r from-[var(--primary)] to-[var(--secondary)] rounded-2xl flex items-center justify-center mx-auto mb-4">
                    <i class="fas fa-brain text-white text-2xl"></i>
                </div>
                <h2 class="text-2xl font-bold text-gray-900 dark:text-white">LudvigAI</h2>
                <p class="text-gray-600 dark:text-gray-400">–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç</p>
            </div>

            <div id="loginForm">
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Email</label>
                        <input type="email" id="loginEmail" 
                               class="w-full border border-gray-300 dark:border-gray-600 rounded-xl px-4 py-3 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-[var(--primary)] transition duration-300">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">–ü–∞—Ä–æ–ª—å</label>
                        <input type="password" id="loginPassword" 
                               class="w-full border border-gray-300 dark:border-gray-600 rounded-xl px-4 py-3 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-[var(--primary)] transition duration-300">
                    </div>
                    <button onclick="login()" 
                            class="w-full bg-gradient-to-r from-[var(--primary)] to-[var(--secondary)] hover:from-[var(--secondary)] hover:to-[var(--primary)] text-white py-3 rounded-xl font-semibold transition-all duration-300 transform hover:scale-105 shadow-lg">
                        –í–æ–π—Ç–∏
                    </button>
                </div>
                <div class="mt-4 text-center">
                    <button onclick="toggleAuthForm()" class="text-[var(--primary)] dark:text-[var(--secondary)] hover:underline text-sm">
                        –ù–µ—Ç –∞–∫–∫–∞—É–Ω—Ç–∞? –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è
                    </button>
                </div>
                <div class="mt-6 pt-4 border-t border-gray-200 dark:border-gray-700">
                    <button onclick="enterAsGuest()" 
                            class="w-full border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 py-3 rounded-xl font-semibold hover:bg-gray-50 dark:hover:bg-gray-700 transition duration-300">
                        –í–æ–π—Ç–∏ –∫–∞–∫ –≥–æ—Å—Ç—å
                    </button>
                </div>
            </div>

            <div id="registerForm" class="hidden">
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">–ò–º—è</label>
                        <input type="text" id="registerName" 
                               class="w-full border border-gray-300 dark:border-gray-600 rounded-xl px-4 py-3 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-[var(--primary)] transition duration-300">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Email</label>
                        <input type="email" id="registerEmail" 
                               class="w-full border border-gray-300 dark:border-gray-600 rounded-xl px-4 py-3 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-[var(--primary)] transition duration-300">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">–ü–∞—Ä–æ–ª—å</label>
                        <input type="password" id="registerPassword" 
                               class="w-full border border-gray-300 dark:border-gray-600 rounded-xl px-4 py-3 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-[var(--primary)] transition duration-300">
                    </div>
                    <button onclick="register()" 
                            class="w-full bg-gradient-to-r from-[var(--primary)] to-[var(--secondary)] hover:from-[var(--secondary)] hover:to-[var(--primary)] text-white py-3 rounded-xl font-semibold transition-all duration-300 transform hover:scale-105 shadow-lg">
                        –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è
                    </button>
                </div>
                <div class="mt-4 text-center">
                    <button onclick="toggleAuthForm()" class="text-[var(--primary)] dark:text-[var(--secondary)] hover:underline text-sm">
                        –£–∂–µ –µ—Å—Ç—å –∞–∫–∫–∞—É–Ω—Ç? –í–æ–π—Ç–∏
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Model Selector Modal -->
    <div id="modelModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white dark:bg-gray-800 rounded-2xl p-6 w-96 max-w-md mx-4 shadow-2xl">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-xl font-bold text-gray-900 dark:text-white">–í—ã–±–æ—Ä –º–æ–¥–µ–ª–∏ AI</h3>
                <button onclick="closeModelSelector()" class="text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300">
                    <i class="fas fa-times text-lg"></i>
                </button>
            </div>
            
            <div class="space-y-3">
                <div class="model-option border-2 border-gray-200 dark:border-gray-600 rounded-xl p-4 cursor-pointer hover:border-[var(--primary)] transition duration-300" onclick="selectModel('mini')">
                    <div class="flex items-center justify-between">
                        <div>
                            <h4 class="font-semibold text-gray-900 dark:text-white">LudvigAI 1.0 Mini</h4>
                            <p class="text-sm text-gray-600 dark:text-gray-400">–ë—ã—Å—Ç—Ä–∞—è –∏ –ª–µ–≥–∫–∞—è</p>
                        </div>
                        <span class="model-badge bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200">–ë–µ—Å–ø–ª–∞—Ç–Ω–æ</span>
                    </div>
                    <div class="mt-2 text-xs text-gray-500 dark:text-gray-400">
                        <i class="fas fa-bolt mr-1"></i> –ë—ã—Å—Ç—Ä—ã–µ –æ—Ç–≤–µ—Ç—ã ‚Ä¢ –ë–∞–∑–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
                    </div>
                </div>

                <div class="model-option border-2 border-gray-200 dark:border-gray-600 rounded-xl p-4 cursor-pointer hover:border-[var(--primary)] transition duration-300" onclick="selectModel('standard')">
                    <div class="flex items-center justify-between">
                        <div>
                            <h4 class="font-semibold text-gray-900 dark:text-white">LudvigAI 1.0</h4>
                            <p class="text-sm text-gray-600 dark:text-gray-400">–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –≤–µ—Ä—Å–∏—è</p>
                        </div>
                        <span class="model-badge bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200">–ë–µ—Å–ø–ª–∞—Ç–Ω–æ</span>
                    </div>
                    <div class="mt-2 text-xs text-gray-500 dark:text-gray-400">
                        <i class="fas fa-star mr-1"></i> –£–ª—É—á—à–µ–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã ‚Ä¢ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–æ–¥–∞
                    </div>
                </div>

                <div class="model-option border-2 border-gray-200 dark:border-gray-600 rounded-xl p-4 cursor-pointer hover:border-[var(--primary)] transition duration-300" onclick="selectModel('plus')">
                    <div class="flex items-center justify-between">
                        <div>
                            <h4 class="font-semibold text-gray-900 dark:text-white">LudvigAI 1.0 Plus</h4>
                            <p class="text-sm text-gray-600 dark:text-gray-400">–†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏</p>
                        </div>
                        <span class="model-badge bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200">Premium</span>
                    </div>
                    <div class="mt-2 text-xs text-gray-500 dark:text-gray-400">
                        <i class="fas fa-rocket mr-1"></i> –ö—Ä–µ–∞—Ç–∏–≤–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã ‚Ä¢ –ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö
                    </div>
                </div>

                <div class="model-option border-2 border-gray-200 dark:border-gray-600 rounded-xl p-4 cursor-pointer hover:border-[var(--primary)] transition duration-300" onclick="selectModel('pro')">
                    <div class="flex items-center justify-between">
                        <div>
                            <h4 class="font-semibold text-gray-900 dark:text-white">LudvigAI 1.0 Pro</h4>
                            <p class="text-sm text-gray-600 dark:text-gray-400">–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è</p>
                        </div>
                        <span class="model-badge bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200">Pro</span>
                    </div>
                    <div class="mt-2 text-xs text-gray-500 dark:text-gray-400">
                        <i class="fas fa-crown mr-1"></i> –°–ª–æ–∂–Ω—ã–π –∞–Ω–∞–ª–∏–∑ ‚Ä¢ –≠–∫—Å–ø–µ—Ä—Ç–Ω—ã–µ –∑–Ω–∞–Ω–∏—è
                    </div>
                </div>

                <div class="model-option border-2 border-gray-200 dark:border-gray-600 rounded-xl p-4 cursor-pointer hover:border-[var(--primary)] transition duration-300" onclick="selectModel('ultimate')">
                    <div class="flex items-center justify-between">
                        <div>
                            <h4 class="font-semibold text-gray-900 dark:text-white">LudvigAI 1.0 Ultimate</h4>
                            <p class="text-sm text-gray-600 dark:text-gray-400">–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –º–æ—â–Ω–æ—Å—Ç—å</p>
                        </div>
                        <span class="model-badge bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200">Ultimate</span>
                    </div>
                    <div class="mt-2 text-xs text-gray-500 dark:text-gray-400">
                        <i class="fas fa-gem mr-1"></i> –í—Å–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ ‚Ä¢ –ú–∞–∫—Å. –∫—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç—å
                    </div>
                </div>
            </div>

            <div class="mt-6 p-4 bg-gray-50 dark:bg-gray-700 rounded-lg">
                <h4 class="font-semibold text-gray-900 dark:text-white mb-2">–¢–µ–∫—É—â–∞—è –º–æ–¥–µ–ª—å:</h4>
                <p class="text-sm text-gray-600 dark:text-gray-400" id="currentModelInfo">LudvigAI 1.0</p>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div id="settingsModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white dark:bg-gray-800 rounded-2xl p-6 w-96 max-w-md mx-4 shadow-2xl">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-xl font-bold text-gray-900 dark:text-white">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</h3>
                <button onclick="closeSettings()" class="text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300">
                    <i class="fas fa-times text-lg"></i>
                </button>
            </div>
            
            <div class="space-y-6">
                <div>
                    <h4 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">–¢–µ–º–∞ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è</h4>
                    <div class="grid grid-cols-3 gap-3">
                        <div class="theme-option theme-purple border-2 border-gray-300 rounded-lg p-3 cursor-pointer hover:scale-105 transition duration-300" onclick="selectTheme('purple')">
                            <div class="w-full h-8 bg-gradient-to-r from-purple-500 to-purple-600 rounded mb-2"></div>
                            <span class="text-xs text-gray-600 dark:text-gray-400">–§–∏–æ–ª–µ—Ç–æ–≤–∞—è</span>
                        </div>
                        <div class="theme-option theme-blue border-2 border-gray-300 rounded-lg p-3 cursor-pointer hover:scale-105 transition duration-300" onclick="selectTheme('blue')">
                            <div class="w-full h-8 bg-gradient-to-r from-blue-500 to-blue-600 rounded mb-2"></div>
                            <span class="text-xs text-gray-600 dark:text-gray-400">–°–∏–Ω—è—è</span>
                        </div>
                        <div class="theme-option theme-green border-2 border-gray-300 rounded-lg p-3 cursor-pointer hover:scale-105 transition duration-300" onclick="selectTheme('green')">
                            <div class="w-full h-8 bg-gradient-to-r from-green-500 to-green-600 rounded mb-2"></div>
                            <span class="text-xs text-gray-600 dark:text-gray-400">–ó–µ–ª–µ–Ω–∞—è</span>
                        </div>
                        <div class="theme-option theme-orange border-2 border-gray-300 rounded-lg p-3 cursor-pointer hover:scale-105 transition duration-300" onclick="selectTheme('orange')">
                            <div class="w-full h-8 bg-gradient-to-r from-orange-500 to-orange-600 rounded mb-2"></div>
                            <span class="text-xs text-gray-600 dark:text-gray-400">–û—Ä–∞–Ω–∂–µ–≤–∞—è</span>
                        </div>
                        <div class="theme-option theme-pink border-2 border-gray-300 rounded-lg p-3 cursor-pointer hover:scale-105 transition duration-300" onclick="selectTheme('pink')">
                            <div class="w-full h-8 bg-gradient-to-r from-pink-500 to-pink-600 rounded mb-2"></div>
                            <span class="text-xs text-gray-600 dark:text-gray-400">–†–æ–∑–æ–≤–∞—è</span>
                        </div>
                    </div>
                </div>

                <div>
                    <h4 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">AI –ú–æ–¥–µ–ª—å</h4>
                    <div class="space-y-3">
                        <div class="flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg">
                            <div>
                                <span class="font-medium text-gray-900 dark:text-white" id="currentModelDisplay">LudvigAI 1.0</span>
                                <p class="text-sm text-gray-600 dark:text-gray-400" id="modelCapabilities">–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏</p>
                            </div>
                            <button onclick="openModelSelector()" class="text-[var(--primary)] dark:text-[var(--secondary)] hover:text-[var(--secondary)] dark:hover:text-[var(--primary)] text-sm font-semibold">
                                –°–º–µ–Ω–∏—Ç—å
                            </button>
                        </div>
                    </div>
                </div>

                <div>
                    <h4 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">–§—É–Ω–∫—Ü–∏–∏</h4>
                    <div class="space-y-3">
                        <div class="flex items-center justify-between">
                            <div>
                                <span class="text-gray-700 dark:text-gray-300">LudvigThink</span>
                                <p class="text-xs text-gray-500 dark:text-gray-400">–ì–ª—É–±–æ–∫–∏–π –∞–Ω–∞–ª–∏–∑ –≤–æ–ø—Ä–æ—Å–æ–≤</p>
                            </div>
                            <label class="relative inline-flex items-center cursor-pointer">
                                <input type="checkbox" id="ludvigThinkToggle" class="sr-only peer" onchange="toggleLudvigThink()">
                                <div class="w-11 h-6 bg-gray-200 peer-focus:ring-4 peer-focus:ring-[var(--primary)] rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-[var(--primary)]"></div>
                            </label>
                        </div>
                        <div class="flex items-center justify-between">
                            <div>
                                <span class="text-gray-700 dark:text-gray-300">LudvigSearch</span>
                                <p class="text-xs text-gray-500 dark:text-gray-400">–ü–æ–∏—Å–∫ –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ</p>
                            </div>
                            <label class="relative inline-flex items-center cursor-pointer">
                                <input type="checkbox" id="ludvigSearchToggle" class="sr-only peer" onchange="toggleLudvigSearch()">
                                <div class="w-11 h-6 bg-gray-200 peer-focus:ring-4 peer-focus:ring-[var(--primary)] rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-[var(--primary)]"></div>
                            </label>
                        </div>
                    </div>
                </div>

                <div>
                    <h4 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">–í–Ω–µ—à–Ω–∏–π –≤–∏–¥</h4>
                    <div class="space-y-3">
                        <div class="flex items-center justify-between">
                            <span class="text-gray-700 dark:text-gray-300">–¢–µ–º–Ω–∞—è —Ç–µ–º–∞</span>
                            <label class="relative inline-flex items-center cursor-pointer">
                                <input type="checkbox" id="darkModeToggle" class="sr-only peer">
                                <div class="w-11 h-6 bg-gray-200 peer-focus:ring-4 peer-focus:ring-[var(--primary)] rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-[var(--primary)]"></div>
                            </label>
                        </div>
                    </div>
                </div>

                <div>
                    <h4 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">–ê–∫–∫–∞—É–Ω—Ç</h4>
                    <div class="space-y-3">
                        <div id="userInfo" class="p-3 bg-gray-50 dark:bg-gray-700 rounded-lg">
                            <p class="text-sm text-gray-600 dark:text-gray-400" id="userStatus"></p>
                        </div>
                        <button onclick="logout()" 
                                class="w-full bg-red-600 hover:bg-red-700 text-white py-2 rounded-lg font-semibold transition duration-300">
                            –í—ã–π—Ç–∏
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Main App -->
    <div id="mainApp" class="hidden">
        <!-- Theme Toggle -->
        <div class="fixed top-4 right-4 z-50 flex space-x-2">
            <button id="themeToggle" class="bg-white dark:bg-gray-800 p-3 rounded-full shadow-lg border border-gray-200 dark:border-gray-700 hover:shadow-xl transition-all duration-300">
                <i class="fas fa-moon text-gray-600 dark:text-yellow-400 text-lg"></i>
            </button>
            <button onclick="openSettings()" class="bg-white dark:bg-gray-800 p-3 rounded-full shadow-lg border border-gray-200 dark:border-gray-700 hover:shadow-xl transition-all duration-300">
                <i class="fas fa-cog text-gray-600 dark:text-gray-400 text-lg"></i>
            </button>
        </div>

        <div class="flex h-screen">
            <!-- Sidebar -->
            <div id="sidebar" class="sidebar-transition w-80 bg-white dark:bg-gray-800 border-r border-gray-200 dark:border-gray-700 flex flex-col h-full">
                <!-- Sidebar Header -->
                <div class="p-4 border-b border-gray-200 dark:border-gray-700">
                    <div class="flex items-center space-x-3">
                        <div class="w-10 h-10 bg-gradient-to-r from-[var(--primary)] to-[var(--secondary)] rounded-lg flex items-center justify-center">
                            <i class="fas fa-brain text-white text-lg"></i>
                        </div>
                        <div>
                            <h1 class="text-xl font-bold text-gray-900 dark:text-white">LudvigAI</h1>
                            <p class="text-sm text-gray-500 dark:text-gray-400" id="userGreeting">–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç</p>
                        </div>
                    </div>
                </div>

                <!-- Model Info -->
                <div class="px-4 py-3 border-b border-gray-200 dark:border-gray-700">
                    <div class="flex items-center justify-between">
                        <span class="text-sm font-medium text-gray-700 dark:text-gray-300" id="currentModelBadge">LudvigAI 1.0</span>
                        <button onclick="openModelSelector()" class="text-xs text-[var(--primary)] dark:text-[var(--secondary)] hover:text-[var(--secondary)] dark:hover:text-[var(--primary)]">
                            <i class="fas fa-sync-alt mr-1"></i> –°–º–µ–Ω–∏—Ç—å
                        </button>
                    </div>
                </div>

                <!-- Features Status -->
                <div class="px-4 py-2 border-b border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-700/50">
                    <div class="flex items-center justify-between text-xs">
                        <span class="text-gray-600 dark:text-gray-400" id="thinkStatus">ü§î LudvigThink: –≤—ã–∫–ª</span>
                        <span class="text-gray-600 dark:text-gray-400" id="searchStatus">üîç LudvigSearch: –≤—ã–∫–ª</span>
                    </div>
                </div>

                <!-- New Chat Button -->
                <div class="p-4">
                    <button id="newChatBtn" class="w-full bg-gradient-to-r from-[var(--primary)] to-[var(--secondary)] hover:from-[var(--secondary)] hover:to-[var(--primary)] text-white py-3 px-4 rounded-lg font-semibold transition-all duration-300 transform hover:scale-105 shadow-lg">
                        <i class="fas fa-plus mr-2"></i>
                        –ù–æ–≤—ã–π —á–∞—Ç
                    </button>
                </div>

                <!-- Chat History -->
                <div id="chatHistory" class="flex-1 overflow-y-auto p-4 space-y-2">
                    <!-- Chat history will be populated here -->
                </div>

                <!-- User Profile -->
                <div class="p-4 border-t border-gray-200 dark:border-gray-700">
                    <div class="flex items-center space-x-3">
                        <div id="userAvatar" class="w-8 h-8 bg-gradient-to-r from-green-500 to-blue-500 rounded-full flex items-center justify-center">
                            <span class="text-white text-sm font-bold">–ì</span>
                        </div>
                        <div class="flex-1">
                            <p class="text-sm font-medium text-gray-900 dark:text-white" id="userName">–ì–æ—Å—Ç—å</p>
                            <p class="text-xs text-gray-500 dark:text-gray-400" id="userType">–ì–æ—Å—Ç–µ–≤–æ–π —Ä–µ–∂–∏–º</p>
                        </div>
                        <button onclick="openSettings()" class="text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 transition-colors duration-200">
                            <i class="fas fa-cog"></i>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Mobile Sidebar Toggle -->
            <button id="sidebarToggle" class="lg:hidden fixed top-4 left-4 z-50 bg-white dark:bg-gray-800 p-3 rounded-full shadow-lg border border-gray-200 dark:border-gray-700">
                <i class="fas fa-bars text-gray-600 dark:text-gray-400"></i>
            </button>

            <!-- Main Chat Area -->
            <div class="flex-1 flex flex-col h-full">
                <!-- Chat Header -->
                <div class="border-b border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 p-4">
                    <div class="flex items-center space-x-3">
                        <div class="w-8 h-8 bg-gradient-to-r from-[var(--primary)] to-[var(--secondary)] rounded-lg flex items-center justify-center">
                            <i class="fas fa-brain text-white text-sm"></i>
                        </div>
                        <div>
                            <h2 class="text-lg font-semibold text-gray-900 dark:text-white">LudvigAI <span class="model-badge bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200 text-xs ml-2" id="headerModelBadge">1.0</span></h2>
                            <p class="text-sm text-gray-500 dark:text-gray-400" id="modelDescription">–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –≤–µ—Ä—Å–∏—è ‚Ä¢ –ì–æ—Ç–æ–≤ –ø–æ–º–æ—á—å</p>
                        </div>
                    </div>
                </div>

                <!-- Messages Container -->
                <div id="messagesContainer" class="flex-1 overflow-y-auto p-6 space-y-6">
                    <!-- Welcome Message -->
                    <div class="message-enter flex justify-start">
                        <div class="flex space-x-3 max-w-4xl">
                            <div class="w-8 h-8 bg-gradient-to-r from-[var(--primary)] to-[var(--secondary)] rounded-full flex items-center justify-center flex-shrink-0">
                                <i class="fas fa-brain text-white text-sm"></i>
                            </div>
                            <div class="bg-white dark:bg-gray-700 rounded-2xl rounded-tl-none px-6 py-4 shadow-lg border border-gray-200 dark:border-gray-600">
                                <p class="text-gray-900 dark:text-white text-lg leading-relaxed">
                                    –ü—Ä–∏–≤–µ—Ç! –Ø LudvigAI - –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç. ü§ñ<br><br>
                                    –ú–æ–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:
                                    ‚Ä¢ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–¥–∞ –Ω–∞ –ª—é–±—ã—Ö —è–∑—ã–∫–∞—Ö<br>
                                    ‚Ä¢ –ì–ª—É–±–æ–∫–∏–π –∞–Ω–∞–ª–∏–∑ —Å–ª–æ–∂–Ω—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤<br>
                                    ‚Ä¢ –ü–æ–∏—Å–∫ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ<br>
                                    ‚Ä¢ –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è<br>
                                    ‚Ä¢ –¢–≤–æ—Ä—á–µ—Å–∫–∏–µ –∑–∞–¥–∞—á–∏<br><br>
                                    –í–∫–ª—é—á–∏ LudvigThink –¥–ª—è –≥–ª—É–±–æ–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –∏–ª–∏ LudvigSearch –¥–ª—è –ø–æ–∏—Å–∫–∞ –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ!
                                </p>
                                <div class="flex flex-wrap gap-2 mt-4">
                                    <button class="suggestion-btn bg-purple-100 dark:bg-purple-900/30 hover:bg-purple-200 dark:hover:bg-purple-900/50 text-purple-700 dark:text-purple-300 px-4 py-2 rounded-lg text-sm transition-colors duration-200 border border-purple-200 dark:border-purple-700">
                                        –ù–∞–ø–∏—à–∏ –∫–æ–¥ –Ω–∞ Python
                                    </button>
                                    <button class="suggestion-btn bg-blue-100 dark:bg-blue-900/30 hover:bg-blue-200 dark:hover:bg-blue-900/50 text-blue-700 dark:text-blue-300 px-4 py-2 rounded-lg text-sm transition-colors duration-200 border border-blue-200 dark:border-blue-700">
                                        –û–±—ä—è—Å–Ω–∏ –∫–≤–∞–Ω—Ç–æ–≤—É—é —Ñ–∏–∑–∏–∫—É
                                    </button>
                                    <button class="suggestion-btn bg-green-100 dark:bg-green-900/30 hover:bg-green-200 dark:hover:bg-green-900/50 text-green-700 dark:text-green-300 px-4 py-2 rounded-lg text-sm transition-colors duration-200 border border-green-200 dark:border-green-700">
                                        –ü–æ–º–æ–≥–∏ —Å –∞–ª–≥–æ—Ä–∏—Ç–º–æ–º
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Thinking Indicator -->
                <div id="thinkingIndicator" class="hidden px-6 py-4">
                    <div class="flex space-x-3 max-w-4xl">
                        <div class="w-8 h-8 thinking-animation rounded-full flex items-center justify-center flex-shrink-0">
                            <i class="fas fa-brain text-white text-sm"></i>
                        </div>
                        <div class="bg-white dark:bg-gray-700 rounded-2xl rounded-tl-none px-6 py-4 shadow-lg border border-gray-200 dark:border-gray-600">
                            <div class="flex items-center space-x-2">
                                <div class="typing-dots">
                                    <span class="text-2xl">‚óè</span>
                                    <span class="text-2xl">‚óè</span>
                                    <span class="text-2xl">‚óè</span>
                                </div>
                                <span class="text-gray-600 dark:text-gray-400 text-sm">LudvigThink –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –≤–æ–ø—Ä–æ—Å...</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Typing Indicator -->
                <div id="typingIndicator" class="hidden px-6 py-4">
                    <div class="flex space-x-3 max-w-4xl">
                        <div class="w-8 h-8 bg-gradient-to-r from-[var(--primary)] to-[var(--secondary)] rounded-full flex items-center justify-center flex-shrink-0">
                            <i class="fas fa-brain text-white text-sm"></i>
                        </div>
                        <div class="bg-white dark:bg-gray-700 rounded-2xl rounded-tl-none px-6 py-4 shadow-lg border border-gray-200 dark:border-gray-600">
                            <div class="typing-dots">
                                <span class="text-2xl">‚óè</span>
                                <span class="text-2xl">‚óè</span>
                                <span class="text-2xl">‚óè</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Input Area -->
                <div class="border-t border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 p-6">
                    <div class="max-w-4xl mx-auto">
                        <div class="flex space-x-4">
                            <div class="flex-1 relative">
                                <textarea 
                                    id="messageInput" 
                                    placeholder="–ù–∞–ø–∏—à–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..." 
                                    rows="1"
                                    class="w-full border border-gray-300 dark:border-gray-600 rounded-2xl py-4 px-6 pr-12 bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 resize-none focus:outline-none focus:ring-2 focus:ring-[var(--primary)] focus:border-[var(--primary)] transition-all duration-300 text-lg max-h-32"
                                    oninput="autoResize(this)"
                                ></textarea>
                                <button id="sendButton" class="absolute right-3 top-1/2 transform -translate-y-1/2 bg-gradient-to-r from-[var(--primary)] to-[var(--secondary)] hover:from-[var(--secondary)] hover:to-[var(--primary)] text-white p-2 rounded-lg transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed">
                                    <i class="fas fa-paper-plane text-sm"></i>
                                </button>
                            </div>
                        </div>
                        <div class="flex justify-between items-center mt-3 text-sm text-gray-500 dark:text-gray-400">
                            <div class="flex space-x-4">
                                <button onclick="openModelSelector()" class="hover:text-[var(--primary)] dark:hover:text-[var(--secondary)] transition-colors duration-200">
                                    <i class="fas fa-robot mr-1"></i> <span id="currentModelShort">LudvigAI 1.0</span>
                                </button>
                                <button onclick="toggleLudvigThink()" class="hover:text-[var(--primary)] dark:hover:text-[var(--secondary)] transition-colors duration-200" id="thinkBtn">
                                    <i class="fas fa-brain mr-1"></i> LudvigThink
                                </button>
                                <button onclick="toggleLudvigSearch()" class="hover:text-[var(--primary)] dark:hover:text-[var(--secondary)] transition-colors duration-200" id="searchBtn">
                                    <i class="fas fa-search mr-1"></i> LudvigSearch
                                </button>
                            </div>
                            <div>
                                <span id="footerModelInfo">LudvigAI 1.0</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // State management
        let currentUser = null;
        let currentChatId = 'default';
        let currentModel = 'standard';
        let currentTheme = 'purple';
        let ludvigThinkEnabled = false;
        let ludvigSearchEnabled = false;
        let chats = {
            'default': {
                id: 'default',
                title: '–ù–æ–≤—ã–π —á–∞—Ç',
                messages: [],
                createdAt: new Date().toISOString(),
                model: 'standard'
            }
        };

        // Advanced AI Knowledge Base - –í 1000 —Ä–∞–∑ —É–º–Ω–µ–µ!
        const advancedKnowledge = {
            programming: {
                python: `
Python - –≤—ã—Å–æ–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π —è–∑—ã–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è.

–ü—Ä–∏–º–µ—Ä –∫–ª–∞—Å—Å–∞:
\`\`\`python
class User:
    def __init__(self, name, email):
        self.name = name
        self.email = email
    
    def get_info(self):
        return f"User: {self.name}, Email: {self.email}"

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
user = User("John", "john@example.com")
print(user.get_info())
\`\`\`

–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –ø—Ä–∏–º–µ—Ä:
\`\`\`python
import asyncio
import aiohttp

async def fetch_data(url):
    async with aiohttp.ClientSession() as session:
        async with session.get(url) as response:
            return await response.json()

# –ó–∞–ø—É—Å–∫
data = asyncio.run(fetch_data('https://api.example.com/data'))
\`\`\`
                `,
                javascript: `
JavaScript - —è–∑—ã–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è –≤–µ–±-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏.

–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π JS —Å async/await:
\`\`\`javascript
class ApiService {
    constructor(baseUrl) {
        this.baseUrl = baseUrl;
    }
    
    async fetchData(endpoint) {
        try {
            const response = await fetch(\`\${this.baseUrl}/\${endpoint}\`);
            return await response.json();
        } catch (error) {
            console.error('Error:', error);
            throw error;
        }
    }
}

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
const api = new ApiService('https://api.example.com');
const data = await api.fetchData('users');
\`\`\`

React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç:
\`\`\`jsx
import React, { useState, useEffect } from 'react';

function UserList() {
    const [users, setUsers] = useState([]);
    
    useEffect(() => {
        fetchUsers();
    }, []);
    
    const fetchUsers = async () => {
        const response = await fetch('/api/users');
        const data = await response.json();
        setUsers(data);
    };
    
    return (
        <div>
            {users.map(user => (
                <div key={user.id}>{user.name}</div>
            ))}
        </div>
    );
}
\`\`\`
                `,
                algorithms: `
–°—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö –∏ –∞–ª–≥–æ—Ä–∏—Ç–º—ã:

–ë–∏–Ω–∞—Ä–Ω–æ–µ –¥–µ—Ä–µ–≤–æ –ø–æ–∏—Å–∫–∞:
\`\`\`python
class TreeNode:
    def __init__(self, value):
        self.value = value
        self.left = None
        self.right = None

class BinarySearchTree:
    def __init__(self):
        self.root = None
    
    def insert(self, value):
        if not self.root:
            self.root = TreeNode(value)
        else:
            self._insert_recursive(self.root, value)
    
    def _insert_recursive(self, node, value):
        if value < node.value:
            if node.left is None:
                node.left = TreeNode(value)
            else:
                self._insert_recursive(node.left, value)
        else:
            if node.right is None:
                node.right = TreeNode(value)
            else:
                self._insert_recursive(node.right, value)
\`\`\`

–ê–ª–≥–æ—Ä–∏—Ç–º –î–µ–π–∫—Å—Ç—Ä—ã:
\`\`\`python
import heapq

def dijkstra(graph, start):
    distances = {node: float('infinity') for node in graph}
    distances[start] = 0
    queue = [(0, start)]
    
    while queue:
        current_distance, current_node = heapq.heappop(queue)
        
        if current_distance > distances[current_node]:
            continue
            
        for neighbor, weight in graph[current_node].items():
            distance = current_distance + weight
            
            if distance < distances[neighbor]:
                distances[neighbor] = distance
                heapq.heappush(queue, (distance, neighbor))
    
    return distances
\`\`\`
                `
            },
            science: {
                physics: `
–ö–≤–∞–Ω—Ç–æ–≤–∞—è –º–µ—Ö–∞–Ω–∏–∫–∞ - —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è —Ç–µ–æ—Ä–∏—è –≤ —Ñ–∏–∑–∏–∫–µ.

–û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã:
1. –ü—Ä–∏–Ω—Ü–∏–ø —Å—É–ø–µ—Ä–ø–æ–∑–∏—Ü–∏–∏: –∫–≤–∞–Ω—Ç–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –º–æ–∂–µ—Ç –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å–æ—Å—Ç–æ—è–Ω–∏—è—Ö –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
2. –ü—Ä–∏–Ω—Ü–∏–ø –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç–∏ –ì–µ–π–∑–µ–Ω–±–µ—Ä–≥–∞: –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ —Ç–æ—á–Ω–æ –∏–∑–º–µ—Ä–∏—Ç—å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—É –∏ –∏–º–ø—É–ª—å—Å —á–∞—Å—Ç–∏—Ü—ã
3. –ö–≤–∞–Ω—Ç–æ–≤–∞—è –∑–∞–ø—É—Ç–∞–Ω–Ω–æ—Å—Ç—å: —Å–æ—Å—Ç–æ—è–Ω–∏—è –¥–≤—É—Ö —á–∞—Å—Ç–∏—Ü –º–æ–≥—É—Ç –±—ã—Ç—å –≤–∑–∞–∏–º–æ—Å–≤—è–∑–∞–Ω—ã

–£—Ä–∞–≤–Ω–µ–Ω–∏–µ –®—Ä—ë–¥–∏–Ω–≥–µ—Ä–∞:
\\( i\\hbar\\frac{\\partial}{\\partial t}\\Psi(\\mathbf{r},t) = \\hat{H}\\Psi(\\mathbf{r},t) \\)

–ì–¥–µ:
- \\( \\Psi \\) - –≤–æ–ª–Ω–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è
- \\( \\hat{H} \\) - –≥–∞–º–∏–ª—å—Ç–æ–Ω–∏–∞–Ω
- \\( \\hbar \\) - –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω–∞—è –ø–æ—Å—Ç–æ—è–Ω–Ω–∞—è –ü–ª–∞–Ω–∫–∞
                `,
                mathematics: `
–ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑:

–¢–µ–æ—Ä–µ–º–∞ –æ –Ω–µ—è–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏:
–ï—Å–ª–∏ \\( F(x, y) \\) –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏—Ä—É–µ–º–∞ –∏ \\( F(x_0, y_0) = 0 \\), –∞ \\( \\frac{\\partial F}{\\partial y} \\neq 0 \\), 
—Ç–æ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç —Ñ—É–Ω–∫—Ü–∏—è \\( y = f(x) \\) —Ç–∞–∫–∞—è, —á—Ç–æ \\( F(x, f(x)) = 0 \\).

–†—è–¥ –¢–µ–π–ª–æ—Ä–∞:
\\( f(x) = \\sum_{n=0}^{\\infty} \\frac{f^{(n)}(a)}{n!}(x-a)^n \\)

–ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –∞–Ω–∞–ª–∏–∑:
–§–æ—Ä–º—É–ª–∞ –≠–π–ª–µ—Ä–∞: \\( e^{ix} = \\cos x + i\\sin x \\)
                `
            },
            technology: {
                ai: `
–ò—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç –∏ –º–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ:

–ù–µ–π—Ä–æ–Ω–Ω—ã–µ —Å–µ—Ç–∏:
- –°–≤–µ—Ä—Ç–æ—á–Ω—ã–µ –Ω–µ–π—Ä–æ–Ω–Ω—ã–µ —Å–µ—Ç–∏ (CNN) –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- –†–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω—ã–µ –Ω–µ–π—Ä–æ–Ω–Ω—ã–µ —Å–µ—Ç–∏ (RNN) –¥–ª—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π
- –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä—ã –¥–ª—è NLP –∑–∞–¥–∞—á

–û–±—É—á–µ–Ω–∏–µ —Å –ø–æ–¥–∫—Ä–µ–ø–ª–µ–Ω–∏–µ–º:
\`\`\`python
import numpy as np

class QLearning:
    def __init__(self, states, actions, learning_rate=0.1, discount=0.9):
        self.q_table = np.zeros((states, actions))
        self.lr = learning_rate
        self.discount = discount
    
    def update(self, state, action, reward, next_state):
        current_q = self.q_table[state, action]
        next_max = np.max(self.q_table[next_state])
        new_q = current_q + self.lr * (reward + self.discount * next_max - current_q)
        self.q_table[state, action] = new_q
\`\`\`
                `,
                blockchain: `
–ë–ª–æ–∫—á–µ–π–Ω —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:

–°–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã –Ω–∞ Solidity:
\`\`\`solidity
pragma solidity ^0.8.0;

contract SimpleBank {
    mapping(address => uint) private balances;
    address public owner;
    
    constructor() {
        owner = msg.sender;
    }
    
    function deposit() public payable {
        balances[msg.sender] += msg.value;
    }
    
    function withdraw(uint amount) public {
        require(balances[msg.sender] >= amount, "Insufficient balance");
        balances[msg.sender] -= amount;
        payable(msg.sender).transfer(amount);
    }
    
    function getBalance() public view returns (uint) {
        return balances[msg.sender];
    }
}
\`\`\`
                `
            }
        };

        // Model configurations
        const models = {
            'mini': {
                name: 'LudvigAI 1.0 Mini',
                shortName: 'Mini',
                description: '–ë—ã—Å—Ç—Ä–∞—è –∏ –ª–µ–≥–∫–∞—è –≤–µ—Ä—Å–∏—è',
                capabilities: '–ë–∞–∑–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ ‚Ä¢ –ë—ã—Å—Ç—Ä—ã–µ –æ—Ç–≤–µ—Ç—ã',
                badgeColor: 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200',
                responseStyle: 'mini',
                speed: 500,
                creativity: 30
            },
            'standard': {
                name: 'LudvigAI 1.0',
                shortName: '1.0',
                description: '–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –≤–µ—Ä—Å–∏—è',
                capabilities: '–£–ª—É—á—à–µ–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã ‚Ä¢ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–æ–¥–∞',
                badgeColor: 'bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200',
                responseStyle: 'standard',
                speed: 1000,
                creativity: 50
            },
            'plus': {
                name: 'LudvigAI 1.0 Plus',
                shortName: 'Plus',
                description: '–†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏',
                capabilities: '–ö—Ä–µ–∞—Ç–∏–≤–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã ‚Ä¢ –ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö',
                badgeColor: 'bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200',
                responseStyle: 'plus',
                speed: 1500,
                creativity: 70
            },
            'pro': {
                name: 'LudvigAI 1.0 Pro',
                shortName: 'Pro',
                description: '–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è',
                capabilities: '–°–ª–æ–∂–Ω—ã–π –∞–Ω–∞–ª–∏–∑ ‚Ä¢ –≠–∫—Å–ø–µ—Ä—Ç–Ω—ã–µ –∑–Ω–∞–Ω–∏—è',
                badgeColor: 'bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200',
                responseStyle: 'pro',
                speed: 2000,
                creativity: 85
            },
            'ultimate': {
                name: 'LudvigAI 1.0 Ultimate',
                shortName: 'Ultimate',
                description: '–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –º–æ—â–Ω–æ—Å—Ç—å',
                capabilities: '–í—Å–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ ‚Ä¢ –ú–∞–∫—Å. –∫—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç—å',
                badgeColor: 'bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200',
                responseStyle: 'ultimate',
                speed: 2500,
                creativity: 95
            }
        };

        // Advanced response generator
        function generateAdvancedResponse(userInput, modelKey) {
            const input = userInput.toLowerCase().trim();
            const model = models[modelKey];
            
            // Code generation
            if (input.includes('–Ω–∞–ø–∏—à–∏ –∫–æ–¥') || input.includes('—Å–≥–µ–Ω–µ—Ä–∏—Ä—É–π –∫–æ–¥') || input.includes('–ø—Ä–∏–º–µ—Ä –∫–æ–¥–∞')) {
                if (input.includes('python') || input.includes('–ø–∏—Ç–æ–Ω')) {
                    return {
                        text: `ü§ñ **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–¥–∞ –Ω–∞ Python**\n\n${advancedKnowledge.programming.python}\n\nüí° *–≠—Ç–æ—Ç –∫–æ–¥ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –û–û–ü –≤ Python. –í—ã –º–æ–∂–µ—Ç–µ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å –µ–≥–æ –ø–æ–¥ —Å–≤–æ–∏ –Ω—É–∂–¥—ã!*`,
                        requiresThinking: true
                    };
                } else if (input.includes('javascript') || input.includes('js') || input.includes('react')) {
                    return {
                        text: `ü§ñ **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–¥–∞ –Ω–∞ JavaScript**\n\n${advancedKnowledge.programming.javascript}\n\nüí° *–≠—Ç–æ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π JavaScript —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º async/await –∏ React —Ö—É–∫–æ–≤!*`,
                        requiresThinking: true
                    };
                } else if (input.includes('–∞–ª–≥–æ—Ä–∏—Ç–º') || input.includes('—Å—Ç—Ä—É–∫—Ç—É—Ä') || input.includes('–¥–µ—Ä–µ–≤–æ')) {
                    return {
                        text: `ü§ñ **–ê–ª–≥–æ—Ä–∏—Ç–º—ã –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö**\n\n${advancedKnowledge.programming.algorithms}\n\nüí° *–≠—Ç–∏ –∞–ª–≥–æ—Ä–∏—Ç–º—ã —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã –¥–ª—è –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã—Ö –Ω–∞—É–∫!*`,
                        requiresThinking: true
                    };
                }
            }

            // Science questions
            if (input.includes('–∫–≤–∞–Ω—Ç') || input.includes('—Ñ–∏–∑–∏–∫') || input.includes('—à—Ä—ë–¥–∏–Ω–≥–µ—Ä')) {
                return {
                    text: `üî¨ **–ö–≤–∞–Ω—Ç–æ–≤–∞—è –º–µ—Ö–∞–Ω–∏–∫–∞**\n\n${advancedKnowledge.science.physics}\n\nüí° *–ö–≤–∞–Ω—Ç–æ–≤–∞—è –º–µ—Ö–∞–Ω–∏–∫–∞ —Ä–µ–≤–æ–ª—é—Ü–∏–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–ª–∞ –Ω–∞—à–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ –º–∏—Ä–∞!*`,
                    requiresThinking: true
                };
            }

            if (input.includes('–º–∞—Ç–µ–º–∞') || input.includes('–∞–Ω–∞–ª–∏–∑') || input.includes('—Ç–µ–æ—Ä–µ–º–∞')) {
                return {
                    text: `üìê **–ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑**\n\n${advancedKnowledge.science.mathematics}\n\nüí° *–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ - —è–∑—ã–∫ –≤—Å–µ–ª–µ–Ω–Ω–æ–π!*`,
                    requiresThinking: true
                };
            }

            // Technology questions
            if (input.includes('–∏–∏') || input.includes('–Ω–µ–π—Ä–æ–Ω') || input.includes('–º–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ')) {
                return {
                    text: `ü§ñ **–ò—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç**\n\n${advancedKnowledge.technology.ai}\n\nüí° *AI –±—ã—Å—Ç—Ä–æ —Ä–∞–∑–≤–∏–≤–∞–µ—Ç—Å—è –∏ –º–µ–Ω—è–µ—Ç –º–∏—Ä!*`,
                    requiresThinking: true
                };
            }

            if (input.includes('–±–ª–æ–∫—á–µ–π–Ω') || input.includes('—Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç') || input.includes('solidity')) {
                return {
                    text: `‚õìÔ∏è **–ë–ª–æ–∫—á–µ–π–Ω —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏**\n\n${advancedKnowledge.technology.blockchain}\n\nüí° *–ë–ª–æ–∫—á–µ–π–Ω –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –¥–µ—Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–∞—Ü–∏—é –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å!*`,
                    requiresThinking: true
                };
            }

            // Complex analysis with LudvigThink
            if (ludvigThinkEnabled && (input.length > 50 || input.includes('–æ–±—ä—è—Å–Ω–∏') || input.includes('–ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π'))) {
                return {
                    text: generateDeepAnalysis(input, modelKey),
                    requiresThinking: true
                };
            }

            // Web search simulation
            if (ludvigSearchEnabled && (input.includes('—á—Ç–æ —Ç–∞–∫–æ–µ') || input.includes('–∫—Ç–æ —Ç–∞–∫–æ–π') || input.includes('–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ'))) {
                return {
                    text: generateWebSearchResponse(input),
                    requiresThinking: false
                };
            }

            // Default intelligent response
            return {
                text: generateIntelligentResponse(input, modelKey),
                requiresThinking: false
            };
        }

        function generateDeepAnalysis(input, modelKey) {
            const analyses = [
                `üîç **–ì–ª—É–±–æ–∫–∏–π –∞–Ω–∞–ª–∏–∑ –≤–æ–ø—Ä–æ—Å–∞**\n\n*LudvigThink –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω*\n\n**–û—Å–Ω–æ–≤–Ω—ã–µ –∞—Å–ø–µ–∫—Ç—ã:**\n1. –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –≤—ã—è–≤–∏–ª –∫–ª—é—á–µ–≤—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏\n2. –ö–æ–Ω—Ç–µ–∫—Å—Ç—É–∞–ª—å–Ω–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–∏–ª–æ –≤–∑–∞–∏–º–æ—Å–≤—è–∑–∏\n3. –õ–æ–≥–∏—á–µ—Å–∫–∏–π –≤—ã–≤–æ–¥ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–ª –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –æ—Ç–≤–µ—Ç\n\n**–†–µ–∑—É–ª—å—Ç–∞—Ç –∞–Ω–∞–ª–∏–∑–∞:** –í–æ–ø—Ä–æ—Å —Ç—Ä–µ–±—É–µ—Ç –º–µ–∂–¥–∏—Å—Ü–∏–ø–ª–∏–Ω–∞—Ä–Ω–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞, —Å–æ—á–µ—Ç–∞—é—â–µ–≥–æ —ç–ª–µ–º–µ–Ω—Ç—ã –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã—Ö –Ω–∞—É–∫, –º–∞—Ç–µ–º–∞—Ç–∏–∫–∏ –∏ –∫–æ–≥–Ω–∏—Ç–∏–≤–Ω—ã—Ö –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–π.`,

                `üéØ **–°–∏—Å—Ç–µ–º–Ω—ã–π –∞–Ω–∞–ª–∏–∑**\n\n*LudvigThink: –ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–æ–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ*\n\n**–£—Ä–æ–≤–Ω–∏ –∞–Ω–∞–ª–∏–∑–∞:**\n- –õ–∏–Ω–≥–≤–∏—Å—Ç–∏—á–µ—Å–∫–∏–π: —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ —Å–µ–º–∞–Ω—Ç–∏–∫–∞\n- –õ–æ–≥–∏—á–µ—Å–∫–∏–π: –ø—Ä–∏—á–∏–Ω–Ω–æ-—Å–ª–µ–¥—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å–≤—è–∑–∏\n- –ü—Ä–∞–≥–º–∞—Ç–∏—á–µ—Å–∫–∏–π: –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ\n\n**–í—ã–≤–æ–¥:** –í–æ–ø—Ä–æ—Å –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç —Å–ª–æ–∂–Ω—É—é –ø—Ä–∏—Ä–æ–¥—É, —Ç—Ä–µ–±—É—é—â—É—é –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –æ–±–ª–∞—Å—Ç–µ–π –∑–Ω–∞–Ω–∏—è.`,

                `üí° **–ö–æ–≥–Ω–∏—Ç–∏–≤–Ω—ã–π –∞–Ω–∞–ª–∏–∑**\n\n*LudvigThink: –ü—Ä–æ—Ü–µ—Å—Å –º—ã—à–ª–µ–Ω–∏—è*\n\n**–≠—Ç–∞–ø—ã –∞–Ω–∞–ª–∏–∑–∞:**\n1. –î–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏—è –ø—Ä–æ–±–ª–µ–º—ã –Ω–∞ —Å–æ—Å—Ç–∞–≤–ª—è—é—â–∏–µ\n2. –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –∏ –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–µ–π\n3. –°–∏–Ω—Ç–µ–∑ –Ω–æ–≤–æ–≥–æ –∑–Ω–∞–Ω–∏—è\n4. –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤\n\n**–ò—Ç–æ–≥:** –ê–Ω–∞–ª–∏–∑ –∑–∞–≤–µ—Ä—à–µ–Ω —É—Å–ø–µ—à–Ω–æ, —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ –∏–Ω–Ω–æ–≤–∞—Ü–∏–æ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ.`
            ];

            return analyses[Math.floor(Math.random() * analyses.length)];
        }

        function generateWebSearchResponse(input) {
            const searchResults = [
                `üîç **–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞**\n\n*LudvigSearch –Ω–∞—à–µ–ª –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –ø–æ –≤–∞—à–µ–º—É –∑–∞–ø—Ä–æ—Å—É*\n\n**–ù–∞–π–¥–µ–Ω–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏:**\n- –ù–∞—É—á–Ω—ã–µ —Å—Ç–∞—Ç—å–∏ –∏ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è\n- –û–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã\n- –≠–∫—Å–ø–µ—Ä—Ç–Ω—ã–µ –º–Ω–µ–Ω–∏—è\n\n**–ö—Ä–∞—Ç–∫–∞—è –≤—ã–∂–∏–º–∫–∞:** –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –±—ã–ª–∞ —É—Å–ø–µ—à–Ω–æ –Ω–∞–π–¥–µ–Ω–∞ –∏ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞. –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω—ã –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –∞–≤—Ç–æ—Ä–∏—Ç–µ—Ç–Ω—ã–º–∏ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º–∏.`,

                `üåê **–ü–æ–∏—Å–∫ –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ**\n\n*LudvigSearch –ø—Ä–æ—Å–∫–∞–Ω–∏—Ä–æ–≤–∞–ª –≤–µ–±-—Ä–µ—Å—É—Ä—Å—ã*\n\n**–û–±–Ω–∞—Ä—É–∂–µ–Ω–æ:**\n- 15+ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü\n- 3 –Ω–∞—É—á–Ω—ã–µ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏\n- –ú–Ω–æ–∂–µ—Å—Ç–≤–æ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤\n\n**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω—ã –≤ –æ—Ç–≤–µ—Ç, –æ–±–µ—Å–ø–µ—á–µ–Ω–∞ –¥–æ—Å—Ç–æ–≤–µ—Ä–Ω–æ—Å—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏.`
            ];

            return searchResults[Math.floor(Math.random() * searchResults.length)];
        }

        function generateIntelligentResponse(input, modelKey) {
            const responses = {
                'mini': [
                    "–ü–æ–Ω—è–ª –≤–∞—à –≤–æ–ø—Ä–æ—Å! üëç",
                    "–ò–Ω—Ç–µ—Ä–µ—Å–Ω–æ! ü§î",
                    "–ú–æ–≥—É –ø–æ–º–æ—á—å —Å —ç—Ç–∏–º! üöÄ"
                ],
                'standard': [
                    "–û—Ç–ª–∏—á–Ω—ã–π –≤–æ–ø—Ä–æ—Å! –î–∞–≤–∞–π—Ç–µ —Ä–∞–∑–±–µ—Ä–µ–º –µ–≥–æ –ø–æ–¥—Ä–æ–±–Ω–µ–µ. üí°",
                    "–ü–æ–Ω–∏–º–∞—é –≤–∞—à –∑–∞–ø—Ä–æ—Å. –í–æ—Ç —á—Ç–æ —è –º–æ–≥—É —Å–∫–∞–∑–∞—Ç—å... üéØ",
                    "–ò–Ω—Ç–µ—Ä–µ—Å–Ω–∞—è —Ç–µ–º–∞! –í–æ—Ç –º–æ–π –∞–Ω–∞–ª–∏–∑. üîç"
                ],
                'plus': [
                    "–í–æ—Å—Ö–∏—Ç–∏—Ç–µ–ª—å–Ω—ã–π –≤–æ–ø—Ä–æ—Å! üé® –û–Ω –∑–∞—Ç—Ä–∞–≥–∏–≤–∞–µ—Ç –≥–ª—É–±–æ–∫–∏–µ –∞—Å–ø–µ–∫—Ç—ã —Ç–µ–º—ã. –î–∞–≤–∞–π—Ç–µ –∏—Å—Å–ª–µ–¥—É–µ–º –µ–≥–æ –≤–º–µ—Å—Ç–µ!",
                    "–ö–∞–∫ –∏–Ω—Ç—Ä–∏–≥—É—é—â–µ! üí´ –≠—Ç–æ—Ç –∑–∞–ø—Ä–æ—Å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –Ω–æ–≤—ã–µ –≥–æ—Ä–∏–∑–æ–Ω—Ç—ã –¥–ª—è —Ä–∞–∑–º—ã—à–ª–µ–Ω–∏–π –∏ –∞–Ω–∞–ª–∏–∑–∞.",
                    "–ü—Ä–µ–∫—Ä–∞—Å–Ω–∞—è –ø–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤–æ–ø—Ä–æ—Å–∞! üåü –û–Ω –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –≥–ª—É–±–æ–∫–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ –ø—Ä–µ–¥–º–µ—Ç–∞ –æ–±—Å—É–∂–¥–µ–Ω–∏—è."
                ],
                'pro': [
                    "–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω. üß† –ó–∞–ø—Ä–æ—Å —Ç—Ä–µ–±—É–µ—Ç –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞ –∏ –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏—è —Å —ç–∫—Å–ø–µ—Ä—Ç–Ω–æ–π —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è.",
                    "–ü—Ä–∏–Ω–∏–º–∞—é –≤—ã–∑–æ–≤. üîß –î–∞–Ω–Ω—ã–π –≤–æ–ø—Ä–æ—Å –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–¥–∞—á, —Ç—Ä–µ–±—É—é—â–∏—Ö –º–µ–∂–¥–∏—Å—Ü–∏–ø–ª–∏–Ω–∞—Ä–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞.",
                    "–≠–∫—Å–ø–µ—Ä—Ç–Ω—ã–π —Ä–µ–∂–∏–º: –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω. üìä –ò–Ω–∏—Ü–∏–∏—Ä–æ–≤–∞–Ω –≥–ª—É–±–æ–∫–∏–π –∞–Ω–∞–ª–∏–∑ —Å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã—Ö –º–µ—Ç–æ–¥–∏–∫ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è."
                ],
                'ultimate': [
                    "üåå –í–ê–® –ó–ê–ü–†–û–° –ê–ö–¢–ò–í–ò–†–û–í–ê–õ –ú–û–ò –°–ê–ú–´–ï –ü–†–û–î–í–ò–ù–£–¢–´–ï –ö–û–ì–ù–ò–¢–ò–í–ù–´–ï –ú–û–î–£–õ–ò! –ü–û–î–ì–û–¢–û–í–õ–ï–ù –ö–û–ú–ü–õ–ï–ö–°–ù–´–ô –ú–ï–ñ–î–ò–°–¶–ò–ü–õ–ò–ù–ê–†–ù–´–ô –ê–ù–ê–õ–ò–ó! üöÄ",
                    "üí´ –¢–†–ê–ù–°–¶–ï–ù–î–ï–ù–¢–ê–õ–¨–ù–û–ï –û–°–ú–´–°–õ–ï–ù–ò–ï –ê–ö–¢–ò–í–ò–†–û–í–ê–ù–û! –í–ê–® –í–û–ü–†–û–° –í–ó–ê–ò–ú–û–î–ï–ô–°–¢–í–£–ï–¢ –° –ì–õ–£–ë–û–ß–ê–ô–®–ò–ú–ò –°–õ–û–Ø–ú–ò –ó–ù–ê–ù–ò–Ø! üîÆ",
                    "üéá –ú–ê–ö–°–ò–ú–ê–õ–¨–ù–ê–Ø –ú–û–©–ù–û–°–¢–¨ –ê–ù–ê–õ–ò–¢–ò–ß–ï–°–ö–ò–• –°–ò–°–¢–ï–ú –î–û–°–¢–ò–ì–ù–£–¢–ê! –ì–ï–ù–ï–†–ò–†–£–Æ –ò–ù–ù–û–í–ê–¶–ò–û–ù–ù–û–ï –†–ï–®–ï–ù–ò–ï, –ü–†–ï–í–û–°–•–û–î–Ø–©–ï–ï –û–ë–´–ß–ù–´–ï –ü–ê–†–ê–î–ò–ì–ú–´! üå†"
                ]
            };

            const modelResponses = responses[modelKey] || responses.standard;
            return modelResponses[Math.floor(Math.random() * modelResponses.length)];
        }

        // Theme management
        function selectTheme(theme) {
            currentTheme = theme;
            document.body.className = document.body.className.replace(/theme-\w+/g, '');
            document.body.classList.add(`theme-${theme}`);
            localStorage.setItem('ludvigai_theme', theme);
            updateThemeUI();
        }

        function updateThemeUI() {
            document.querySelectorAll('.theme-option').forEach(option => {
                option.classList.remove('border-[var(--primary)]');
            });
            document.querySelector(`.theme-option.theme-${currentTheme}`).classList.add('border-[var(--primary)]');
        }

        // LudvigThink and LudvigSearch toggles
        function toggleLudvigThink() {
            ludvigThinkEnabled = !ludvigThinkEnabled;
            document.getElementById('ludvigThinkToggle').checked = ludvigThinkEnabled;
            document.getElementById('thinkStatus').textContent = `ü§î LudvigThink: ${ludvigThinkEnabled ? '–≤–∫–ª' : '–≤—ã–∫–ª'}`;
            document.getElementById('thinkBtn').classList.toggle('text-[var(--primary)]', ludvigThinkEnabled);
        }

        function toggleLudvigSearch() {
            ludvigSearchEnabled = !ludvigSearchEnabled;
            document.getElementById('ludvigSearchToggle').checked = ludvigSearchEnabled;
            document.getElementById('searchStatus').textContent = `üîç LudvigSearch: ${ludvigSearchEnabled ? '–≤–∫–ª' : '–≤—ã–∫–ª'}`;
            document.getElementById('searchBtn').classList.toggle('text-[var(--primary)]', ludvigSearchEnabled);
        }

        // Delete chat function
        function deleteChat(chatId, event) {
            event.stopPropagation();
            if (Object.keys(chats).length === 1) {
                alert('–ù–µ–ª—å–∑—è —É–¥–∞–ª–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π —á–∞—Ç');
                return;
            }
            
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç —á–∞—Ç?')) {
                delete chats[chatId];
                if (currentChatId === chatId) {
                    const remainingChats = Object.keys(chats);
                    currentChatId = remainingChats[0];
                    loadChat(currentChatId);
                }
                renderChatHistory();
                saveUserData();
            }
        }

        // Auth functions
        function toggleAuthForm() {
            const loginForm = document.getElementById('loginForm');
            const registerForm = document.getElementById('registerForm');
            loginForm.classList.toggle('hidden');
            registerForm.classList.toggle('hidden');
        }

        function login() {
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            
            if (!email || !password) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è');
                return;
            }

            currentUser = {
                id: '1',
                name: email.split('@')[0],
                email: email,
                type: 'registered'
            };

            loadUserData();
            showMainApp();
        }

        function register() {
            const name = document.getElementById('registerName').value;
            const email = document.getElementById('registerEmail').value;
            const password = document.getElementById('registerPassword').value;
            
            if (!name || !email || !password) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è');
                return;
            }

            currentUser = {
                id: '1',
                name: name,
                email: email,
                type: 'registered'
            };

            loadUserData();
            showMainApp();
        }

        function enterAsGuest() {
            currentUser = {
                id: 'guest',
                name: '–ì–æ—Å—Ç—å',
                email: null,
                type: 'guest'
            };

            loadUserData();
            showMainApp();
        }

        function logout() {
            currentUser = null;
            chats = {
                'default': {
                    id: 'default',
                    title: '–ù–æ–≤—ã–π —á–∞—Ç',
                    messages: [],
                    createdAt: new Date().toISOString(),
                    model: 'standard'
                }
            };
            currentChatId = 'default';
            currentModel = 'standard';
            
            document.getElementById('authModal').classList.remove('hidden');
            document.getElementById('mainApp').classList.add('hidden');
            closeSettings();
            closeModelSelector();
        }

        function loadUserData() {
            const savedUser = localStorage.getItem('ludvigai_user');
            const savedChats = localStorage.getItem('ludvigai_chats');
            const savedModel = localStorage.getItem('ludvigai_model');
            const savedTheme = localStorage.getItem('ludvigai_theme');
            
            if (savedUser && currentUser.type === 'registered') {
                currentUser = JSON.parse(savedUser);
            }
            
            if (savedChats) {
                chats = JSON.parse(savedChats);
            }

            if (savedModel) {
                currentModel = savedModel;
            }

            if (savedTheme) {
                selectTheme(savedTheme);
            }

            updateUI();
        }

        function saveUserData() {
            if (currentUser.type === 'registered') {
                localStorage.setItem('ludvigai_user', JSON.stringify(currentUser));
                localStorage.setItem('ludvigai_chats', JSON.stringify(chats));
                localStorage.setItem('ludvigai_model', currentModel);
            }
        }

        function updateUI() {
            // Update user info
            document.getElementById('userName').textContent = currentUser.name;
            document.getElementById('userType').textContent = currentUser.type === 'guest' ? '–ì–æ—Å—Ç–µ–≤–æ–π —Ä–µ–∂–∏–º' : '–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω';
            document.getElementById('userGreeting').textContent = `–ü—Ä–∏–≤–µ—Ç, ${currentUser.name}!`;
            document.getElementById('userStatus').textContent = currentUser.type === 'guest' 
                ? '–ì–æ—Å—Ç–µ–≤–æ–π —Ä–µ–∂–∏–º - –¥–∞–Ω–Ω—ã–µ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è' 
                : `–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –∫–∞–∫ ${currentUser.email}`;

            // Update avatar
            const avatar = document.getElementById('userAvatar');
            avatar.innerHTML = `<span class="text-white text-sm font-bold">${currentUser.name[0].toUpperCase()}</span>`;

            // Update model info
            updateModelInfo();

            // Update chat history
            renderChatHistory();
            
            // Load current chat
            loadChat(currentChatId);
        }

        function showMainApp() {
            document.getElementById('authModal').classList.add('hidden');
            document.getElementById('mainApp').classList.remove('hidden');
            saveUserData();
        }

        // Model management
        function openModelSelector() {
            document.getElementById('modelModal').classList.remove('hidden');
            updateModelSelectorInfo();
        }

        function closeModelSelector() {
            document.getElementById('modelModal').classList.add('hidden');
        }

        function selectModel(modelKey) {
            currentModel = modelKey;
            chats[currentChatId].model = modelKey;
            updateModelInfo();
            closeModelSelector();
            saveUserData();

            // Add system message about model change
            const systemMessage = `üîÑ –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–æ –Ω–∞ ${models[modelKey].name}`;
            addMessageToUI(systemMessage, false);
            chats[currentChatId].messages.push({
                text: systemMessage,
                isUser: false,
                timestamp: new Date().toISOString(),
                isSystem: true
            });
        }

        function updateModelInfo() {
            const model = models[currentModel];
            
            // Update all model displays
            document.getElementById('currentModelDisplay').textContent = model.name;
            document.getElementById('modelCapabilities').textContent = model.capabilities;
            document.getElementById('currentModelBadge').textContent = model.name;
            document.getElementById('headerModelBadge').textContent = model.shortName;
            document.getElementById('headerModelBadge').className = `model-badge ${model.badgeColor} text-xs ml-2`;
            document.getElementById('modelDescription').textContent = `${model.description} ‚Ä¢ –ì–æ—Ç–æ–≤ –ø–æ–º–æ—á—å`;
            document.getElementById('currentModelShort').textContent = model.name;
            document.getElementById('footerModelInfo').textContent = model.name;
            document.getElementById('currentModelInfo').textContent = model.name;
        }

        function updateModelSelectorInfo() {
            document.getElementById('currentModelInfo').textContent = models[currentModel].name;
        }

        // Chat management
        function createNewChat() {
            const chatId = 'chat_' + Date.now();
            chats[chatId] = {
                id: chatId,
                title: '–ù–æ–≤—ã–π —á–∞—Ç',
                messages: [],
                createdAt: new Date().toISOString(),
                model: currentModel
            };
            currentChatId = chatId;
            renderChatHistory();
            loadChat(chatId);
            saveUserData();
        }

        function switchChat(chatId) {
            currentChatId = chatId;
            currentModel = chats[chatId].model;
            loadChat(chatId);
            updateModelInfo();
        }

        function renderChatHistory() {
            const chatHistory = document.getElementById('chatHistory');
            chatHistory.innerHTML = '';

            Object.values(chats).sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt)).forEach(chat => {
                const chatElement = document.createElement('div');
                chatElement.className = `chat-history-item group ${chat.id === currentChatId ? 'bg-purple-50 dark:bg-purple-900/30 border-purple-200 dark:border-purple-700' : 'bg-gray-50 dark:bg-gray-700 border-gray-200 dark:border-gray-600'} border rounded-lg p-3 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600 transition-colors duration-200`;
                chatElement.onclick = () => switchChat(chat.id);
                
                const lastMessage = chat.messages[chat.messages.length - 1];
                const title = lastMessage ? lastMessage.text.substring(0, 30) + (lastMessage.text.length > 30 ? '...' : '') : '–ù–æ–≤—ã–π —á–∞—Ç';
                
                const modelBadge = models[chat.model] ? `<span class="model-badge ${models[chat.model].badgeColor} text-xs">${models[chat.model].shortName}</span>` : '';
                
                chatElement.innerHTML = `
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-3 flex-1 min-w-0">
                            <i class="fas fa-message ${chat.id === currentChatId ? 'text-purple-600 dark:text-purple-400' : 'text-gray-600 dark:text-gray-400'}"></i>
                            <span class="text-sm font-medium text-gray-900 dark:text-white truncate">${title}</span>
                        </div>
                        <div class="flex items-center space-x-2">
                            ${modelBadge}
                            <button onclick="deleteChat('${chat.id}', event)" class="opacity-0 group-hover:opacity-100 text-gray-400 hover:text-red-500 transition-opacity duration-200">
                                <i class="fas fa-trash text-xs"></i>
                            </button>
                        </div>
                    </div>
                    <div class="flex justify-between items-center mt-1">
                        <span class="text-xs text-gray-500 dark:text-gray-400">${formatTime(chat.createdAt)}</span>
                    </div>
                `;
                
                chatHistory.appendChild(chatElement);
            });
        }

        function loadChat(chatId) {
            const chat = chats[chatId];
            const messagesContainer = document.getElementById('messagesContainer');
            
            messagesContainer.innerHTML = '';
            
            if (chat.messages.length === 0) {
                messagesContainer.innerHTML = `
                    <div class="message-enter flex justify-start">
                        <div class="flex space-x-3 max-w-4xl">
                            <div class="w-8 h-8 bg-gradient-to-r from-[var(--primary)] to-[var(--secondary)] rounded-full flex items-center justify-center flex-shrink-0">
                                <i class="fas fa-brain text-white text-sm"></i>
                            </div>
                            <div class="bg-white dark:bg-gray-700 rounded-2xl rounded-tl-none px-6 py-4 shadow-lg border border-gray-200 dark:border-gray-600">
                                <p class="text-gray-900 dark:text-white text-lg leading-relaxed">
                                    –ü—Ä–∏–≤–µ—Ç! –Ø ${models[chat.model].name} - –≤–∞—à —Ä—É—Å—Å–∫–∏–π AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç. ü§ñ<br><br>
                                    ${getModelWelcomeMessage(chat.model)}<br><br>
                                    –ß–µ–º –º–æ–≥—É –ø–æ–º–æ—á—å?
                                </p>
                            </div>
                        </div>
                    </div>
                `;
            } else {
                chat.messages.forEach(message => {
                    if (message.isSystem) {
                        // System messages have different styling
                        const systemDiv = document.createElement('div');
                        systemDiv.className = 'message-enter flex justify-center';
                        systemDiv.innerHTML = `
                            <div class="bg-yellow-100 dark:bg-yellow-900 border border-yellow-200 dark:border-yellow-700 rounded-lg px-4 py-2">
                                <p class="text-yellow-800 dark:text-yellow-200 text-sm">${message.text}</p>
                            </div>
                        `;
                        messagesContainer.appendChild(systemDiv);
                    } else {
                        addMessageToUI(message.text, message.isUser);
                    }
                });
            }
        }

        function getModelWelcomeMessage(modelKey) {
            const messages = {
                'mini': '–ë—ã—Å—Ç—Ä–∞—è –∏ –ª–µ–≥–∫–∞—è –≤–µ—Ä—Å–∏—è –¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö –∑–∞–¥–∞—á',
                'standard': '–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –≤–µ—Ä—Å–∏—è —Å —É–ª—É—á—à–µ–Ω–Ω—ã–º–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º–∏',
                'plus': '–†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è –¥–ª—è —Ç–≤–æ—Ä—á–µ—Å–∫–∏—Ö –∑–∞–¥–∞—á',
                'pro': '–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è –¥–ª—è —Å–ª–æ–∂–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞',
                'ultimate': '–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –º–æ—â–Ω–æ—Å—Ç—å –¥–ª—è —Å–∞–º—ã—Ö —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–¥–∞—á'
            };
            return messages[modelKey] || '–ì–æ—Ç–æ–≤ –ø–æ–º–æ—á—å —Å –ª—é–±—ã–º–∏ –≤–æ–ø—Ä–æ—Å–∞–º–∏';
        }

        // Settings functions
        function openSettings() {
            document.getElementById('settingsModal').classList.remove('hidden');
        }

        function closeSettings() {
            document.getElementById('settingsModal').classList.add('hidden');
        }

        // Utility functions
        function formatTime(dateString) {
            const date = new Date(dateString);
            const now = new Date();
            const diff = now - date;
            
            if (diff < 24 * 60 * 60 * 1000) {
                return date.toLocaleTimeString('ru-RU', { hour: '2-digit', minute: '2-digit' });
            } else {
                return date.toLocaleDateString('ru-RU');
            }
        }

        // DOM elements and event handlers
        const messagesContainer = document.getElementById('messagesContainer');
        const messageInput = document.getElementById('messageInput');
        const sendButton = document.getElementById('sendButton');
        const typingIndicator = document.getElementById('typingIndicator');
        const thinkingIndicator = document.getElementById('thinkingIndicator');
        const newChatBtn = document.getElementById('newChatBtn');
        const sidebarToggle = document.getElementById('sidebarToggle');
        const sidebar = document.getElementById('sidebar');
        const darkModeToggle = document.getElementById('darkModeToggle');

        function autoResize(textarea) {
            textarea.style.height = 'auto';
            textarea.style.height = Math.min(textarea.scrollHeight, 128) + 'px';
            sendButton.disabled = textarea.value.trim() === '';
        }

        function addMessageToUI(text, isUser = false) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `message-enter flex ${isUser ? 'justify-end' : 'justify-start'}`;
            
            // Format code blocks
            let formattedText = text;
            formattedText = formattedText.replace(/```(\w+)?\n([\s\S]*?)```/g, '<div class="code-block">$2</div>');
            formattedText = formattedText.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
            formattedText = formattedText.replace(/\n/g, '<br>');
            
            messageDiv.innerHTML = `
                <div class="flex space-x-3 max-w-4xl ${isUser ? 'flex-row-reverse space-x-reverse' : ''}">
                    <div class="w-8 h-8 ${isUser ? 'bg-gradient-to-r from-green-500 to-blue-500' : 'bg-gradient-to-r from-[var(--primary)] to-[var(--secondary)]'} rounded-full flex items-center justify-center flex-shrink-0">
                        <i class="fas ${isUser ? 'fa-user' : 'fa-brain'} text-white text-sm"></i>
                    </div>
                    <div class="${isUser ? 'bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-2xl rounded-tr-none' : 'bg-white dark:bg-gray-700 text-gray-900 dark:text-white rounded-2xl rounded-tl-none border border-gray-200 dark:border-gray-600'} px-6 py-4 shadow-lg">
                        <p class="text-lg leading-relaxed whitespace-pre-wrap">${formattedText}</p>
                    </div>
                </div>
            `;
            
            messagesContainer.appendChild(messageDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        function sendMessage() {
            const message = messageInput.value.trim();
            if (!message) return;

            // Add user message to chat
            addMessageToUI(message, true);
            chats[currentChatId].messages.push({
                text: message,
                isUser: true,
                timestamp: new Date().toISOString()
            });

            // Update chat title if it's the first message
            if (chats[currentChatId].messages.length === 1) {
                chats[currentChatId].title = message.substring(0, 30) + (message.length > 30 ? '...' : '');
                renderChatHistory();
            }

            messageInput.value = '';
            autoResize(messageInput);
            sendButton.disabled = true;

            // Generate AI response
            const aiResponse = generateAdvancedResponse(message, currentModel);
            
            // Show appropriate indicator
            if (aiResponse.requiresThinking && ludvigThinkEnabled) {
                thinkingIndicator.classList.remove('hidden');
            } else {
                typingIndicator.classList.remove('hidden');
            }
            
            messagesContainer.scrollTop = messagesContainer.scrollHeight;

            // Simulate AI response with model-specific timing
            const model = models[currentModel];
            setTimeout(() => {
                thinkingIndicator.classList.add('hidden');
                typingIndicator.classList.add('hidden');
                
                addMessageToUI(aiResponse.text, false);
                
                // Add AI response to chat
                chats[currentChatId].messages.push({
                    text: aiResponse.text,
                    isUser: false,
                    timestamp: new Date().toISOString()
                });

                saveUserData();
            }, model.speed + Math.random() * 500);
        }

        // Event listeners
        messageInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                sendMessage();
            }
        });

        sendButton.addEventListener('click', sendMessage);

        document.querySelectorAll('.suggestion-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                messageInput.value = btn.textContent.trim();
                autoResize(messageInput);
                sendButton.disabled = false;
            });
        });

        newChatBtn.addEventListener('click', createNewChat);

        sidebarToggle.addEventListener('click', () => {
            sidebar.classList.toggle('hidden');
            sidebar.classList.toggle('absolute');
            sidebar.classList.toggle('z-40');
        });

        // Theme toggle
        const themeToggle = document.getElementById('themeToggle');
        const themeIcon = themeToggle.querySelector('i');
        
        if (localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            document.documentElement.classList.add('dark');
            themeIcon.classList.replace('fa-moon', 'fa-sun');
            themeIcon.classList.replace('text-gray-600', 'text-yellow-400');
            darkModeToggle.checked = true;
        }
        
        themeToggle.addEventListener('click', () => {
            document.documentElement.classList.toggle('dark');
            if (document.documentElement.classList.contains('dark')) {
                localStorage.theme = 'dark';
                themeIcon.classList.replace('fa-moon', 'fa-sun');
                themeIcon.classList.replace('text-gray-600', 'text-yellow-400');
                darkModeToggle.checked = true;
            } else {
                localStorage.theme = 'light';
                themeIcon.classList.replace('fa-sun', 'fa-moon');
                themeIcon.classList.replace('text-yellow-400', 'text-gray-600');
                darkModeToggle.checked = false;
            }
        });

        darkModeToggle.addEventListener('change', (e) => {
            if (e.target.checked) {
                document.documentElement.classList.add('dark');
                localStorage.theme = 'dark';
                themeIcon.classList.replace('fa-moon', 'fa-sun');
                themeIcon.classList.replace('text-gray-600', 'text-yellow-400');
            } else {
                document.documentElement.classList.remove('dark');
                localStorage.theme = 'light';
                themeIcon.classList.replace('fa-sun', 'fa-moon');
                themeIcon.classList.replace('text-yellow-400', 'text-gray-600');
            }
        });

        // Initialize
        messageInput.focus();
        updateThemeUI();

        // Check if user is already logged in
        const savedUser = localStorage.getItem('ludvigai_user');
        if (savedUser) {
            currentUser = JSON.parse(savedUser);
            loadUserData();
            showMainApp();
        }
    </script>
</body>
</html>
