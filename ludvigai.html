<!DOCTYPE html>
<html lang="ru>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>LudvigAI  винутый AI-ассистент</title>
<script src="cdn.tailwindcss.com"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>
<style>
/* Общие стили и анимации */
.gradient-bg {
  background: linear-gradient(-45deg, #667eea, #764ba2, #8a2be2, #6b46c1);
  background-size: 400% 400%;
  animation: gradient 15s ease infinite;
}
.gradient-text {
  background: linear-gradient(135deg, #667eea, #8a2be2);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-size: 200% 200%;
  animation: gradient 8s ease infinite;
}
@keyframes gradient {
  0%, 100% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
}
.sidebar-transition {
  transition: all 0.3s ease;
}
.message-enter {
  animation: messageEnter 0.3s ease;
}
@keyframes messageEnter {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}
.typing-dots {
  display: inline-block;
}
.typing-dots span {
  animation: typing 1.4s infinite;
}
.typing-dots span:nth-child(2) {
  animation-delay: 0.2s;
}
.typing-dots span:nth-child(3) {
  animation-delay: 0.4s;
}
@keyframes typing {
  0%, 60%, 100% { transform: translateY(0); }
  30% { transform: translateY(-10px); }
}
.fade-in {
  animation: fadeIn 0.5s ease;
}
@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}
.model-badge {
  font-size: 0.7rem;
  padding: 2px 6px;
  border-radius: 8px;
  font-weight: 600;
}
.code-block {
  background: #1a1a1a;
  border: 1px solid #333;
  border-radius: 8px;
  padding: 12px;
  margin: 8px 0;
  overflow-x: auto;
  color: #f8f8f2;
  font-family: 'Courier New', monospace;
}
.thinking-animation {
  background: linear-gradient(90deg, #667eea, #764ba2, #8a2be2);
  background-size: 200% 200%;
  animation: gradient 2s ease infinite;
}
</style>
</head>
<body class="font-sans bg-gray-50 dark:bg-gray-900 transition-all duration-300 theme-purple">

<!-- AUTH MODAL -->
<div id="authModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 fade-in">
  <div class="bg-white dark:bg-gray-800 rounded-2xl p-8 w-96 max-w-md mx-4 shadow-2xl">
    <div class="text-center mb-6">
      <div class="w-16 h-16 bg-gradient-to-r from-[var(--primary)] to-[var(--secondary)] rounded-2xl flex items-center justify-center mx-auto mb-4">
        <i class="fas fa-brain text-white text-2xl"></i>
      </div>
      <h2 class="text-2xl font-bold text-gray-900 dark:text-white">LudvigAI</h2>
      <p class="text-gray-600 dark:text-gray-400">Продвинутый AI-ассистент</p>
    </div>
    <!-- Логин -->
    <div id="loginForm" class="">
      <div class="space-y-4">
        <div>
          <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Email</label>
          <input id="loginEmail" type="email" class="w-full border border-gray-300 dark:border-gray-600 rounded-xl px-4 py-3 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-[var(--primary)] transition duration-300"/>
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Пароль</label>
          <input id="loginPassword" type="password" class="w-full border border-gray-300 dark:border-gray-600 rounded-xl px-4 py-3 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-[var(--primary)] transition duration-300"/>
        </div>
        <button onclick="login()" class="w-full bg-gradient-to-r from-[var(--primary)] to-[var(--secondary)] hover:from-[var(--secondary)] hover:to-[var(--primary)] text-white py-3 rounded-xl font-semibold transition-all duration-300 transform hover:scale-105 shadow-lg">Войти</button>
      </div>
      <div class="mt-4 text-center">
        <button onclick="toggleAuthForm()" class="text-[var(--primary)] dark:text-[var(--secondary)] hover:underline text-sm">Нет аккаунта? Зарегистрироваться</button>
      </div>
      <div class="mt-6 pt-4 border-t border-gray-200 dark:border-gray-700">
        <button onclick="enterAsGuest()" class="w-full border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 py-3 rounded-xl font-semibold hover:bg-gray-50 dark:hover:bg-gray-700 transition duration-300">Войти как гость</button>
      </div>
    </div>
    <!-- Регистрация -->
    <div id="registerForm" class="hidden">
      <div class="space-y-4">
        <div>
          <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Имя</label>
          <input id="registerName" type="text" class="w-full border border-gray-300 dark:border-gray-600 rounded-xl px-4 py-3 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-[var(--primary)] transition duration-300"/>
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Email</label>
          <input id="registerEmail" type="email" class="w-full border border-gray-300 dark:border-gray-600 rounded-xl px-4 py-3 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-[var(--primary)] transition duration-300"/>
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Пароль</label>
          <input id="registerPassword" type="password" class="w-full border border-gray-300 dark:border-gray-600 rounded-xl px-4 py-3 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-[var(--primary)] transition duration-300"/>
        </div>
        <button onclick="register()" class="w-full bg-gradient-to-r from-[var(--primary)] to-[var(--secondary)] hover:from-[var(--secondary)] hover:to-[var(--primary)] text-white py-3 rounded-xl font-semibold transition-all duration-300 transform hover:scale-105 shadow-lg">Зарегистрироваться</button>
      </div>
      <div class="mt-4 text-center">
        <button onclick="toggleAuthForm()" class="text-[var(--primary)] dark:text-[var(--secondary)] hover:underline text-sm">Уже есть аккаунт? Войти</button>
      </div>
    </div>
  </div>
</div>

<!-- Модальное окно выбора модели -->
<div id="modelModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
  <div class="bg-white dark:bg-gray-800 rounded-2xl p-6 w-96 max-w-md mx-4 shadow-2xl overflow-y-auto max-h-full">
    <div class="flex items-center justify-between mb-6">
      <h3 class="text-xl font-bold text-gray-900 dark:text-white">Выбор модели AI</h3>
      <button onclick="closeModelSelector()" class="text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300"><i class="fas fa-times text-lg"></i></button>
    </div>
    <div class="space-y-3">
      <!-- Модели -->
      <div class="model-option border-2 border-gray-200 dark:border-gray-600 rounded-xl p-4 cursor-pointer hover:border-[var(--primary)] transition" onclick="selectModel('mini')">
        <div class="flex items-center justify-between">
          <div>
            <h4 class="font-semibold text-gray-900 dark:text-white">LudvigAI 1.0 Mini</h4>
            <p class="text-sm text-gray-600 dark:text-gray-400">Быстрая и легкая</p>
          </div>
          <span class="model-badge bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200">Бесплатно</span>
        </div>
        <div class="mt-2 text-xs text-gray-500 dark:text-gray-400">Быстрые ответы • Базовые возможности</div>
      </div>
      <div class="model-option border-2 border-gray-200 dark:border-gray-600 rounded-xl p-4 cursor-pointer hover:border-[var(--primary)] transition" onclick="selectModel('standard')">
        <div class="flex items-center justify-between">
          <div>
            <h4 class="font-semibold text-gray-900 dark:text-white">LudvigAI 1.0</h4>
            <p class="text-sm text-gray-600 dark:text-gray-400">Стандартная версия</p>
          </div>
          <span class="model-badge bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200">Бесплатно</span>
        </div>
        <div class="mt-2 text-xs text-gray-500 dark:text-gray-400">Улучшенные ответы • Поддержка кода</div>
      </div>
      <div class="model-option border-2 border-gray-200 dark:border-gray-600 rounded-xl p-4 cursor-pointer hover:border-[var(--primary)] transition" onclick="selectModel('plus')">
        <div class="flex items-center justify-between">
          <div>
            <h4 class="font-semibold text-gray-900 dark:text-white">LudvigAI 1.0 Plus</h4>
            <p class="text-sm text-gray-600 dark:text-gray-400">Расширенные возможности</p>
          </div>
          <span class="model-badge bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200">Premium</span>
        </div>
        <div class="mt-2 text-xs text-gray-500 dark:text-gray-400">Креативные ответы • Анализ данных</div>
      </div>
      <div class="model-option border-2 border-gray-200 dark:border-gray-600 rounded-xl p-4 cursor-pointer hover:border-[var(--primary)] transition" onclick="selectModel('pro')">
        <div class="flex items-center justify-between">
          <div>
            <h4 class="font-semibold text-gray-900 dark:text-white">LudvigAI 1.0 Pro</h4>
            <p class="text-sm text-gray-600 dark:text-gray-400">Профессиональная версия</p>
          </div>
          <span class="model-badge bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200">Pro</span>
        </div>
        <div class="mt-2 text-xs text-gray-500 dark:text-gray-400">Сложный анализ • Экспертные знания</div>
      </div>
      <div class="model-option border-2 border-gray-200 dark:border-gray-600 rounded-xl p-4 cursor-pointer hover:border-[var(--primary)] transition" onclick="selectModel('ultimate')">
        <div class="flex items-center justify-between">
          <div>
            <h4 class="font-semibold text-gray-900 dark:text-white">LudvigAI 1.0 Ultimate</h4>
            <p class="text-sm text-gray-600 dark:text-gray-400">Максимальная мощность</p>
          </div>
          <span class="model-badge bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200">Ultimate</span>
        </div>
        <div class="mt-2 text-xs text-gray-500 dark:text-gray-400">Все возможности • Макс. креативность</div>
      </div>
    </div>
    <div class="mt-6 p-4 bg-gray-50 dark:bg-gray-700 rounded-lg">
      <h4 class="font-semibold text-gray-900 dark:text-white mb-2">Текущая модель:</h4>
      <p class="text-sm text-gray-600 dark:text-gray-400" id="currentModelInfo">LudvigAI 1.0</p>
    </div>
  </div>
</div>

<!-- Настройки -->
<div id="settingsModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
  <div class="bg-white dark:bg-gray-800 rounded-2xl p-6 w-96 max-w-md mx-4 shadow-2xl overflow-y-auto max-h-full">
    <div class="flex items-center justify-between mb-6">
      <h3 class="text-xl font-bold text-gray-900 dark:text-white">Настройки</h3>
      <button onclick="closeSettings()" class="text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300"><i class="fas fa-times text-lg"></i></button>
    </div>
    <div class="space-y-6">
      <!-- Тема -->
      <div>
        <h4 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">Тема оформления</h4>
        <div class="grid grid-cols-3 gap-3">
          <div class="theme-option theme-purple border-2 border-gray-300 rounded-lg p-3 cursor-pointer hover:scale-105 transition" onclick="selectTheme('purple')">
            <div class="w-full h-8 bg-gradient-to-r from-purple-500 to-purple-600 rounded mb-2"></div>
            <span class="text-xs text-gray-600 dark:text-gray-400">Фиолетовая</span>
          </div>
          <div class="theme-option theme-blue border-2 border-gray-300 rounded-lg p-3 cursor-pointer hover:scale-105 transition" onclick="selectTheme('blue')">
            <div class="w-full h-8 bg-gradient-to-r from-blue-500 to-blue-600 rounded mb-2"></div>
            <span class="text-xs text-gray-600 dark:text-gray-400">Синяя</span>
          </div>
          <div class="theme-option theme-green border-2 border-gray-300 rounded-lg p-3 cursor-pointer hover:scale-105 transition" onclick="selectTheme('green')">
            <div class="w-full h-8 bg-gradient-to-r from-green-500 to-green-600 rounded mb-2"></div>
            <span class="text-xs text-gray-600 dark:text-gray-400">Зеленая</span>
          </div>
          <div class="theme-option theme-orange border-2 border-gray-300 rounded-lg p-3 cursor-pointer hover:scale-105 transition" onclick="selectTheme('orange')">
            <div class="w-full h-8 bg-gradient-to-r from-orange-500 to-orange-600 rounded mb-2"></div>
            <span class="text-xs text-gray-600 dark:text-gray-400">Оранжевая</span>
          </div>
          <div class="theme-option theme-pink border-2 border-gray-300 rounded-lg p-3 cursor-pointer hover:scale-105 transition" onclick="selectTheme('pink')">
            <div class="w-full h-8 bg-gradient-to-r from-pink-500 to-pink-600 rounded mb-2"></div>
            <span class="text-xs text-gray-600 dark:text-gray-400">Розовая</span>
          </div>
        </div>
      </div>
      <!-- Модель -->
      <div>
        <h4 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">AI Модель</h4>
        <div class="flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg">
          <div>
            <span class="font-medium text-gray-900 dark:text-white" id="currentModelDisplay">LudvigAI 1.0</span>
            <p class="text-sm text-gray-600 dark:text-gray-400" id="modelCapabilities">Стандартные возможности</p>
          </div>
          <button onclick="openModelSelector()" class="text-[var(--primary)] dark:text-[var(--secondary)] hover:text-[var(--secondary)] dark:hover:text-[var(--primary)] text-sm font-semibold">Сменить</button>
        </div>
      </div>
      <!-- LudvigThink / LudvigSearch -->
      <div>
        <h4 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">Функции</h4>
        <div class="flex items-center justify-between mb-2">
          <div>
            <span class="text-gray-700 dark:text-gray-300">LudvigThink</span>
            <p class="text-xs text-gray-500 dark:text-gray-400">Глубокий анализ</p>
          </div>
          <input type="checkbox" id="ludvigThinkToggle" class="sr-only peer" onchange="toggleLudvigThink()"/>
          <div class="w-11 h-6 bg-gray-200 rounded-full peer-focus:ring-4 peer-focus:ring-[var(--primary)] peer dark:bg-gray-600 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-[var(--primary)]"></div>
        </div>
        <div class="flex items-center justify-between mb-2">
          <div>
            <span class="text-gray-700 dark:text-gray-300">LudvigSearch</span>
            <p class="text-xs text-gray-500 dark:text-gray-400">Поиск в интернете</p>
          </div>
          <input type="checkbox" id="ludvigSearchToggle" class="sr-only peer" onchange="toggleLudvigSearch()"/>
          <div class="w-11 h-6 bg-gray-200 rounded-full peer-focus:ring-4 peer-focus:ring-[var(--primary)] peer dark:bg-gray-600 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-[var(--primary)]"></div>
        </div>
      </div>
      <!-- Внешний вид -->
      <div>
        <h4 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">Внешний вид</h4>
        <div class="flex items-center justify-between mb-2">
          <span class="text-gray-700 dark:text-gray-300">Темная тема</span>
          <input type="checkbox" id="darkModeToggle" class="sr-only peer"/>
          <div class="w-11 h-6 bg-gray-200 rounded-full peer-focus:ring-4 peer-focus:ring-[var(--primary)] peer dark:bg-gray-600 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-[var(--primary)]"></div>
        </div>
      </div>
      <!-- Аккаунт -->
      <div>
        <h4 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">Аккаунт</h4>
        <div id="userInfo" class="p-3 bg-gray-50 dark:bg-gray-700 rounded-lg">
          <p class="text-sm text-gray-600 dark:text-gray-400" id="userStatus"></p>
        </div>
        <button onclick="logout()" class="w-full bg-red-600 hover:bg-red-700 text-white py-2 rounded-lg font-semibold transition duration-300 mt-2">Выйти</button>
      </div>
    </div>
  </div>
</div>

<!-- Основной интерфейс -->
<div id="mainApp" class="hidden">
  <!-- Панель управления темой -->
  <div class="fixed top-4 right-4 z-50 flex space-x-2">
    <button id="themeToggle" class="bg-white dark:bg-gray-800 p-3 rounded-full shadow-lg border border-gray-200 dark:border-gray-700 hover:shadow-xl transition-all duration-300">
      <i class="fas fa-moon text-gray-600 dark:text-yellow-400"></i>
    </button>
    <button onclick="openSettings()" class="bg-white dark:bg-gray-800 p-3 rounded-full shadow-lg border border-gray-200 dark:border-gray-700 hover:shadow-xl transition-all duration-300">
      <i class="fas fa-cog"></i>
    </button>
  </div>
  <div class="flex h-screen">
    <!-- Боковая панель -->
    <div id="sidebar" class="sidebar-transition w-80 bg-white dark:bg-gray-800 border-r border-gray-200 dark:border-gray-700 flex flex-col h-full">
      <!-- Заголовок -->
      <div class="p-4 border-b border-gray-200 dark:border-gray-700">
        <div class="flex items-center space-x-3">
          <div class="w-10 h-10 bg-gradient-to-r from-[var(--primary)] to-[var(--secondary)] rounded-lg flex items-center justify-center">
            <i class="fas fa-brain text-white text-lg"></i>
          </div>
          <div>
            <h1 class="text-xl font-bold text-gray-900 dark:text-white">LudvigAI</h1>
            <p class="text-sm text-gray-500 dark:text-gray-400" id="userGreeting">Ваш продвинутый ассистент</p>
          </div>
        </div>
      </div>
      <!-- Модель -->
      <div class="px-4 py-3 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">
        <div>
          <span class="text-sm font-medium text-gray-700 dark:text-gray-300" id="currentModelBadge">LudvigAI 1.0</span>
          <p class="text-xs text-gray-500 dark:text-gray-400" id="modelCapabilities">Стандартные возможности</p>
        </div>
        <button onclick="openModelSelector()" class="text-[var(--primary)] dark:text-[var(--secondary)] text-xs font-semibold">Сменить</button>
      </div>
      <!-- Статус функций -->
      <div class="px-4 py-2 border-b border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-700/50 flex justify-between text-xs">
        <div id="thinkStatus">🤔 LudvigThink: выкл</div>
        <div id="searchStatus">🔍 LudvigSearch: выкл</div>
      </div>
      <!-- Новая сессия -->
      <div class="p-4">
        <button id="newChatBtn" class="w-full bg-gradient-to-r from-[var(--primary)] to-[var(--secondary)] hover:from-[var(--secondary)] hover:to-[var(--primary)] text-white py-3 px-4 rounded-lg font-semibold transition-all duration-300 transform hover:scale-105 shadow-lg">
          <i class="fas fa-plus mr-2"></i> Новый чат
        </button>
      </div>
      <!-- История чатов -->
      <div id="chatHistory" class="flex-1 overflow-y-auto p-4 space-y-2"></div>
      <!-- Профиль -->
      <div class="p-4 border-t border-gray-200 dark:border-gray-700 flex items-center justify-between">
        <div class="flex items-center space-x-3">
          <div id="userAvatar" class="w-8 h-8 bg-gradient-to-r from-green-500 to-blue-500 rounded-full flex items-center justify-center">
            <span class="text-white text-sm font-bold">Г</span>
          </div>
          <div class="flex-1">
            <div class="text-sm font-medium text-gray-900 dark:text-white" id="userName">Гость</div>
            <div class="text-xs text-gray-500 dark:text-gray-400" id="userType">Гостевой режим</div>
          </div>
          <button onclick="openSettings()" class="text-gray-500 dark:text-gray-400 hover:text-gray-700"><i class="fas fa-cog"></i></button>
        </div>
      </div>
    </div>
    <!-- Бутон мобильной панели -->
    <button id="sidebarToggle" class="lg:hidden fixed top-4 left-4 z-50 bg-white dark:bg-gray-800 p-3 rounded-full shadow-lg border border-gray-200 dark:border-gray-700">
      <i class="fas fa-bars text-gray-600 dark:text-gray-400"></i>
    </button>
    <!-- Основной чат -->
    <div class="flex-1 flex flex-col h-full">
      <!-- Заголовок -->
      <div class="border-b border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 p-4">
        <div class="flex items-center space-x-3">
          <div class="w-8 h-8 bg-gradient-to-r from-[var(--primary)] to-[var(--secondary)] rounded-lg flex items-center justify-center">
            <i class="fas fa-brain text-white text-sm"></i>
          </div>
          <div>
            <h2 class="text-lg font-semibold text-gray-900 dark:text-white">LudvigAI <span class="model-badge bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200 text-xs ml-2" id="headerModelBadge">1.0</span></h2>
            <p class="text-sm text-gray-500 dark:text-gray-400" id="modelDescription">Стандартная версия • Готов помочь</p>
          </div>
        </div>
      </div>
      <!-- Сообщения -->
      <div id="messagesContainer" class="flex-1 overflow-y-auto p-6 space-y-6">
        <!-- приветствие -->
        <div class="message-enter flex justify-start">
          <div class="flex space-x-3 max-w-4xl">
            <div class="w-8 h-8 bg-gradient-to-r from-[var(--primary)] to-[var(--secondary)] rounded-full flex items-center justify-center">
              <i class="fas fa-brain text-white text-sm"></i>
            </div>
            <div class="bg-white dark:bg-gray-700 rounded-2xl px-6 py-4 shadow-lg border border-gray-200 dark:border-gray-600">
              <p class="text-gray-900 dark:text-white text-lg leading-relaxed">
                Привет! Я LudvigAI — ваш продвинутый AI-ассистент. 🤖<br><br>
                Мои возможности: <br>
                • Генерация кода<br>
                • Глубокий анализ вопросов<br>
                • Поиск в интернете<br>
                • Решение задач<br>
                • Объяснение научных концепций<br><br>
                Включите LudvigThink для глубокого анализа или LudvigSearch для поиска.
              </p>
              <div class="flex flex-wrap gap-2 mt-4">
                <button class="suggestion-btn bg-purple-100 dark:bg-purple-900/30 hover:bg-purple-200 dark:hover:bg-purple-900/50 text-purple-700 dark:text-purple-300 px-4 py-2 rounded-lg text-sm transition" onclick="setSuggestion('Напиши код на Python')">Напиши код на Python</button>
                <button class="suggestion-btn bg-blue-100 dark:bg-blue-900/30 hover:bg-blue-200 dark:hover:bg-blue-900/50 text-blue-700 dark:text-blue-300 px-4 py-2 rounded-lg text-sm transition" onclick="setSuggestion('Объясни квантовую физику')">Объясни квантовую физику</button>
                <button class="suggestion-btn bg-green-100 dark:bg-green-900/30 hover:bg-green-200 dark:hover:bg-green-900/50 text-green-700 dark:text-green-300 px-4 py-2 rounded-lg text-sm transition" onclick="setSuggestion('Помоги с алгоритмом')">Помоги с алгоритмом</button>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- Индикатор мышления -->
      <div id="thinkingIndicator" class="hidden px-6 py-4">
        <div class="flex space-x-3 max-w-4xl">
          <div class="w-8 h-8 thinking-animation rounded-full flex items-center justify-center">
            <i class="fas fa-brain text-white text-sm"></i>
          </div>
          <div class="bg-white dark:bg-gray-700 rounded-2xl px-6 py-4 shadow-lg border border-gray-200 dark:border-gray-600">
            <div class="flex items-center space-x-2">
              <div class="typing-dots">
                <span class="text-2xl">●</span>
                <span class="text-2xl">●</span>
                <span class="text-2xl">●</span>
              </div>
              <span class="text-gray-600 dark:text-gray-400 text-sm">LudvigThink анализирует...</span>
            </div>
          </div>
        </div>
      </div>
      <!-- Ввод -->
      <div class="border-t border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 p-6">
        <div class="max-w-4xl mx-auto">
          <div class="flex space-x-4">
            <div class="flex-1 relative">
              <textarea id="messageInput" placeholder="Напишите сообщение..." rows="1" class="w-full border border-gray-300 dark:border-gray-600 rounded-2xl py-4 px-6 pr-12 bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 resize-none focus:outline-none focus:ring-2 focus:ring-[var(--primary)] transition-all duration-300 max-h-32" oninput="autoResize(this)"></textarea>
              <button id="sendButton" class="absolute right-3 top-1/2 transform -translate-y-1/2 bg-gradient-to-r from-[var(--primary)] to-[var(--secondary)] hover:from-[var(--secondary)] hover:to-[var(--primary)] text-white p-2 rounded-lg transition" disabled><i class="fas fa-paper-plane text-sm"></i></button>
            </div>
          </div>
          <div class="flex justify-between items-center mt-3 text-sm text-gray-500 dark:text-gray-400">
            <div class="flex space-x-4">
              <button onclick="openModelSelector()" class="hover:text-[var(--primary)] dark:hover:text-[var(--secondary)] transition">Модель</button>
              <button onclick="toggleLudvigThink()" id="thinkBtn" class="hover:text-[var(--primary)] dark:hover:text-[var(--secondary)] transition">LudvigThink</button>
              <button onclick="toggleLudvigSearch()" id="searchBtn" class="hover:text-[var(--primary)] dark:hover:text-[var(--secondary)] transition">LudvigSearch</button>
            </div>
            <div>
              <span id="footerModelInfo">LudvigAI 1.0</span>
            </div>
          </div>
        </div>
      </
    
  



 ъявление переменных
let user = null;
let currentChatId = 'default';
let currentModel = 'standard';
let chats = {
  'default': {
    id: 'default',
    title: 'Новый чат',
    messages: [],
    createdAt: new Date().toISOString(),
    model: 'standard'
  }
};
let models = {
  'mini': {
    name: 'LudvigAI 1.0 Mini',
    shortName: 'Mini',
    description: 'Быстрая и легкая',
    capabilities: 'Быстрые ответы, минимальные ресурсы',
    badgeColor: 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200',
    speed: 500,
    creativity: 30
  },
  'standard': {
    name: 'LudvigAI 1.0',
    shortName: '1.0',
    description: 'Стандартная версия',
    capabilities: 'Поддержка кода, улучшенные ответы',
    badgeColor: 'bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200',
    speed: 1000,
    creativity: 50
  },
  'plus': {
    name: 'LudvigAI 1.0 Plus',
    shortName: 'Plus',
    description: 'Расширенные возможности',
    capabilities: 'Креативные ответы, анализ данных',
    badgeColor: 'bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200',
    speed: 1500,
    creativity: 70
  },
  'pro': {
    name: 'LudvigAI 1.0 Pro',
    shortName: 'Pro',
    description: 'Профессиональная версия',
    capabilities: 'Сложный анализ, экспертные знания',
    badgeColor: 'bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200',
    speed: 2000,
    creativity: 85
  },
  'ultimate': {
    name: 'LudvigAI 1.0 Ultimate',
    shortName: 'Ultimate',
    description: 'Максимальная мощность',
    capabilities: 'Все возможности, максимальная креативность',
    badgeColor: 'bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200',
    speed: 2500,
    creativity: 95
  }
};
// Вспомогательные функции
function save() {
  if (user && user.type === 'registered') {
    localStorage.setItem('ludvig_user', JSON.stringify(user));
    localStorage.setItem('ludvig_chats', JSON.stringify(chats));
    localStorage.setItem('ludvig_model', currentModel);
  }
}
function load() {
  let u = localStorage.getItem('ludvig_user');
  if(u) user=JSON.parse(u);
  let c = localStorage.getItem('ludvig_chats');
  if(c) chats=JSON.parse(c);
  let m = localStorage.getItem('ludvig_model');
  if(m) currentModel=m;
}
function updateUI() {
  // Обновление профиля
  document.getElementById('userName').textContent = user ? user.name : 'Гость';
  document.getElementById('userType').textContent = (user && user.type==='guest')?'Гостевой режим':'Зарегистрирован';
  document.getElementById('userGreeting').textContent = user ? `Привет, ${user.name}!` : 'Здравствуйте!';
  // Обновление модели
  updateModelInfo();
  // Обновление истории
  renderChatList();
  loadChat(currentChatId);
}
function login() {
  const email = document.getElementById('loginEmail').value.trim();
  const pass = document.getElementById('loginPassword').value.trim();
  if(!email || !pass){ alert('Заполните все поля'); return;}
  user = {id:'1', name: email.split('@')[0], email, type:'registered'};
  load(); updateUI(); document.getElementById('authModal').classList.add('hidden'); document.getElementById('mainApp').classList.remove('hidden');
}
function register() {
  const name = document.getElementById('registerName').value.trim();
  const email = document.getElementById('registerEmail').value.trim();
  const pass = document.getElementById('registerPassword').value.trim();
  if(!name || !email || !pass){ alert('Заполните все поля'); return;}
  user = {id:'1', name, email, type:'registered'};
  load(); updateUI(); document.getElementById('authModal').classList.add('hidden'); document.getElementById('mainApp').classList.remove('hidden');
}
function enterAsGuest() {
  user={id:'guest', name:'Гость', email:null, type:'guest'};
  load(); updateUI(); document.getElementById('authModal').classList.add('hidden'); document.getElementById('mainApp').classList.remove('hidden');
}
function logout() {
  user=null; chats={'default':{id:'default',title:'Новый чат',messages:[],createdAt:new Date().toISOString(),model:currentModel}};
  currentChatId='default'; save(); document.getElementById('authModal').classList.remove('hidden'); document.getElementById('mainApp').classList.add('hidden');
}
function createChat() {
  const id='chat_'+Date.now();
  chats[id]={id, title:'Новый чат', messages:[], createdAt:new Date().toISOString(), model: currentModel};
  currentChatId=id;
  renderChatList();
  loadChat(id);
  save();
}
function deleteChat(id,e) {
  e.stopPropagation();
  if(Object.keys(chats).length===1){ alert('Нельзя удалить последний чат'); return;}
  if(confirm('Удалить этот чат?')){
    delete chats[id];
    if(currentChatId===id){
      currentChatId=Object.keys(chats)[0];
      loadChat(currentChatId);
    }
    renderChatList(); save();
  }
}
function switchChat(id){
  currentChatId=id; loadChat(id);
}
function renderChatList() {
  const container=document.getElementById('chatHistory');
  container.innerHTML='';
  Object.values(chats).sort((a,b)=>new Date(b.createdAt)-new Date(a.createdAt)).forEach(c=>{
    const div=document.createElement('div');
    div.className='group border rounded-lg p-3 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600 mb-2 flex justify-between items-center';
    div.onclick=()=>switchChat(c.id);
    const lastMsg = c.messages[c.messages.length-1];
    const title = lastMsg?lastMsg.text.substring(0,30)+(lastMsg.text.length>30?'...':''):'Новый чат';
    div.innerHTML=`
      <div class="flex items-center space-x-2">
        <i class="fas fa-message ${c.id===currentChatId?'text-purple-600':'text-gray-600'}"></i>
        <span class="text-sm font-medium text-gray-900 dark:text-white">${title}</span>
      </div>
      <button class="opacity-0 group-hover:opacity-100 text-red-500 text-xs" onclick="deleteChat('${c.id}',event)"><i class="fas fa-trash"></i></button>
    `;
    container.appendChild(div);
  });
}
function loadChat(id) {
  const chat=chats[id];
  const container=document.getElementById('messagesContainer');
  container.innerHTML='';
  if(chat.messages.length===0){
    container.innerHTML=`
      <div class="message-enter flex justify-start">
        <div class="flex space-x-3 max-w-4xl">
          <div class="w-8 h-8 bg-gradient-to-r from-[var(--primary)] to-[var(--secondary)] rounded-full flex items-center justify-center">
            <i class="fas fa-brain text-white text-sm"></i>
          </div>
          <div class="bg-white dark:bg-gray-700 rounded-2xl px-6 py-4 shadow-lg border border-gray-200 dark:border-gray-600">
            <p class="text-gray-900 dark:text-white">Я - LudvigAI. Чем могу помочь?</p>
          </div>
        </div>
      </div>
    `;
  } else {
    chat.messages.forEach(m=>{
      addMessageUI(m.text,m.isUser);
    });
  }
}
function addMessageUI(text, isUser) {
  const container=document.getElementById('messagesContainer');
  const div=document.createElement('div');
  div.className='message-enter flex '+(isUser?'justify-end':'justify-start');
  div.innerHTML=`
    <div class="flex items-center space-x-2 max-w-4xl ${isUser?'flex-row-reverse':'flex-row'}">
      <div class="w-8 h-8 ${isUser?'bg-gradient-to-r from-green-500 to-blue-500':'bg-gradient-to-r from-[var(--primary)] to-[var(--secondary)]'} rounded-full flex items-center justify-center">
        <i class="fas ${isUser?'fa-user':'fa-brain'} text-white text-sm"></i>
      </div>
      <div class="${isUser?'bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-2xl rounded-tr-none':'bg-white dark:bg-gray-700 text-gray-900 dark:text-white rounded-2xl rounded-tl-none border border-gray-200 dark:border-gray-600'} px-6 py-4 shadow-lg">
        <p class="text-lg leading-relaxed">${text}</p>
      </div>
    </div>
  `;
  container.appendChild(div);
  container.scrollTop=container.scrollHeight;
}
function sendMessage() {
  const input=document.getElementById('messageInput');
  const msg=input.value.trim();
  if(!msg) return;
  addMessageUI(msg,true);
  chats[currentChatId].messages.push({text:msg,isUser:true,timestamp:new Date().toISOString()});
  if(chats[currentChatId].messages.length===1){
    chats[currentChatId].title=msg.substring(0,30)+(msg.length>30?'...':'');
    renderChatList();
  }
  input.value='';
  autoResize(input);
  document.getElementById('sendButton').disabled=true;
  // Обработка ответа AI
  handleAIResponse(msg);
}
async function handleAIResponse(msg) {
  // Показываем индикатор мышления
  document.getElementById('thinkingIndicator').classList.remove('hidden');
  // Генерируем ответ
  const response = generateResponse(msg);
  // Задержка для имитации мышления
  await new Promise(r=>setTimeout(r,models[currentModel].speed));
  // Убираем индикатор
  document.getElementById('thinkingIndicator').classList.add('hidden');
  // Отображаем ответ
  addMessageUI(response.text,false);
  chats[currentChatId].messages.push({text:response.text,isUser:false,timestamp:new Date().toISOString()});
  save();
}
function autoResize(textarea){
  textarea.style.height='auto';
  textarea.style.height=Math.min(textarea.scrollHeight,128)+'px';
  document.getElementById('sendButton').disabled=textarea.value.trim()==='';
}
function setSuggestion(text){
  document.getElementById('messageInput').value=text;
  autoResize(document.getElementById('messageInput'));
  document.getElementById('sendButton').disabled=false;
}
function toggleAuthForm(){
  document.getElementById('loginForm').classList.toggle('hidden');
  document.getElementById('registerForm').classList.toggle('hidden');
}
function openModelSelector() {
  document.getElementById('modelModal').classList.remove('hidden');
  updateModelInfo();
}
function closeModelSelector() {
  document.getElementById('modelModal').classList.add('hidden');
}
function selectModel(modelKey){
  currentModel=modelKey;
  document.getElementById('currentModelDisplay').textContent=models[modelKey].name;
  document.getElementById('modelCapabilities').textContent=models[modelKey].capabilities;
  document.getElementById('currentModelBadge').textContent=models[modelKey].name;
  document.getElementById('headerModelBadge').textContent=models[modelKey].shortName;
  document.getElementById('headerModelBadge').className='model-badge '+models[modelKey].badgeColor;
  document.getElementById('modelDescription').textContent=models[modelKey].description+' • Готов помочь';
  document.getElementById('footerModelInfo').textContent=models[modelKey].name;
  save();
  closeModelSelector();
  // Вставляем системное сообщение о смене модели
  addMessageUI('🔄 Переключено на '+models[modelKey].name,false);
  chats[currentChatId].messages.push({text:'🔄 Переключено на '+models[modelKey].name,isUser:false,timestamp:new Date().toISOString(),isSystem:true});
}
function updateModelInfo() {
  document.getElementById('currentModelDisplay').textContent=models[currentModel].name;
  document.getElementById('modelCapabilities').textContent=models[currentModel].capabilities;
  document.getElementById('currentModelBadge').textContent=models[currentModel].name;
  document.getElementById('headerModelBadge').textContent=models[currentModel].shortName;
  document.getElementById('headerModelBadge').className='model-badge '+models[currentModel].badgeColor;
  document.getElementById('modelDescription').textContent=models[currentModel].description+' • Готов помочь';
  document.getElementById('footerModelInfo').textContent=models[currentModel].name;
}
function openSettings() {
  document.getElementById('settingsModal').classList.remove('hidden');
}
function closeSettings() {
  document.getElementById('settingsModal').classList.add('hidden');
}
function selectTheme(theme){
  document.body.className='font-sans bg-gray-50 dark:bg-gray-900 transition-all duration-300 theme-'+theme;
  localStorage.setItem('ludvig_theme',theme);
  updateThemeUI();
}
function updateThemeUI() {
  document.querySelectorAll('.theme-option').forEach(e=>e.classList.remove('border-[var(--primary)]'));
  document.querySelector('.theme-option.theme-'+getSavedTheme()).classList.add('border-[var(--primary)]');
}
function getSavedTheme() {
  return localStorage.getItem('ludvig_theme') || 'purple';
}
function toggleLudvigThink() {
  ludvigThinkEnabled=!ludvigThinkEnabled;
  document.getElementById('ludvigThinkToggle').checked=ludvigThinkEnabled;
  document.getElementById('thinkStatus').textContent='🤔 LudvigThink: '+(ludvigThinkEnabled?'вкл':'выкл');
}
function toggleLudvigSearch() {
  ludvigSearchEnabled=!ludvigSearchEnabled;
  document.getElementById('ludvigSearchToggle').checked=ludvigSearchEnabled;
  document.getElementById('searchStatus').textContent='🔍 LudvigSearch: '+(ludvigSearchEnabled?'вкл':'выкл');
}
// Генерация ответов
function generateResponse(input){
  input=input.toLowerCase();
  // Проверка на команды генерации кода
  if(input.includes('напиши код') || input.includes('сделай код')){
    if(input.includes('python') || input.includes('питон')){
      return {text:'🤖 Вот пример кода на Python:\n\n```python\nprint("Hello World")\n```', requiresThinking:true};
    } else if(input.includes('js') || input.includes('javascript')){
      return {text:'🤖 Вот пример кода на JavaScript:\n\n```javascript\nconsole.log("Hello World");\n```', requiresThinking:true};
    }
  }
  // Научные темы
  if(input.includes('квант') || input.includes('физика')){
    return {text:'🔬 Квантовая механика — раздел физики, изучающий поведение материи и энергии на микроуровне...', requiresThinking:true};
  }
  if(input.includes('математика')){
    return {text:'📐 Математика — наука о числах, структурах, пространстве и изменениях...', requiresThinking:true};
  }
  // Поиск
  if(ludvigSearchEnabled && (input.includes('что такое') || input.includes('кто такой') || input.includes('информация о'))){
    return {text:generateWebSearchResponse(input), requiresThinking:false};
  }
  // Глубокий анализ LudvigThink
  if(ludvigThinkEnabled && (input.length>50 || input.includes('объясни') || input.includes('проанализируй'))){
    return {text:generateDeepAnalysis(input), requiresThinking:true};
  }
  // Просто ответ
  return {text:generateSmartResponse(input), requiresThinking:false};
}
function generateDeepAnalysis(input){
  const analyses=[
    '🔍 Глубокий анализ вопроса... Первый уровень — лингвистический...',
    '🎯 Междисциплинарный анализ... Второй уровень — логика и причинно-следственные связи...',
    '💡 Когнитивный разбор... Третий уровень — синтез новых идей...'
  ];
  return analyses[Math.floor(Math.random()*analyses.length)];
}
function generateWebSearchResponse(input){
  const responses=[
    '🌐 Нашел информацию в источниках...',
    '🔎 В процессе поиска... Предварительные результаты...'
  ];
  return responses[Math.floor(Math.random()*responses.length)];
}
function generateSmartResponse(input){
  const responses=[
    'Понял, сейчас подготовлю ответ...',
    'Интересный вопрос! Обрабатываю информацию...',
    'Дайте минуту, я сформирую ответ...'
  ];
  return responses[Math.floor(Math.random()*responses.length)];
}
// Обработка темы
function toggleTheme(theme){
  selectTheme(theme);
}
// Обработка LudvigThink
let ludvigThinkEnabled=false;
function toggleLudvigThink(){
  ludvigThinkEnabled=!ludvigThinkEnabled;
  document.getElementById('thinkBtn').classList.toggle('text-[var(--primary)]',ludvigThinkEnabled);
  document.getElementById('thinkStatus').textContent='🤔 LudvigThink: '+(ludvigThinkEnabled?'вкл':'выкл');
}
let ludvigSearchEnabled=false;
function toggleLudvigSearch(){
  ludvigSearchEnabled=!ludvigSearchEnabled;
  document.getElementById('searchBtn').classList.toggle('text-[var(--primary)]',ludvigSearchEnabled);
  document.getElementById('searchStatus').textContent='🔍 LudvigSearch: '+(ludvigSearchEnabled?'вкл':'выкл');
}
// Очистка чата
function clearChat() {
  if(confirm('Очистить текущий чат?')){
    chats[currentChatId].messages=[];
    loadChat(currentChatId);
  }
}
// Переключение темы
document.getElementById('themeToggle').onclick=()=>{
  if(document.documentElement.classList.contains('dark')){
    document.documentElement.classList.remove('dark');
    localStorage.setItem('ludvig_theme','light');
  } else {
    document.documentElement.classList.add('dark');
    localStorage.setItem('ludvig_theme','dark');
  }
}
// Обработка кнопки отправки
document.getElementById('sendButton').onclick=()=>sendMessage();
document.getElementById('messageInput').onkeypress=(e)=>{
  if(e.key==='Enter' && !e.shiftKey){ e.preventDefault(); sendMessage();}
}
document.querySelectorAll('.suggestion-btn').forEach(btn=>btn.onclick=()=>setSuggestion(btn.textContent));
document.getElementById('newChatBtn').onclick=createChat;
document.getElementById('sidebarToggle').onclick=()=>{document.getElementById('sidebar').classList.toggle('hidden');};
window.onload=()=> {
  load();
  if(user){ updateUI(); } else { document.getElementById('authModal').classList.remove('hidden'); }
  document.getElementById('messageInput').focus();
  updateTheme();
}
// Обновление темы
function updateTheme() {
  const theme=localStorage.getItem('ludvig_theme')||'purple';
  selectTheme(theme);
}
function selectTheme(theme){
  document.body.className='font-sans bg-gray-50 dark:bg-gray-900 transition-all duration-300 theme-'+theme;
  localStorage.setItem('ludvig_theme',theme);
  document.querySelectorAll('.theme-option').forEach(e=>e.classList.remove('border-[var(--primary)]'));
  document.querySelector('.theme-option.theme-'+theme).classList.add('border-[var(--primary)]');
}
// Основной цикл
async function sendMessage() {
  const input=document.getElementById('messageInput');
  const msg=input.value.trim();
  if(!msg) return;
  addMessageUI(msg,true);
  chats[currentChatId].messages.push({text:msg,isUser:true,timestamp:new Date().toISOString()});
  if(chats[currentChatId].messages.length===1){
    chats[currentChatId].title=msg.substring(0,30)+(msg.length>30?'...':'');
    renderChatList();
  }
  input.value='';
  autoResize(input);
  document.getElementById('sendButton').disabled=true;
  // Генерация ответа
  const response=generateResponse(msg);
  // Показываем индикатор мышления
  document.getElementById('thinkingIndicator').classList.remove('hidden');
  await new Promise(r=>setTimeout(r,models[currentModel].speed));
  document.getElementById('thinkingIndicator').classList.add('hidden');
  addMessageUI(response.text,false);
  chats[currentChatId].messages.push({text:response.text,isUser:false,timestamp:new Date().toISOString()});
  save();
}
</script>
</body>
</html>
